########################################################################################################################
PHASE 1
########################################################################################################################
========================================================================================================================
AGENT:
I will start by viewing the workspace to understand its structure and contents. This will help me identify key files and locations that may be relevant to the task.
========================================================================================================================
USER PROMPT:
Resolve the following problem statement:

<problem_statement>
Code.ILLEGAL_POLLING_TIME is not compatible with gRPC Client <=5.0.2
`Code.ILLEGAL_PILLING_TIME` is introduced in `rocketmq-proto` 2.0.1, which is integrated by [gRPC client 5.0.3](https://github.com/apache/rocketmq-clients/releases/tag/java-5.0.3), so it is not compatible with the older client.




</problem_statement>

Do not stop until you have made code changes that resolve the problem statement. Do not ask for clarifications.
========================================================================================================================
AGENT:
Starting to analyze the problem statement. The issue is about `Code.ILLEGAL_POLLING_TIME` being introduced in `rocketmq-proto` 2.0.1 which is only available in gRPC client 5.0.3+. This causes compatibility issues with older clients (<=5.0.2). I need to find where this code is used and make it backward compatible.
========================================================================================================================
TOOL CALL (grep)
content_pattern: ILLEGAL_POLLING_TIME

========================================================================================================================
TOOL RETURN (grep)
```
proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/consumer/ReceiveMessageActivity.java:88:                    writer.writeAndComplete(ctx, Code.ILLEGAL_POLLING_TIME, "The deadline time remaining is not enough" +...
```
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/consumer/ReceiveMessageActivity.java

========================================================================================================================
TOOL RETURN (open_files)
```
['Successfully opened proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/consumer/ReceiveMessageActivity.java:\n\n````java\n   0 /*\n   1  * Licensed to the Apache Software Foundation (ASF) under one or more\n   2  * contributor license agreements.  See the NOTICE file distributed with\n   3  * this work for additional information regarding copyright ownership.\n   4  * The ASF licenses this file to You under the Apache License, Version 2.0\n   5  * (the "License"); you may not use this file ...
```
========================================================================================================================
AGENT:
<thinking>
Now I understand the issue. The code uses `Code.ILLEGAL_POLLING_TIME` which was introduced in `rocketmq-proto` 2.0.1 (integrated in gRPC client 5.0.3). This means older clients (<=5.0.2) won't recognize this error code.

To make it backward compatible, I need to replace `Code.ILLEGAL_POLLING_TIME` with a code that exists in older versions of the protocol. Let me check what codes are available and commonly used.

Let me search for other Code usages to understand the pattern and find a suitable replacement code that would be compatible with older clients.
</thinking>
========================================================================================================================
TOOL CALL (grep)
content_pattern: Code\.
path_glob: '*/proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/**/*.java'

========================================================================================================================
TOOL RETURN (grep)
```
No matches found for pattern 'Code\.'....
```
========================================================================================================================
TOOL CALL (grep)
content_pattern: Code\.
path_glob: '**/proxy/**/*.java'

========================================================================================================================
TOOL RETURN (grep)
```
Too many matches found (382). Showing matched files only:
proxy/src/test/java/org/apache/rocketmq/proxy/service/relay/ProxyChannelTest.java
proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/consumer/AckMessageActivity.java
proxy/src/test/java/org/apache/rocketmq/proxy/service/mqclient/ProxyClientRemotingProcessorTest.java
proxy/src/main/java/org/apache/rocketmq/proxy/config/ProxyConfig.java
proxy/src/test/java/org/apache/rocketmq/proxy/grpc/v2/consumer/ChangeInvisibleDurationActivityTest.jav...
```
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/common/ResponseBuilder.java

========================================================================================================================
TOOL RETURN (open_files)
```
['Successfully opened proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/common/ResponseBuilder.java:\n\n````java\n   0 /*\n   1  * Licensed to the Apache Software Foundation (ASF) under one or more\n   2  * contributor license agreements.  See the NOTICE file distributed with\n   3  * this work for additional information regarding copyright ownership.\n   4  * The ASF licenses this file to You under the Apache License, Version 2.0\n   5  * (the "License"); you may not use this file except in...
```
========================================================================================================================
TOOL CALL (inspect_code)
file_path: proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/common/GrpcProxyException.java
line_ranges:
- - 0
  - -1

========================================================================================================================
TOOL RETURN (inspect_code)
```
Successfully expanded code chunks in proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/common/GrpcProxyException.java:

````java
   0 /*
   1  * Licensed to the Apache Software Foundation (ASF) under one or more
   2  * contributor license agreements.  See the NOTICE file distributed with
   3  * this work for additional information regarding copyright ownership.
   4  * The ASF licenses this file to You under the Apache License, Version 2.0
   5  * (the "License"); you may not use this file...
```
========================================================================================================================
AGENT:
<thinking>
Now I understand the issue better. The `Code.ILLEGAL_POLLING_TIME` is a new code that was introduced in `rocketmq-proto` 2.0.1. Older clients (<=5.0.2) won't recognize this code.

Looking at the code, I can see that when the polling time is too short, the code returns `Code.ILLEGAL_POLLING_TIME`. For backward compatibility, I should use a code that exists in older versions of the protocol.

Looking at the existing codes used in the codebase:
- `Code.BAD_REQUEST` - for invalid requests
- `Code.FORBIDDEN` - for forbidden actions
- `Code.INTERNAL_SERVER_ERROR` - for internal errors
- `Code.TOPIC_NOT_FOUND` - for topic not found
- `Code.CONSUMER_GROUP_NOT_FOUND` - for consumer group not found
- `Code.INVALID_RECEIPT_HANDLE` - for invalid receipt handle
- `Code.ILLEGAL_FILTER_EXPRESSION` - for illegal filter expression
- `Code.TOO_MANY_REQUESTS` - for too many requests
- `Code.NOT_IMPLEMENTED` - for not implemented
- `Code.PROXY_TIMEOUT` - for proxy timeout
- `Code.MESSAGE_PROPERTY_CONFLICT_WITH_TYPE` - for message property conflict

The most appropriate replacement for `ILLEGAL_POLLING_TIME` would be `Code.BAD_REQUEST` since it's a client error related to invalid request parameters (the polling time is too short). This code should exist in older versions of the protocol.

Let me verify by looking at the test file to understand how this is tested.
</thinking>
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- proxy/src/test/java/org/apache/rocketmq/proxy/grpc/v2/consumer/ReceiveMessageActivityTest.java

========================================================================================================================
TOOL RETURN (open_files)
```
['Successfully opened proxy/src/test/java/org/apache/rocketmq/proxy/grpc/v2/consumer/ReceiveMessageActivityTest.java:\n\n````java\n   0 /*\n...\n  62 public class ReceiveMessageActivityTest extends BaseActivityTest {\n  63 \n  64     protected static final String BROKER_NAME = "broker";\n...\n  71     @Before\n  72     public void before() throws Throwable {\n...\n  79     @Test\n  80     public void testReceiveMessagePollingTime() {\n  81         StreamObserver<ReceiveMessageResponse> receiveSt...
```
========================================================================================================================
TOOL CALL (grep)
content_pattern: ILLEGAL_POLLING_TIME
path_glob: '**/*.java'

========================================================================================================================
TOOL RETURN (grep)
```
proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/consumer/ReceiveMessageActivity.java:88:                    writer.writeAndComplete(ctx, Code.ILLEGAL_POLLING_TIME, "The deadline time remaining is not enough" +...
```
========================================================================================================================
AGENT:
Now I understand the issue. The `Code.ILLEGAL_POLLING_TIME` is used in only one place. To make it backward compatible with older gRPC clients (<=5.0.2), I need to replace it with a code that exists in older versions of the protocol.

Looking at the context, the error is about the polling time being too short (the deadline time remaining is not enough). The most appropriate backward-compatible code would be `Code.BAD_REQUEST` since it's a client error related to invalid request parameters.

Let me make the change:
========================================================================================================================
TOOL CALL (find_and_replace_code)
file_path: proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/consumer/ReceiveMessageActivity.java
find: "                    writer.writeAndComplete(ctx, Code.ILLEGAL_POLLING_TIME,\
  \ \"The deadline time remaining is not enough\" +\n                        \" for\
  \ polling, please check network condition\");"
replace: "                    writer.writeAndComplete(ctx, Code.BAD_REQUEST, \"The\
  \ deadline time remaining is not enough\" +\n                        \" for polling,\
  \ please check network condition\");"

========================================================================================================================
TOOL RETURN (find_and_replace_code)
```
Successfully replaced code in proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/consumer/ReceiveMessageActivity.java:

--- proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/consumer/ReceiveMessageActivity.java
+++ proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/consumer/ReceiveMessageActivity.java
@@ -85,7 +85,7 @@
                 if (timeRemaining >= config.getGrpcClientConsumerMinLongPollingTimeoutMillis()) {
                     pollingTime = timeRemaining;
                 } e...
```
========================================================================================================================
AGENT:
Now let me verify the change was applied correctly and check if there are any tests that need to be updated:
========================================================================================================================
TOOL CALL (grep)
content_pattern: ILLEGAL_POLLING_TIME
path_glob: '**/*.java'

========================================================================================================================
TOOL RETURN (grep)
```
No matches found for pattern 'ILLEGAL_POLLING_TIME'....
```
========================================================================================================================
AGENT:
Good, the `ILLEGAL_POLLING_TIME` code is no longer used. Let me verify the change by looking at the modified file:
========================================================================================================================
TOOL CALL (inspect_code)
file_path: proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/consumer/ReceiveMessageActivity.java
line_ranges:
- - 80
  - 95

========================================================================================================================
TOOL RETURN (inspect_code)
```
Successfully expanded code chunks in proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/consumer/ReceiveMessageActivity.java:

````java
   0 /*
   1  * Licensed to the Apache Software Foundation (ASF) under one or more
   2  * contributor license agreements.  See the NOTICE file distributed with
   3  * this work for additional information regarding copyright ownership.
   4  * The ASF licenses this file to You under the Apache License, Version 2.0
   5  * (the "License"); you may not use thi...
```
========================================================================================================================
AGENT:
The change has been applied correctly. Now let me check if there are any tests that specifically test for `ILLEGAL_POLLING_TIME`:
========================================================================================================================
TOOL CALL (inspect_code)
file_path: proxy/src/test/java/org/apache/rocketmq/proxy/grpc/v2/consumer/ReceiveMessageActivityTest.java
line_ranges:
- - 0
  - -1

========================================================================================================================
TOOL RETURN (inspect_code)
```
Successfully expanded code chunks in proxy/src/test/java/org/apache/rocketmq/proxy/grpc/v2/consumer/ReceiveMessageActivityTest.java:

````java
   0 /*
   1  * Licensed to the Apache Software Foundation (ASF) under one or more
   2  * contributor license agreements.  See the NOTICE file distributed with
   3  * this work for additional information regarding copyright ownership.
   4  * The ASF licenses this file to You under the Apache License, Version 2.0
   5  * (the "License"); you may not use...
```
========================================================================================================================
AGENT:
I can see that the test file doesn't have any specific test for `ILLEGAL_POLLING_TIME`. The test `testReceiveMessagePollingTime` sets `GrpcClientConsumerMinLongPollingTimeoutMillis` to 0, which means the code path that returns `ILLEGAL_POLLING_TIME` (now `BAD_REQUEST`) is not triggered in this test.

Let me try to build and run the tests to make sure the change doesn't break anything:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && find . -name "pom.xml" -path "./proxy/*" | head -1

========================================================================================================================
TOOL RETURN (bash)
```
./proxy/pom.xml...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && mvn compile -pl proxy -am -DskipTests -q 2>&1 | tail -50
timeout: 300

========================================================================================================================
TOOL RETURN (bash)
```
tmp_code_100535350c6fa26882b7d40b4fe72cf320026e24a2f793d75986f092c793a62b.bash: line 1: mvn: command not found...
```
========================================================================================================================
TOOL CALL (bash)
command: which java && which mvn || echo "Maven not found, checking for alternatives"

========================================================================================================================
TOOL RETURN (bash)
```
/usr/bin/java
Maven not found, checking for alternatives...
```
========================================================================================================================
TOOL CALL (bash)
command: apt-get update && apt-get install -y maven 2>&1 | tail -10
timeout: 120

========================================================================================================================
TOOL RETURN (bash)
```
Hit:2 http://ports.ubuntu.com/ubuntu-ports noble InRelease
Hit:1 https://apt.llvm.org/noble llvm-toolchain-noble-20 InRelease
Get:3 http://ports.ubuntu.com/ubuntu-ports noble-updates InRelease [126 kB]
Get:4 http://ports.ubuntu.com/ubuntu-ports noble-backports InRelease [126 kB]
Get:5 http://ports.ubuntu.com/ubuntu-ports noble-security InRelease [126 kB]
Get:6 http://ports.ubuntu.com/ubuntu-ports noble-updates/main arm64 Packages [2152 kB]
Get:7 http://ports.ubuntu.com/ubuntu-ports noble-updates...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && mvn compile -pl proxy -am -DskipTests -q 2>&1 | tail -50
timeout: 600

========================================================================================================================
TOOL RETURN (bash)
```
OpenJDK 64-Bit Server VM warning: Unable to get SVE vector length on this system. Disabling SVE. Specify -XX:UseSVE=0 to shun this warning.
     [java] JVM args ignored when same JVM is used.
[[1;31mERROR[m] Failed to execute goal [32mcom.github.spotbugs:spotbugs-maven-plugin:4.2.2:spotbugs[m [1m(spotbugs)[m on project [36mrocketmq-common[m: [1;31mExecution spotbugs of goal com.github.spotbugs:spotbugs-maven-plugin:4.2.2:spotbugs failed: java.lang.UnsupportedOperationException: The Secu...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && mvn compile -pl proxy -am -DskipTests -Dspotbugs.skip=true
  -q 2>&1 | tail -50
timeout: 600

========================================================================================================================
TOOL RETURN (bash)
```
OpenJDK 64-Bit Server VM warning: Unable to get SVE vector length on this system. Disabling SVE. Specify -XX:UseSVE=0 to shun this warning....
```
========================================================================================================================
AGENT:
The code compiles successfully. Now let me run the specific test to verify the change doesn't break anything:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && mvn test -pl proxy -Dtest=ReceiveMessageActivityTest -Dspotbugs.skip=true
  -q 2>&1 | tail -50
timeout: 300

========================================================================================================================
TOOL RETURN (bash)
```
If you're not sure why you're getting this error, please report to the mailing list.


Java               : 21
JVM vendor name    : Ubuntu
JVM vendor version : 21.0.8+9-Ubuntu-0ubuntu124.04.1
JVM name           : OpenJDK 64-Bit Server VM
JVM version        : 21.0.8+9-Ubuntu-0ubuntu124.04.1
JVM info           : mixed mode, sharing
OS name            : Linux
OS version         : 6.10.14-linuxkit


You are seeing this disclaimer because Mockito is configured to create inlined mocks.
You can learn a...
```
========================================================================================================================
AGENT:
The test failure is due to a Java version incompatibility with Mockito (Java 21 vs older Mockito version), not related to my change. Let me try with a different Java version:
========================================================================================================================
TOOL CALL (bash)
command: pyenv global 3.11.12 && java -version 2>&1

========================================================================================================================
TOOL RETURN (bash)
```
OpenJDK 64-Bit Server VM warning: Unable to get SVE vector length on this system. Disabling SVE. Specify -XX:UseSVE=0 to shun this warning.
openjdk version "21.0.8" 2025-07-15
OpenJDK Runtime Environment (build 21.0.8+9-Ubuntu-0ubuntu124.04.1)
OpenJDK 64-Bit Server VM (build 21.0.8+9-Ubuntu-0ubuntu124.04.1, mixed mode, sharing)...
```
========================================================================================================================
TOOL CALL (bash)
command: ls -la /usr/lib/jvm/

========================================================================================================================
TOOL RETURN (bash)
```
total 20
drwxr-xr-x 4 root root 4096 Aug 26 05:21 .
drwxr-xr-x 1 root root 4096 Aug 26 05:23 ..
-rw-r--r-- 1 root root 1840 Jul 16 21:55 .java-1.21.0-openjdk-arm64.jinfo
lrwxrwxrwx 1 root root   21 Jul 16 21:55 java-1.21.0-openjdk-arm64 -> java-21-openjdk-arm64
drwxr-xr-x 9 root root 4096 Aug 26 05:21 java-21-openjdk-arm64
drwxr-xr-x 2 root root 4096 Aug 26 05:21 openjdk-21...
```
========================================================================================================================
AGENT:
The test failure is due to Java version incompatibility with Mockito, not related to my change. The compilation succeeded, which confirms the code change is syntactically correct.

Let me verify the change once more by looking at the modified file:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && grep -n "BAD_REQUEST\|ILLEGAL_POLLING_TIME" proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/consumer/ReceiveMessageActivity.java

========================================================================================================================
TOOL RETURN (bash)
```
88:                    writer.writeAndComplete(ctx, Code.BAD_REQUEST, "The deadline time remaining is not enough" +...
```
========================================================================================================================
AGENT:
The change has been applied correctly. Let me also check if there are any other files that might reference `ILLEGAL_POLLING_TIME`:
========================================================================================================================
TOOL CALL (grep)
content_pattern: ILLEGAL_POLLING

========================================================================================================================
TOOL RETURN (grep)
```
No matches found for pattern 'ILLEGAL_POLLING'....
```
========================================================================================================================
AGENT:
No other references to `ILLEGAL_POLLING_TIME` exist in the codebase.

Let me also verify that `Code.BAD_REQUEST` is a valid code that exists in older versions of the protocol by checking how it's used elsewhere:
========================================================================================================================
TOOL CALL (grep)
content_pattern: Code\.BAD_REQUEST
path_glob: '**/*.java'

========================================================================================================================
TOOL RETURN (grep)
```
proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/client/ClientActivity.java:223:                proxyException.getCode().getNumber() >= Code.BAD_REQUEST_VALUE) {
proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/common/GrpcProxyException.java:33:        CODE_MAPPING.put(ProxyExceptionCode.INVALID_BROKER_NAME, Code.BAD_REQUEST);
proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/producer/SendMessageActivity.java:190:            throw new GrpcProxyException(Code.BAD_REQUEST, "the max t...
```
========================================================================================================================
AGENT:
`Code.BAD_REQUEST` is already used in multiple places in the codebase, confirming it's a valid and commonly used code that should be available in older versions of the protocol.

Now let me review the change one more time to ensure it's correct:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && git diff proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/consumer/ReceiveMessageActivity.java

========================================================================================================================
TOOL RETURN (bash)
```
diff --git a/proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/consumer/ReceiveMessageActivity.java b/proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/consumer/ReceiveMessageActivity.java
index 31b841132..1c6b1c658 100644
--- a/proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/consumer/ReceiveMessageActivity.java
+++ b/proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/consumer/ReceiveMessageActivity.java
@@ -85,7 +85,7 @@ public class ReceiveMessageActivity extends AbstractMessi...
```
========================================================================================================================
AGENT:
The change is correct. Let me also verify that the compilation is successful by checking the generated class file:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && ls -la proxy/target/classes/org/apache/rocketmq/proxy/grpc/v2/consumer/ReceiveMessageActivity.class
  2>/dev/null && echo "Class file exists" || echo "Class file not found (may need
  to recompile)"

========================================================================================================================
TOOL RETURN (bash)
```
-rw-r--r-- 1 root root 12672 Dec  5 13:27 proxy/target/classes/org/apache/rocketmq/proxy/grpc/v2/consumer/ReceiveMessageActivity.class
Class file exists...
```
========================================================================================================================
AGENT:
The class file was successfully compiled with the change.
========================================================================================================================
AGENT:
I have made the change to replace `Code.ILLEGAL_POLLING_TIME` with `Code.BAD_REQUEST` in ReceiveMessageActivity.java. This resolves the backward compatibility issue with gRPC clients <=5.0.2 since `Code.ILLEGAL_POLLING_TIME` was only introduced in `rocketmq-proto` 2.0.1 (integrated in gRPC client 5.0.3). The code compiles successfully. Now verifying the change is complete and correct.
========================================================================================================================
AGENT:
Let me do a final review of the change to ensure it's complete:
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/consumer/ReceiveMessageActivity.java

========================================================================================================================
TOOL RETURN (open_files)
```
['Successfully opened proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/consumer/ReceiveMessageActivity.java:\n\n````java\n   0 /*\n   1  * Licensed to the Apache Software Foundation (ASF) under one or more\n   2  * contributor license agreements.  See the NOTICE file distributed with\n   3  * this work for additional information regarding copyright ownership.\n   4  * The ASF licenses this file to You under the Apache License, Version 2.0\n   5  * (the "License"); you may not use this file ...
```
========================================================================================================================
AGENT:
The change has been successfully applied. Let me summarize what was done:

## Summary

The problem statement indicated that `Code.ILLEGAL_POLLING_TIME` was introduced in `rocketmq-proto` 2.0.1, which is only integrated by gRPC client 5.0.3+. This means older clients (<=5.0.2) would not recognize this error code, causing compatibility issues.

### Change Made

**File:** `proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/consumer/ReceiveMessageActivity.java`

**Line 87-88:** Changed from:
```java
writer.writeAndComplete(ctx, Code.ILLEGAL_POLLING_TIME, "The deadline time remaining is not enough" +
    " for polling, please check network condition");
```

To:
```java
writer.writeAndComplete(ctx, Code.BAD_REQUEST, "The deadline time remaining is not enough" +
    " for polling, please check network condition");
```

### Rationale

- `Code.BAD_REQUEST` is a standard error code that has been available in older versions of the protocol
- It's already used in multiple places in the codebase (e.g., `GrpcProxyException.java`, `SendMessageActivity.java`)
- The error message remains descriptive enough to indicate the actual issue (polling time is too short)
- This change maintains backward compatibility with gRPC clients <=5.0.2 while still properly indicating a client error

The code compiles successfully, confirming the change is syntactically correct.
========================================================================================================================
AGENT:
Successfully resolved the backward compatibility issue with gRPC clients <=5.0.2. Changed `Code.ILLEGAL_POLLING_TIME` to `Code.BAD_REQUEST` in `proxy/src/main/java/org/apache/rocketmq/proxy/grpc/v2/consumer/ReceiveMessageActivity.java` (line 87). The `ILLEGAL_POLLING_TIME` code was introduced in `rocketmq-proto` 2.0.1 (integrated in gRPC client 5.0.3), which caused compatibility issues with older clients. `Code.BAD_REQUEST` is a standard error code available in older protocol versions and is already used elsewhere in the codebase. The code compiles successfully.
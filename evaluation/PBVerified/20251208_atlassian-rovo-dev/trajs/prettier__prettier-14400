########################################################################################################################
PHASE 1
########################################################################################################################
========================================================================================================================
AGENT:
I will start by viewing the workspace to understand its structure and contents. This will help me identify key files and locations that may be relevant to the task.
========================================================================================================================
USER PROMPT:
Resolve the following problem statement:

<problem_statement>
Script in SVG is incorrectly formatted when using HTML parser
<!--

BEFORE SUBMITTING AN ISSUE:

1.  Search for your issue on GitHub: https://github.com/prettier/prettier/issues
    A large number of opened issues are duplicates of existing issues.
    If someone has already opened an issue for what you are experiencing,
    you do not need to open a new issue â€” please add a ðŸ‘ reaction to the
    existing issue instead.

2.  We get a lot of requests for adding options, but Prettier is
    built on the principle of being opinionated about code formatting.
    This means we add options only in the case of strict technical necessity.
    Find out more: https://prettier.io/docs/en/option-philosophy.html

Don't fill the form below manually! Let a program create a report for you:

1. Go to https://prettier.io/playground
2. Paste your code and set options
3. Press the "Report issue" button in the lower right

-->

**Prettier 2.7.1**
[Playground link](https://prettier.io/playground/#N4Igxg9gdgLgprEAuEAeAzgNwOYAIAeAtgDZToC8AOiABYwwAOSA9MwO4cB0bAzJxACdszAEwAGCcyzZquNgEsAJjBpUQIgCxjZNOPOx01m7SFyZ5cNgCEI+NWNwPNuTdQB8lKJRiow8gWDEcLhgdtQAjCKyYACeajxRpgJqAGyyAGbyxMRqYACuAgIIMADCEMSC7p7e3qgAhlDyhHXwuC0wAvIARnnwAHJ1hHC5MbKYdcR5cBTUCQDckbKKBfacKegZWTnU6UVwAF5wssweXj7MfgFBp7V4mdlqUNBHpugdEADWw9T5hcVlFQEsjeAk+cAAtMR5FA4GA6gw1KC8lBFMD3l9wQplKpqIlcCCweDFHV0DQ6oU6nFcWjQRjiaSIOl0ug4DAjFUzrUGC0aLhFGoALIOEw3GA1HwNJotYLtTo9fqDb4gVGmcaTaaCyK4cIATkw4QFuu1IhoBq1AFZMOCDebjTRrXNDSIXOF9QKROE7WbnTwrQaeHbrbIunBsNDVgB2DamZbJahiTgiaO4e7bEC7OAHF64E7VMX5+qNZqtWXdXpwAZDNQEukkmiM5mssYTKYzdRzEy4ENhqCR5Ox1ZJzYPHZ7Q7HUW1ZjclSTnwz3n86hCxwc8W1SXFmX0OXlytKlVmFsa5fhCPaiPEBO26+G8+X6+4cG3+-EZ+cW3v80C89nt+P69HXCAAOD9tVA80rzA28QLA80Pygz9b3g20UP-MCvwFFDwIQr9HA-YNQ3DeNOB1fsVhIodTFTNQMyzCc83FQspRLHcywVKtqBrCF6XrJkWTFVVjzbEQO0IntVjIpYKJABMqJTLZaLHbMlDUYgSRgABldFs1zTlzgXOdmK3AAVAQGnQdJBEINo2PlCtFTUDoLKsgRCFkGAYgYJVQRgaVm3VNsHC1SI5h4FJgudRZTG7YiQHUt5tNpOBOAQQ8B1mMRkyKbyWjKZE2WoaFFDgTJGngBizlQZhsFFDAwE6BgYDnRQIHyIZYE4OpFEUABRTBigAGXkN4EDgAQAAoAHIABEAHkBTKWAhogbq4EUKaABpcAmgBKXByDcXBgEY-NIDIGBcCeEqDr5Nq8g6mBOGwVleqCR6rBiABJRRpoSrSdKm3a5lO7x5HSHbrrgfaTv08Ugku6RbqhzhuSKWA+ggErUfJYpMextG8axuAQbh-NwZ2qbuTyFkAEEixaeRoHQKbcGhfEcBh0H828BHcHrAaBFu9IJhZUn1x5mA+YqNbFGF0WSe58UUe6vqBtgYbRphSaprS-rii2nb9sO46lclmWSrl8hcA6KZxcliWKYmgBCAXxq5smJe8aQcZpuB6ZYpmyD2+2vfzABfM3vHD4Go5gH3Vf1jWRvgbXpsICA-eKcbDb2g6jthsPxTdoXrdtxXPcln3kWpumGZgIP0BDuOY9Dh345wLqeqTmBNdT8b08zlkgjqAbc+Ngu4+8Ev5eIMWp4biGJot9aPaLqvO9r-368b5vK-FSP95gVuzcPiWz4j2OxSqqQGvkJrTmq6RThATaQAgJrG+QUByVBNgAAVcZkGQCACYbBKToFfiALo5kwBfC0oqYaMJkAiznnAN+MC6hwNZJpbkfgoDYGQOXN+cBCAhh6utQaDRsB5DqC9AAYtZdo0JCEoDqL0CAUC6AkAAOo0HkPAdAeC4CaQQOgAR8hzCeRAWAdAkC37QhZAIGA-9zLYGaCghWb8ABW6B8CaRYUEAAinkCA8BNFoLfmjJRIDuHECgQwTosAeFKBUMgYCYgrGghZDw8yDAQGOOmONAaUCACOpj4CqI-pAth6BwQwnWutKBRRwn+DgKouhGikCoJZG-FkhB5BEIEFMPJhi4AmLMXACxuSQB+S6C47EyARBv2clkFhZRCBZJANMc0UC-YmTqF0GJOT0EgEwFML6KJiiaTvk1emihtIxCCNUuA4dw5AA)

```sh
# Options (if any):
--parser html
```

**Input:**

```html
<svg xmlns="http://www.w3.org/2000/svg" width="240" height="240" viewBox="0 0 24 24">
	<script>
		document.addEventListener('DOMContentLoaded', () => {
			const node = document.getElementById('lastStroke');
			if (node) {
				let svg = node.parentNode.parentNode.parentNode;
				if ('pauseAnimations' in svg) {
					let hover = false;
					let loaded = false;
					node.addEventListener('endEvent', () => {
						loaded = true;
						if (!hover) {
							svg.pauseAnimations();
						}
					});
					svg.addEventListener('mouseenter', () => {
						hover = true;
						svg.unpauseAnimations();
					});
					svg.addEventListener('mouseleave', () => {
						hover = false;
						if (loaded) {
							svg.pauseAnimations();
						}
					});
				}
			}
		});	
	</script>
</svg>
```

**Output:**

```svg
<svg
  xmlns="http://www.w3.org/2000/svg"
  width="240"
  height="240"
  viewBox="0 0 24 24"
>
  <script>
    document.addEventListener('DOMContentLoaded', () => { const node =
    document.getElementById('lastStroke'); if (node) { let svg =
    node.parentNode.parentNode.parentNode; if ('pauseAnimations' in svg) { let
    hover = false; let loaded = false; node.addEventListener('endEvent', () => {
    loaded = true; if (!hover) { svg.pauseAnimations(); } });
    svg.addEventListener('mouseenter', () => { hover = true;
    svg.unpauseAnimations(); }); svg.addEventListener('mouseleave', () => {
    hover = false; if (loaded) { svg.pauseAnimations(); } }); } } });
  </script>
</svg>
```

**Expected behavior:**

Expected output to be readable.

There is no special parser for SVG, so using HTML parser to format it. However, something weird happens when there is a script inside SVG and Prettier turns it into unreadable mess.

</problem_statement>

Do not stop until you have made code changes that resolve the problem statement. Do not ask for clarifications.

NEVER attempt to find the solution to the problem statement by searching future commits or branches in the repository.
========================================================================================================================
AGENT:
Starting to analyze the problem statement. The issue is that when using the HTML parser to format SVG files containing script tags, the JavaScript inside the script tag is being incorrectly formatted - it's being treated as text and wrapped incorrectly instead of being properly formatted as JavaScript code.
========================================================================================================================
AGENT:
STEP 1: EXPLORE THE WORKSPACE

<thinking>
Let me understand the problem:
1. When using the HTML parser to format SVG files containing `<script>` tags, the JavaScript inside the script tag is being incorrectly formatted
2. The JavaScript is being treated as text and wrapped incorrectly instead of being properly formatted as JavaScript code
3. This happens specifically when the script is inside an SVG element

I need to:
1. Explore the HTML language handling code to understand how script tags are processed
2. Find where the decision is made about whether to format script content as JavaScript
3. Identify why SVG script tags are being treated differently from HTML script tags

Let me start by exploring the language-html directory since that's where the HTML parser and printer would be.
</thinking>
========================================================================================================================
TOOL CALL (expand_folder)
folder_path: src/language-html

========================================================================================================================
TOOL RETURN (expand_folder)
```
src/:

src/language-html/:
ast.js
clean.js
conditional-comment.js
constants.evaluate.js
embed.js
get-node-content.js
get-visitor-keys.js
index.js
languages.evaluate.js
loc.js
options.js
parser-html.js
pragma.js
print-preprocess.js
printer-html.js
syntax-attribute.js
syntax-vue.js
visitor-keys.js

src/language-html/print/:
children.js
element.js
tag.js

src/language-html/utils/:
html-elements-attributes.evaluate.js
html-tag-names.evaluate.js
index.js
is-unknown-namespace.js
is-vue-sfc-with-typesc...
```
========================================================================================================================
AGENT:
<thinking>
The `embed.js` file is likely where the decision is made about how to handle embedded content like JavaScript in script tags. Let me also look at `utils/index.js` which might have helper functions for determining how to handle different elements.
</thinking>
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- src/language-html/embed.js
- src/language-html/utils/index.js

========================================================================================================================
TOOL RETURN (open_files)
```
['Successfully opened src/language-html/embed.js:\n\n````javascript\n   0 import {\n...\n  38 async function printEmbeddedAttributeValue(path, htmlTextToDoc, options) {\n...\n 257 function embed(path, options) {\n...\n 427 \n````', 'Successfully opened src/language-html/utils/index.js:\n\n````javascript\n   0 /**\n...\n  17 const htmlTrimLeadingBlankLines = (string) =>\n  18   string.replaceAll(/^[\\t\\f\\r ]*\\n/g, "");\n  19 const htmlTrimPreserveIndentation = (string) =>\n  20   htmlTrimLeadi...
```
========================================================================================================================
AGENT:
<thinking>
I can see there's an `isScriptLikeTag` function and an `inferScriptParser` function. Let me expand these to understand how script tags are handled. The issue might be in how the parser determines whether to format the content as JavaScript.
</thinking>
========================================================================================================================
TOOL CALL (inspect_code)
file_path: src/language-html/utils/index.js
patterns:
- isScriptLikeTag
- inferScriptParser
- inferElementParser

========================================================================================================================
TOOL RETURN (inspect_code)
```
Successfully expanded code chunks in src/language-html/utils/index.js:

````javascript
   0 /**
   1  * @typedef {import("../../common/ast-path.js").default} AstPath
   2  */
   3 
   4 import isFrontMatter from "../../utils/front-matter/is-front-matter.js";
   5 import inferParser from "../../utils/infer-parser.js";
   6 import { line, hardline, join } from "../../document/builders.js";
   7 import { replaceEndOfLine } from "../../document/utils.js";
   8 import {
   9   CSS_DISPLAY_TAGS,
  10 ...
```
========================================================================================================================
AGENT:
<thinking>
Now I can see the issue! Looking at the `inferScriptParser` function (lines 369-385):

```javascript
function inferScriptParser(node, options) {
  const { name, attrMap } = node;

  if (name !== "script" || Object.hasOwn(attrMap, "src")) {
    return;
  }

  const { type, lang } = node.attrMap;

  if (!lang && !type) {
    return "babel";
  }

  return (
    inferParser(options, { language: lang }) ?? inferParserByTypeAttribute(type)
  );
}
```

The problem is that this function checks `node.name !== "script"`, but when the script tag is inside an SVG, the node's `fullName` would be `"svg:script"` while the `name` would still be `"script"`. However, looking at `isScriptLikeTag`:

```javascript
function isScriptLikeTag(node) {
  return (
    node.type === "element" &&
    (node.fullName === "script" ||
      node.fullName === "style" ||
      node.fullName === "svg:style" ||
      (isUnknownNamespace(node) &&
        (node.name === "script" || node.name === "style")))
  );
}
```

This function handles `svg:style` but NOT `svg:script`! This is the bug. The `isScriptLikeTag` function includes `svg:style` but not `svg:script`.

Let me also look at the `embed.js` file to see how it uses these functions to determine whether to format the content as JavaScript.
</thinking>
========================================================================================================================
TOOL CALL (inspect_code)
file_path: src/language-html/embed.js
patterns:
- embed

========================================================================================================================
TOOL RETURN (inspect_code)
```
Successfully expanded code chunks in src/language-html/embed.js:

````javascript
   0 import {
   1   breakParent,
   2   group,
   3   hardline,
   4   indent,
   5   line,
   6   fill,
   7   softline,
   8 } from "../document/builders.js";
   9 import { mapDoc, replaceEndOfLine } from "../document/utils.js";
  10 import printFrontMatter from "../utils/front-matter/print.js";
  11 import {
  12   printClosingTag,
  13   printClosingTagSuffix,
  14   needsToBorrowPrevClosingTagEndMarker,
  15  ...
```
========================================================================================================================
AGENT:
<thinking>
Now I understand the issue better. Looking at the code flow:

1. In `embed.js`, when processing a `text` node (line 298-361), it checks if the parent is a script-like tag using `isScriptLikeTag(node.parent)` (line 299).

2. If it is a script-like tag, it calls `inferElementParser(node.parent, options)` to get the parser (line 300).

3. The `inferElementParser` function (lines 412-418 in utils/index.js) calls `inferScriptParser`, `inferStyleParser`, and `inferVueSfcBlockParser`.

4. Looking at `inferScriptParser` (lines 369-385):
```javascript
function inferScriptParser(node, options) {
  const { name, attrMap } = node;

  if (name !== "script" || Object.hasOwn(attrMap, "src")) {
    return;
  }
  // ...
}
```

This checks `node.name !== "script"`. When the script is inside an SVG, the node's `name` should still be `"script"` (the local name), but let me verify this.

5. Looking at `isScriptLikeTag` (lines 105-114):
```javascript
function isScriptLikeTag(node) {
  return (
    node.type === "element" &&
    (node.fullName === "script" ||
      node.fullName === "style" ||
      node.fullName === "svg:style" ||
      (isUnknownNamespace(node) &&
        (node.name === "script" || node.name === "style")))
  );
}
```

This function checks for `svg:style` but NOT `svg:script`. This is the bug!

When a script tag is inside an SVG, its `fullName` would be `"svg:script"` (not `"script"`), so `isScriptLikeTag` returns `false`, and the content is not treated as JavaScript.

Let me verify this by checking how the parser handles SVG namespaces. Let me also look at the `isUnknownNamespace` function.
</thinking>
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- src/language-html/utils/is-unknown-namespace.js

========================================================================================================================
TOOL RETURN (open_files)
```
['Successfully opened src/language-html/utils/is-unknown-namespace.js:\n\n````javascript\n   0 function isUnknownNamespace(node) {\n   1   return (\n   2     node.type === "element" &&\n   3     !node.hasExplicitNamespace &&\n   4     !["html", "svg"].includes(node.namespace)\n   5   );\n   6 }\n   7 \n   8 export default isUnknownNamespace;\n   9 \n````']...
```
========================================================================================================================
AGENT:
<thinking>
Now I understand the issue completely:

1. When a `<script>` tag is inside an `<svg>` element, the HTML parser assigns it the `svg` namespace.
2. The `isScriptLikeTag` function checks for:
   - `node.fullName === "script"` - This would be true for HTML script tags
   - `node.fullName === "style"` - This would be true for HTML style tags
   - `node.fullName === "svg:style"` - This handles SVG style tags
   - `isUnknownNamespace(node) && (node.name === "script" || node.name === "style")` - This handles script/style in unknown namespaces

3. The problem is that `svg:script` is NOT handled! The function handles `svg:style` but not `svg:script`.

4. When `isScriptLikeTag` returns `false` for an SVG script tag, the content is not passed to the JavaScript parser and is instead treated as regular text, which causes the incorrect formatting.

The fix is simple: add `node.fullName === "svg:script"` to the `isScriptLikeTag` function.

Let me also check if there are any other places that might need similar fixes.
</thinking>
========================================================================================================================
TOOL CALL (grep)
content_pattern: svg:script

========================================================================================================================
TOOL RETURN (grep)
```
No matches found for pattern 'svg:script'....
```
========================================================================================================================
TOOL CALL (grep)
content_pattern: svg:style

========================================================================================================================
TOOL RETURN (grep)
```
src/language-html/utils/index.js:111:      node.fullName === "svg:style" ||...
```
========================================================================================================================
AGENT:
<thinking>
Good, I confirmed that `svg:style` is only used in one place - the `isScriptLikeTag` function. Now I need to add `svg:script` to this function to fix the issue.

Let me make the fix:
</thinking>

STEP 2: MAKE THE FIX
========================================================================================================================
TOOL CALL (find_and_replace_code)
file_path: src/language-html/utils/index.js
find: "function isScriptLikeTag(node) {\n  return (\n    node.type === \"element\"\
  \ &&\n    (node.fullName === \"script\" ||\n      node.fullName === \"style\" ||\n\
  \      node.fullName === \"svg:style\" ||\n      (isUnknownNamespace(node) &&\n\
  \        (node.name === \"script\" || node.name === \"style\")))\n  );\n}"
replace: "function isScriptLikeTag(node) {\n  return (\n    node.type === \"element\"\
  \ &&\n    (node.fullName === \"script\" ||\n      node.fullName === \"style\" ||\n\
  \      node.fullName === \"svg:style\" ||\n      node.fullName === \"svg:script\"\
  \ ||\n      (isUnknownNamespace(node) &&\n        (node.name === \"script\" || node.name\
  \ === \"style\")))\n  );\n}"

========================================================================================================================
TOOL RETURN (find_and_replace_code)
```
Successfully replaced code in src/language-html/utils/index.js:

--- src/language-html/utils/index.js
+++ src/language-html/utils/index.js
@@ -109,6 +109,7 @@
     (node.fullName === "script" ||
       node.fullName === "style" ||
       node.fullName === "svg:style" ||
+      node.fullName === "svg:script" ||
       (isUnknownNamespace(node) &&
         (node.name === "script" || node.name === "style")))
   );
...
```
========================================================================================================================
AGENT:
STEP 3: VERIFY THE FIX

<thinking>
Now I need to verify that the fix works. Let me create a test file and run prettier on it to see if the script inside SVG is now properly formatted.

First, let me check how to run prettier in this project.
</thinking>
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && cat package.json | head -50

========================================================================================================================
TOOL RETURN (bash)
```
{
  "name": "prettier",
  "version": "3.0.0-alpha.6",
  "description": "Prettier is an opinionated code formatter",
  "bin": "./bin/prettier.cjs",
  "repository": "prettier/prettier",
  "funding": "https://github.com/prettier/prettier?sponsor=1",
  "homepage": "https://prettier.io",
  "author": "James Long",
  "type": "module",
  "license": "MIT",
  "main": "./src/index.cjs",
  "browser": "./standalone.js",
  "unpkg": "./standalone.js",
  "exports": {
    ".": {
      "require": "./src/index.cjs...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && yarn install 2>&1 | tail -20

========================================================================================================================
TOOL RETURN (bash)
```
âž¤ YN0013: â”‚ yargs-parser@npm:20.2.9 can't be found in the cache and will be fetched from the remote registry
âž¤ YN0013: â”‚ yargs-parser@npm:21.1.1 can't be found in the cache and will be fetched from the remote registry
âž¤ YN0013: â”‚ yargs@npm:16.2.0 can't be found in the cache and will be fetched from the remote registry
âž¤ YN0013: â”‚ yargs@npm:17.6.2 can't be found in the cache and will be fetched from the remote registry
âž¤ YN0013: â”‚ yargs-parser@npm:20.2.9 can't be found in the cache and will be fe...
```
========================================================================================================================
TOOL CALL (bash)
command: "cd /workspace && cat > /tmp/test-svg-script.html << 'EOF'\n<svg xmlns=\"\
  http://www.w3.org/2000/svg\" width=\"240\" height=\"240\" viewBox=\"0 0 24 24\"\
  >\n\t<script>\n\t\tdocument.addEventListener('DOMContentLoaded', () => {\n\t\t\t\
  const node = document.getElementById('lastStroke');\n\t\t\tif (node) {\n\t\t\t\t\
  let svg = node.parentNode.parentNode.parentNode;\n\t\t\t\tif ('pauseAnimations'\
  \ in svg) {\n\t\t\t\t\tlet hover = false;\n\t\t\t\t\tlet loaded = false;\n\t\t\t\
  \t\tnode.addEventListener('endEvent', () => {\n\t\t\t\t\t\tloaded = true;\n\t\t\t\
  \t\t\tif (!hover) {\n\t\t\t\t\t\t\tsvg.pauseAnimations();\n\t\t\t\t\t\t}\n\t\t\t\
  \t\t});\n\t\t\t\t\tsvg.addEventListener('mouseenter', () => {\n\t\t\t\t\t\thover\
  \ = true;\n\t\t\t\t\t\tsvg.unpauseAnimations();\n\t\t\t\t\t});\n\t\t\t\t\tsvg.addEventListener('mouseleave',\
  \ () => {\n\t\t\t\t\t\thover = false;\n\t\t\t\t\t\tif (loaded) {\n\t\t\t\t\t\t\t\
  svg.pauseAnimations();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\t\
  \n\t</script>\n</svg>\nEOF"

========================================================================================================================
TOOL RETURN (bash)
```
...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && node bin/prettier.js --parser html /tmp/test-svg-script.html

========================================================================================================================
TOOL RETURN (bash)
```
<svg
  xmlns="http://www.w3.org/2000/svg"
  width="240"
  height="240"
  viewBox="0 0 24 24"
>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const node = document.getElementById("lastStroke");
      if (node) {
        let svg = node.parentNode.parentNode.parentNode;
        if ("pauseAnimations" in svg) {
          let hover = false;
          let loaded = false;
          node.addEventListener("endEvent", () => {
            loaded = true;
            if (!hover) {...
```
========================================================================================================================
AGENT:
The fix works! The JavaScript inside the SVG script tag is now properly formatted instead of being treated as text and wrapped incorrectly.

STEP 4: CHECK FOR EXISTING TESTS

<thinking>
Let me check if there are existing tests for SVG script tags or similar functionality that I should update or add to.
</thinking>
========================================================================================================================
TOOL CALL (grep)
content_pattern: svg.*script
path_glob: '**/tests/**/*.js'

========================================================================================================================
TOOL RETURN (grep)
```
No matches found for pattern 'svg.*script'....
```
========================================================================================================================
TOOL CALL (grep)
content_pattern: svg:style
path_glob: '**/tests/**/*'

========================================================================================================================
TOOL RETURN (grep)
```
No matches found for pattern 'svg:style'....
```
========================================================================================================================
TOOL CALL (expand_folder)
folder_path: tests/format/html/svg

========================================================================================================================
TOOL RETURN (expand_folder)
```
tests/:

tests/format/:

tests/format/html/:

tests/format/html/svg/:
jsfmt.spec.js
svg.html

tests/format/html/svg/__snapshots__/:
jsfmt.spec.js.snap...
```
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- tests/format/html/svg/svg.html
- tests/format/html/svg/jsfmt.spec.js

========================================================================================================================
TOOL RETURN (open_files)
```
['Successfully opened tests/format/html/svg/svg.html:\n\n````html\n   0 <!DOCTYPE html>\n   1 <html>\n   2   <head>\n   3     <title>SVG</title>\n   4   </head>\n   5   <body>\n   6     <svg width="100" height="100">\n   7       <circle cx="50" cy="50" r="40" stroke="green" stroke-width="4" fill="yellow" />\n   8     </svg>\n   9   </body>\n  10 </html>\n  11 \n  12 <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">\n  13 <defs /> <style >\n  14     polygon { fill: black }\n  15 \n  ...
```
========================================================================================================================
AGENT:
<thinking>
I can see there's an existing test file for SVG. The test file already has a `<style>` tag inside SVG (lines 13-22), but no `<script>` tag. Let me add a test case for script inside SVG to ensure this fix is properly tested.

Let me first check the existing snapshot to understand the expected format.
</thinking>
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- tests/format/html/svg/__snapshots__/jsfmt.spec.js.snap

========================================================================================================================
TOOL RETURN (open_files)
```
['Successfully opened tests/format/html/svg/__snapshots__/jsfmt.spec.js.snap:\n\n````\n   0 // Jest Snapshot v1, https://goo.gl/fbAQLP\n   1 \n   2 exports[`svg.html format 1`] = `\n   3 ====================================options=====================================\n   4 parsers: ["html"]\n   5 printWidth: 80\n   6                                                                                 | printWidth\n   7 =====================================input======================================\n...
```
========================================================================================================================
AGENT:
<thinking>
I can see that the CSS inside the `<style>` tag in SVG is being properly formatted (lines 75-86 in the output). Now I should add a test case for `<script>` inside SVG to ensure the fix is properly tested.

Let me add a script tag to the existing test file.
</thinking>
========================================================================================================================
TOOL CALL (find_and_replace_code)
file_path: tests/format/html/svg/svg.html
find: "<svg viewBox=\"0 0 200 200\" xmlns=\"http://www.w3.org/2000/svg\">\n<defs />\
  \ <style >\n    polygon { fill: black }\n\n    div {\n  color: white;\n      font:18px\
  \ serif;\n      height: 100%;\n      overflow: auto;\n    }\n  </style>"
replace: "<svg viewBox=\"0 0 200 200\" xmlns=\"http://www.w3.org/2000/svg\">\n<defs\
  \ /> <style >\n    polygon { fill: black }\n\n    div {\n  color: white;\n     \
  \ font:18px serif;\n      height: 100%;\n      overflow: auto;\n    }\n  </style>\n\
  \  <script>\n\t\tdocument.addEventListener('DOMContentLoaded', () => {\n\t\t\tconst\
  \ node = document.getElementById('lastStroke');\n\t\t\tif (node) {\n\t\t\t\tlet\
  \ svg = node.parentNode;\n\t\t\t\tif ('pauseAnimations' in svg) {\n\t\t\t\t\tnode.addEventListener('endEvent',\
  \ () => { svg.pauseAnimations(); });\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t</script>"

========================================================================================================================
TOOL RETURN (find_and_replace_code)
```
Successfully replaced code in tests/format/html/svg/svg.html:

--- tests/format/html/svg/svg.html
+++ tests/format/html/svg/svg.html
@@ -21,6 +21,17 @@
       overflow: auto;
     }
   </style>
+  <script>
+		document.addEventListener('DOMContentLoaded', () => {
+			const node = document.getElementById('lastStroke');
+			if (node) {
+				let svg = node.parentNode;
+				if ('pauseAnimations' in svg) {
+					node.addEventListener('endEvent', () => { svg.pauseAnimations(); });
+				}
+			}
+		});
+...
```
========================================================================================================================
AGENT:
Now let me run the test to update the snapshot and verify the fix works correctly:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && yarn test tests/format/html/svg/ --update 2>&1 | tail -30

========================================================================================================================
TOOL RETURN (bash)
```
â— Unrecognized CLI Parameter:

  Unrecognized option "update".

  CLI Options Documentation:
  https://jestjs.io/docs/cli...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && yarn test tests/format/html/svg/ -u 2>&1 | tail -40

========================================================================================================================
TOOL RETURN (bash)
```
PASS tests/format/html/svg/jsfmt.spec.js (6.321 s)
  svg.html
    âœ“ format

 â€º 1 snapshot updated.
Snapshot Summary
 â€º 1 snapshot updated from 1 test suite.

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   1 updated, 1 total
Time:        7.623 s
Ran all test suites matching /tests\/format\/html\/svg\//i....
```
========================================================================================================================
AGENT:
The test passed and the snapshot was updated. Let me check the updated snapshot to verify the script is properly formatted:
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- tests/format/html/svg/__snapshots__/jsfmt.spec.js.snap

========================================================================================================================
TOOL RETURN (open_files)
```
['Successfully opened tests/format/html/svg/__snapshots__/jsfmt.spec.js.snap:\n\n````\n   0 // Jest Snapshot v1, https://goo.gl/fbAQLP\n   1 \n   2 exports[`svg.html format 1`] = `\n   3 ====================================options=====================================\n   4 parsers: ["html"]\n   5 printWidth: 80\n   6                                                                                 | printWidth\n   7 =====================================input======================================\n...
```
========================================================================================================================
AGENT:
The snapshot shows that the JavaScript inside the SVG script tag is now properly formatted (lines 98-110 in the output). The code is:
- Properly indented
- Has proper line breaks
- Uses double quotes (as per Prettier's default)
- The arrow function callback is properly formatted with the body on separate lines

STEP 5: RUN RELATED TESTS TO ENSURE NO REGRESSIONS

<thinking>
Let me run more tests to ensure the fix doesn't break anything else. I should run tests related to HTML and script handling.
</thinking>
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && yarn test tests/format/html/script/ 2>&1 | tail -20

========================================================================================================================
TOOL RETURN (bash)
```
PASS tests/format/html/script/jsfmt.spec.js (7.515 s)
  babel.html
    âœ“ format
  legacy.html
    âœ“ format
  module-attributes.html
    âœ“ format
  module.html
    âœ“ format
  script.html
    âœ“ format

Test Suites: 1 passed, 1 total
Tests:       5 passed, 5 total
Snapshots:   5 passed, 5 total
Time:        8.877 s
Ran all test suites matching /tests\/format\/html\/script\//i....
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && yarn test tests/format/html/js/ 2>&1 | tail -20

========================================================================================================================
TOOL RETURN (bash)
```
  empty.html
    âœ“ format
  js.html
    âœ“ format
  simple.html
    âœ“ format
  single-script.html
    âœ“ format
  something-else.html
    âœ“ format
  template-literal.html
    âœ“ format
  typescript.html
    âœ“ format

Test Suites: 1 passed, 1 total
Tests:       7 passed, 7 total
Snapshots:   7 passed, 7 total
Time:        13.308 s
Ran all test suites matching /tests\/format\/html\/js\//i....
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && yarn test tests/format/html/css/ 2>&1 | tail -20

========================================================================================================================
TOOL RETURN (bash)
```
PASS tests/format/html/css/jsfmt.spec.js
  empty.html
    âœ“ format
  less.html
    âœ“ format
  postcss.html
    âœ“ format
  scss.html
    âœ“ format
  simple.html
    âœ“ format
  single-style.html
    âœ“ format

Test Suites: 1 passed, 1 total
Tests:       6 passed, 6 total
Snapshots:   6 passed, 6 total
Time:        2.145 s
Ran all test suites matching /tests\/format\/html\/css\//i....
```
========================================================================================================================
AGENT:
All tests pass. Let me also run a broader set of HTML tests to ensure no regressions:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && yarn test tests/format/html/ 2>&1 | tail -30

========================================================================================================================
TOOL RETURN (bash)
```
PASS tests/format/html/multiparser/unknown/jsfmt.spec.js
PASS tests/format/html/multiparser/ts/jsfmt.spec.js
PASS tests/format/html/multiparser/markdown/jsfmt.spec.js
PASS tests/format/html/multiparser/js/jsfmt.spec.js
PASS tests/format/html/multiparser/css/jsfmt.spec.js
PASS tests/format/html/yaml/jsfmt.spec.js
PASS tests/format/html/text/jsfmt.spec.js
PASS tests/format/html/symbol_entities/jsfmt.spec.js
PASS tests/format/html/srcset/jsfmt.spec.js
PASS tests/format/html/prettier_ignore/jsfmt.sp...
```
========================================================================================================================
AGENT:
All 229 HTML tests pass. Let me also run the unit tests to make sure nothing is broken:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && yarn test tests/unit/ 2>&1 | tail -20

========================================================================================================================
TOOL RETURN (bash)
```
PASS tests/unit/whitespace-utils.js
PASS tests/unit/doc-builders.js
PASS tests/unit/ast-path.js
PASS tests/unit/syntax-transform.js
PASS tests/unit/resolve-parser.js
PASS tests/unit/visitor-keys.js
PASS tests/unit/traverse-doc.js
PASS tests/unit/builtin-plugins.js
PASS tests/unit/get-descendants.js
PASS tests/unit/print-doc-to-string.js
PASS tests/unit/massage-ast.js
PASS tests/unit/strip-trailing-hardline.js

Test Suites: 12 passed, 12 total
Tests:       113 passed, 113 total
Snapshots:   18 pa...
```
========================================================================================================================
AGENT:
Excellent! All unit tests pass as well. Let me also verify the fix with the exact input from the problem statement:
========================================================================================================================
TOOL CALL (bash)
command: "cd /workspace && cat > /tmp/test-issue.html << 'EOF'\n<svg xmlns=\"http://www.w3.org/2000/svg\"\
  \ width=\"240\" height=\"240\" viewBox=\"0 0 24 24\">\n\t<script>\n\t\tdocument.addEventListener('DOMContentLoaded',\
  \ () => {\n\t\t\tconst node = document.getElementById('lastStroke');\n\t\t\tif (node)\
  \ {\n\t\t\t\tlet svg = node.parentNode.parentNode.parentNode;\n\t\t\t\tif ('pauseAnimations'\
  \ in svg) {\n\t\t\t\t\tlet hover = false;\n\t\t\t\t\tlet loaded = false;\n\t\t\t\
  \t\tnode.addEventListener('endEvent', () => {\n\t\t\t\t\t\tloaded = true;\n\t\t\t\
  \t\t\tif (!hover) {\n\t\t\t\t\t\t\tsvg.pauseAnimations();\n\t\t\t\t\t\t}\n\t\t\t\
  \t\t});\n\t\t\t\t\tsvg.addEventListener('mouseenter', () => {\n\t\t\t\t\t\thover\
  \ = true;\n\t\t\t\t\t\tsvg.unpauseAnimations();\n\t\t\t\t\t});\n\t\t\t\t\tsvg.addEventListener('mouseleave',\
  \ () => {\n\t\t\t\t\t\thover = false;\n\t\t\t\t\t\tif (loaded) {\n\t\t\t\t\t\t\t\
  svg.pauseAnimations();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\t\
  \n\t</script>\n</svg>\nEOF\nnode bin/prettier.js --parser html /tmp/test-issue.html"

========================================================================================================================
TOOL RETURN (bash)
```
<svg
  xmlns="http://www.w3.org/2000/svg"
  width="240"
  height="240"
  viewBox="0 0 24 24"
>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const node = document.getElementById("lastStroke");
      if (node) {
        let svg = node.parentNode.parentNode.parentNode;
        if ("pauseAnimations" in svg) {
          let hover = false;
          let loaded = false;
          node.addEventListener("endEvent", () => {
            loaded = true;
            if (!hover) {...
```
========================================================================================================================
AGENT:
The output is now properly formatted JavaScript code, exactly as expected. The fix resolves the issue completely.

STEP 6: REVIEW CHANGES

<thinking>
Let me review the changes I made to ensure they are correct and complete:

1. I identified the issue: The `isScriptLikeTag` function in `src/language-html/utils/index.js` was checking for `svg:style` but not `svg:script`.

2. I added `node.fullName === "svg:script"` to the `isScriptLikeTag` function to handle SVG script tags.

3. I added a test case to `tests/format/html/svg/svg.html` to ensure the fix is properly tested.

4. All tests pass, including the new test case.

Let me verify the final state of the modified file:
</thinking>
========================================================================================================================
TOOL CALL (inspect_code)
file_path: src/language-html/utils/index.js
patterns:
- isScriptLikeTag

========================================================================================================================
TOOL RETURN (inspect_code)
```
Successfully expanded code chunks in src/language-html/utils/index.js:

````javascript
   0 /**
   1  * @typedef {import("../../common/ast-path.js").default} AstPath
   2  */
   3 
   4 import isFrontMatter from "../../utils/front-matter/is-front-matter.js";
   5 import inferParser from "../../utils/infer-parser.js";
   6 import { line, hardline, join } from "../../document/builders.js";
   7 import { replaceEndOfLine } from "../../document/utils.js";
   8 import {
   9   CSS_DISPLAY_TAGS,
  10 ...
```
========================================================================================================================
AGENT:
The fix is in place at line 111: `node.fullName === "svg:script"` has been added to the `isScriptLikeTag` function.

Let me also verify the test file:
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- tests/format/html/svg/svg.html

========================================================================================================================
TOOL RETURN (open_files)
```
['Successfully opened tests/format/html/svg/svg.html:\n\n````html\n   0 <!DOCTYPE html>\n   1 <html>\n   2   <head>\n   3     <title>SVG</title>\n   4   </head>\n   5   <body>\n   6     <svg width="100" height="100">\n   7       <circle cx="50" cy="50" r="40" stroke="green" stroke-width="4" fill="yellow" />\n   8     </svg>\n   9   </body>\n  10 </html>\n  11 \n  12 <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">\n  13 <defs /> <style >\n  14     polygon { fill: black }\n  15 \n  ...
```
========================================================================================================================
AGENT:
I have made the fix and verified it works. Let me run a few more tests to ensure everything is working correctly before marking as complete.
========================================================================================================================
AGENT:
Let me run a few more integration tests to make sure the fix doesn't break anything:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && yarn test tests/format/vue/ 2>&1 | tail -20

========================================================================================================================
TOOL RETURN (bash)
```
PASS tests/format/vue/multiparser/unknown/jsfmt.spec.js
PASS tests/format/vue/vue/jsfmt.spec.js
PASS tests/format/vue/indent/jsfmt.spec.js
PASS tests/format/vue/bracket-same-line/jsfmt.spec.js
PASS tests/format/vue/single-attribute-per-line/jsfmt.spec.js
PASS tests/format/vue/event-binding/no-semi/jsfmt.spec.js
PASS tests/format/vue/vue-3/jsfmt.spec.js
PASS tests/format/vue/v-for/jsfmt.spec.js
PASS tests/format/vue/ts-expression/jsfmt.spec.js
PASS tests/format/vue/range/jsfmt.spec.js
PASS tests/...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && yarn test tests/format/angular/ 2>&1 | tail -20

========================================================================================================================
TOOL RETURN (bash)
```
PASS tests/format/angular/angular/jsfmt.spec.js (5.601 s)
PASS tests/format/angular/interpolation/jsfmt.spec.js
PASS tests/format/angular/bracket-same-line/jsfmt.spec.js
PASS tests/format/angular/upper-case/jsfmt.spec.js
PASS tests/format/angular/shorthand/jsfmt.spec.js
PASS tests/format/angular/self-closing/jsfmt.spec.js

Test Suites: 6 passed, 6 total
Tests:       50 passed, 50 total
Snapshots:   50 passed, 50 total
Time:        6.678 s
Ran all test suites matching /tests\/format\/angular\//i....
```
========================================================================================================================
AGENT:
All tests pass. Let me also run a quick test to make sure the fix works for both standalone SVG files and SVG embedded in HTML:
========================================================================================================================
TOOL CALL (bash)
command: "cd /workspace && cat > /tmp/test-embedded-svg.html << 'EOF'\n<!DOCTYPE html>\n\
  <html>\n<head>\n    <title>Test</title>\n</head>\n<body>\n    <svg xmlns=\"http://www.w3.org/2000/svg\"\
  \ width=\"100\" height=\"100\">\n        <script>\n            const x = 1;\n  \
  \          const y = 2;\n            console.log(x + y);\n        </script>\n  \
  \      <circle cx=\"50\" cy=\"50\" r=\"40\" />\n    </svg>\n</body>\n</html>\nEOF\n\
  node bin/prettier.js --parser html /tmp/test-embedded-svg.html"

========================================================================================================================
TOOL RETURN (bash)
```
<!doctype html>
<html>
  <head>
    <title>Test</title>
  </head>
  <body>
    <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100">
      <script>
        const x = 1;
        const y = 2;
        console.log(x + y);
      </script>
      <circle cx="50" cy="50" r="40" />
    </svg>
  </body>
</html>...
```
========================================================================================================================
AGENT:
The JavaScript inside the SVG script tag is properly formatted in both standalone SVG and SVG embedded in HTML.

Let me also verify that the fix handles edge cases like script tags with type attributes:
========================================================================================================================
TOOL CALL (bash)
command: "cd /workspace && cat > /tmp/test-svg-script-type.html << 'EOF'\n<svg xmlns=\"\
  http://www.w3.org/2000/svg\">\n    <script type=\"text/javascript\">\n        const\
  \ x = 1;\n        const y = 2;\n        console.log(x + y);\n    </script>\n   \
  \ <script type=\"module\">\n        import { foo } from './bar.js';\n        foo();\n\
  \    </script>\n</svg>\nEOF\nnode bin/prettier.js --parser html /tmp/test-svg-script-type.html"

========================================================================================================================
TOOL RETURN (bash)
```
<svg xmlns="http://www.w3.org/2000/svg">
  <script type="text/javascript">
    const x = 1;
    const y = 2;
    console.log(x + y);
  </script>
  <script type="module">
    import { foo } from "./bar.js";
    foo();
  </script>
</svg>...
```
========================================================================================================================
AGENT:
Excellent! The fix works correctly for script tags with different type attributes as well.

Let me run one final comprehensive test to make sure nothing is broken:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && yarn test tests/integration/__tests__/format.js 2>&1 | tail
  -20

========================================================================================================================
TOOL RETURN (bash)
```
PASS tests/integration/__tests__/format.js
  âœ“ yaml parser should handle CRLF correctly
  âœ“ typescript parser should throw the first error when both JSX and non-JSX mode failed
  âœ“ html parser should handle CRLF correctly
  âœ“ markdown parser should handle CRLF correctly
  âœ“ should work with foo plugin instance
  âœ“ 'Adjacent JSX' error should not be swallowed by Babel's error recovery

Test Suites: 1 passed, 1 total
Tests:       6 passed, 6 total
Snapshots:   6 passed, 6 total
Time:        5.628 ...
```
========================================================================================================================
AGENT:
All tests pass. Let me provide a summary of the changes made:
========================================================================================================================
AGENT:
Successfully fixed the issue where script tags inside SVG elements were incorrectly formatted when using the HTML parser.

## Problem
When using the HTML parser to format SVG files containing `<script>` tags, the JavaScript inside the script tag was being treated as text and wrapped incorrectly instead of being properly formatted as JavaScript code.

## Root Cause
The `isScriptLikeTag` function in `src/language-html/utils/index.js` was checking for `svg:style` but not `svg:script`. When a script tag is inside an SVG element, its `fullName` is `"svg:script"` (not `"script"`), so the function was returning `false` and the content was not being passed to the JavaScript parser.

## Fix
Added `node.fullName === "svg:script"` to the `isScriptLikeTag` function in `src/language-html/utils/index.js` (line 111).

## Changes Made
1. **src/language-html/utils/index.js**: Added `node.fullName === "svg:script"` to the `isScriptLikeTag` function to handle SVG script tags.

2. **tests/format/html/svg/svg.html**: Added a test case with a script tag inside SVG to ensure the fix is properly tested.

3. **tests/format/html/svg/__snapshots__/jsfmt.spec.js.snap**: Updated snapshot to reflect the properly formatted JavaScript inside SVG script tags.

## Verification
- All 229 HTML format tests pass
- All 186 Vue format tests pass
- All 50 Angular format tests pass
- All 113 unit tests pass
- The exact input from the problem statement now produces properly formatted JavaScript output
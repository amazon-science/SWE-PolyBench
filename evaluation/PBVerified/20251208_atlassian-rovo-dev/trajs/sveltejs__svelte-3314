########################################################################################################################
PHASE 1
########################################################################################################################
========================================================================================================================
AGENT:
I will start by viewing the workspace to understand its structure and contents. This will help me identify key files and locations that may be relevant to the task.
========================================================================================================================
USER PROMPT:
Resolve the following problem statement:

<problem_statement>
Illegal property names aren't quoted for SSR
**Describe the bug**

A component can have a property like `<Foo x-y-z={42}/>`, and it will ordinarily be quoted by the compiler:

```js
var foo = new Foo({ props: { "x-y-z": 42 } });
```

In SSR mode, we get this instead:

```js
return `${validate_component(Foo, 'Foo').$$render($$result, { x-y-z: 42 }, {}, {})}`;
```

This is somewhat contrived (you can only access that property via `$$props['x-y-z']`), but it's a situation I've managed to encounter, and it's easily fixed.

**To Reproduce**

[Voila](https://svelte.dev/repl/07c5045a1d8044ccbba9989ea8198b05?version=3.6.9)

**Severity**

I mean... probably not the highest. But like I say, easy fix

</problem_statement>

Do not stop until you have made code changes that resolve the problem statement. Do not ask for clarifications.
========================================================================================================================
AGENT:
Starting to analyze the problem. The issue is that in SSR mode, property names that are illegal JavaScript identifiers (like `x-y-z`) are not being quoted properly. I need to find where SSR rendering handles component props and add proper quoting for illegal property names.
========================================================================================================================
AGENT:
EXPLORE WORKSPACE: Finding the relevant SSR rendering code

<thinking>
The problem is that in SSR mode, property names like `x-y-z` are not being quoted properly. The issue mentions that in client-side rendering, the property is correctly quoted as `"x-y-z": 42`, but in SSR mode it's rendered as `x-y-z: 42` which is invalid JavaScript.

I need to:
1. Find the SSR rendering code for inline components
2. Identify where props are being rendered
3. Add proper quoting for property names that are not valid JavaScript identifiers

Let me start by looking at the SSR rendering code, specifically for InlineComponent.
</thinking>
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- src/compiler/compile/render_ssr/handlers/InlineComponent.ts

========================================================================================================================
TOOL RETURN (open_files)
```
["Successfully opened src/compiler/compile/render_ssr/handlers/InlineComponent.ts:\n\n````typescript\n   0 import { escape, escape_template, stringify } from '../../utils/stringify';\n   1 import { quote_name_if_necessary } from '../../../utils/names';\n   2 import { snip } from '../../utils/snip';\n   3 import Renderer, { RenderOptions } from '../Renderer';\n   4 import { stringify_props } from '../../utils/stringify_props';\n   5 import { get_slot_scope } from './shared/get_slot_scope';\n   6 ...
```
========================================================================================================================
AGENT:
ANALYZE CODE: Understanding the issue

<thinking>
Now I can see the issue clearly. Looking at the code:

1. On line 60, when using spread attributes, the code generates: `{ ${attribute.name}: ${get_attribute_value(attribute)} }` - the attribute name is NOT quoted.

2. On line 69, when not using spread, the code generates: `${attribute.name}: ${get_attribute_value(attribute)}` - the attribute name is also NOT quoted.

3. On lines 45-46, binding props are also not quoted: `${binding.name}: ${snippet}` and `${binding.name}: $$value => ...`

The fix is to use `quote_name_if_necessary` (which is already imported on line 1) to quote the property names when they are not valid JavaScript identifiers.

Let me also check the `quote_name_if_necessary` function to understand how it works:
</thinking>
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- src/compiler/utils/names.ts

========================================================================================================================
TOOL RETURN (open_files)
```
['Successfully opened src/compiler/utils/names.ts:\n\n````typescript\n   0 import { isIdentifierStart, isIdentifierChar } from \'acorn\';\n   1 import full_char_code_at from \'./full_char_code_at\';\n   2 \n   3 export const globals = new Set([\n   4 \t\'alert\',\n   5 \t\'Array\',\n   6 \t\'Boolean\',\n   7 \t\'confirm\',\n   8 \t\'console\',\n   9 \t\'Date\',\n  10 \t\'decodeURI\',\n  11 \t\'decodeURIComponent\',\n  12 \t\'document\',\n  13 \t\'encodeURI\',\n  14 \t\'encodeURIComponent\',\n  1...
```
========================================================================================================================
AGENT:
MODIFY CODE: Fixing the SSR InlineComponent handler

<thinking>
Now I understand the `quote_name_if_necessary` function. It checks if a name is a valid JavaScript identifier, and if not, it wraps it in double quotes.

Looking at the InlineComponent.ts file, I need to fix the following places:
1. Line 45: `binding_props.push(`${binding.name}: ${snippet}`);` - should quote binding.name
2. Line 46: `binding_fns.push(`${binding.name}: $$value => ...`);` - should quote binding.name
3. Line 60: `return `{ ${attribute.name}: ${get_attribute_value(attribute)} }`;` - should quote attribute.name
4. Line 69: `.map(attribute => `${attribute.name}: ${get_attribute_value(attribute)}`)` - should quote attribute.name

The function `quote_name_if_necessary` is already imported, so I just need to use it.

Let me make these changes:
</thinking>
========================================================================================================================
TOOL CALL (find_and_replace_code)
file_path: src/compiler/compile/render_ssr/handlers/InlineComponent.ts
find: "\tnode.bindings.forEach(binding => {\n\t\trenderer.has_bindings = true;\n\n\
  \t\t// TODO this probably won't work for contextual bindings\n\t\tconst snippet\
  \ = snip(binding.expression);\n\n\t\tbinding_props.push(`${binding.name}: ${snippet}`);\n\
  \t\tbinding_fns.push(`${binding.name}: $$value => { ${snippet} = $$value; $$settled\
  \ = false }`);"
replace: "\tnode.bindings.forEach(binding => {\n\t\trenderer.has_bindings = true;\n\
  \n\t\t// TODO this probably won't work for contextual bindings\n\t\tconst snippet\
  \ = snip(binding.expression);\n\n\t\tbinding_props.push(`${quote_name_if_necessary(binding.name)}:\
  \ ${snippet}`);\n\t\tbinding_fns.push(`${quote_name_if_necessary(binding.name)}:\
  \ $$value => { ${snippet} = $$value; $$settled = false }`);"

========================================================================================================================
TOOL RETURN (find_and_replace_code)
```
Successfully replaced code in src/compiler/compile/render_ssr/handlers/InlineComponent.ts:

--- src/compiler/compile/render_ssr/handlers/InlineComponent.ts
+++ src/compiler/compile/render_ssr/handlers/InlineComponent.ts
@@ -43,8 +43,8 @@
 		// TODO this probably won't work for contextual bindings
 		const snippet = snip(binding.expression);
 
-		binding_props.push(`${binding.name}: ${snippet}`);
-		binding_fns.push(`${binding.name}: $$value => { ${snippet} = $$value; $$settled = false }`);
+		bi...
```
========================================================================================================================
TOOL CALL (find_and_replace_code)
file_path: src/compiler/compile/render_ssr/handlers/InlineComponent.ts
find: "\tif (uses_spread) {\n\t\tprops = `@_Object.assign(${\n\t\t\tnode.attributes\n\
  \t\t\t\t.map(attribute => {\n\t\t\t\t\tif (attribute.is_spread) {\n\t\t\t\t\t\t\
  return snip(attribute.expression);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn `{ ${attribute.name}:\
  \ ${get_attribute_value(attribute)} }`;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.concat(binding_props.map(p\
  \ => `{ ${p} }`))\n\t\t\t\t.join(', ')\n\t\t})`;"
replace: "\tif (uses_spread) {\n\t\tprops = `@_Object.assign(${\n\t\t\tnode.attributes\n\
  \t\t\t\t.map(attribute => {\n\t\t\t\t\tif (attribute.is_spread) {\n\t\t\t\t\t\t\
  return snip(attribute.expression);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn `{ ${quote_name_if_necessary(attribute.name)}:\
  \ ${get_attribute_value(attribute)} }`;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.concat(binding_props.map(p\
  \ => `{ ${p} }`))\n\t\t\t\t.join(', ')\n\t\t})`;"

========================================================================================================================
TOOL RETURN (find_and_replace_code)
```
Successfully replaced code in src/compiler/compile/render_ssr/handlers/InlineComponent.ts:

--- src/compiler/compile/render_ssr/handlers/InlineComponent.ts
+++ src/compiler/compile/render_ssr/handlers/InlineComponent.ts
@@ -58,7 +58,7 @@
 					if (attribute.is_spread) {
 						return snip(attribute.expression);
 					} else {
-						return `{ ${attribute.name}: ${get_attribute_value(attribute)} }`;
+						return `{ ${quote_name_if_necessary(attribute.name)}: ${get_attribute_value(attribute)} }`;...
```
========================================================================================================================
TOOL CALL (find_and_replace_code)
file_path: src/compiler/compile/render_ssr/handlers/InlineComponent.ts
find: "\t} else {\n\t\tprops = stringify_props(\n\t\t\tnode.attributes\n\t\t\t\t.map(attribute\
  \ => `${attribute.name}: ${get_attribute_value(attribute)}`)\n\t\t\t\t.concat(binding_props)\n\
  \t\t);\n\t}"
replace: "\t} else {\n\t\tprops = stringify_props(\n\t\t\tnode.attributes\n\t\t\t\t\
  .map(attribute => `${quote_name_if_necessary(attribute.name)}: ${get_attribute_value(attribute)}`)\n\
  \t\t\t\t.concat(binding_props)\n\t\t);\n\t}"

========================================================================================================================
TOOL RETURN (find_and_replace_code)
```
Successfully replaced code in src/compiler/compile/render_ssr/handlers/InlineComponent.ts:

--- src/compiler/compile/render_ssr/handlers/InlineComponent.ts
+++ src/compiler/compile/render_ssr/handlers/InlineComponent.ts
@@ -67,7 +67,7 @@
 	} else {
 		props = stringify_props(
 			node.attributes
-				.map(attribute => `${attribute.name}: ${get_attribute_value(attribute)}`)
+				.map(attribute => `${quote_name_if_necessary(attribute.name)}: ${get_attribute_value(attribute)}`)
 				.concat(binding...
```
========================================================================================================================
AGENT:
VERIFY CHANGES: Review the modified file

<thinking>
Now let me verify the changes by opening the file again to make sure all changes are correct.
</thinking>
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- src/compiler/compile/render_ssr/handlers/InlineComponent.ts

========================================================================================================================
TOOL RETURN (open_files)
```
["Successfully opened src/compiler/compile/render_ssr/handlers/InlineComponent.ts:\n\n````typescript\n   0 import { escape, escape_template, stringify } from '../../utils/stringify';\n   1 import { quote_name_if_necessary } from '../../../utils/names';\n   2 import { snip } from '../../utils/snip';\n   3 import Renderer, { RenderOptions } from '../Renderer';\n   4 import { stringify_props } from '../../utils/stringify_props';\n   5 import { get_slot_scope } from './shared/get_slot_scope';\n   6 ...
```
========================================================================================================================
AGENT:
TESTING: Create a test to verify the fix

<thinking>
The changes look correct. Now let me create a test case to verify that the fix works. I'll create a simple test that uses a component with an illegal property name like `x-y-z`.

First, let me check if there are any existing tests for SSR that I can use as a reference.
</thinking>
========================================================================================================================
TOOL CALL (expand_folder)
folder_path: test/server-side-rendering/samples

========================================================================================================================
TOOL RETURN (expand_folder)
```
test/:

test/server-side-rendering/:

test/server-side-rendering/samples/:

test/server-side-rendering/samples/attribute-boolean/:
_expected.html
main.svelte

test/server-side-rendering/samples/attribute-dynamic/:
_expected.html
data.json
main.svelte

test/server-side-rendering/samples/attribute-escaped-quotes-spread/:
_expected.html
main.svelte

test/server-side-rendering/samples/attribute-escaped-quotes/:
_expected.html
main.svelte

test/server-side-rendering/samples/attribute-static/:
_expect...
```
========================================================================================================================
AGENT:
<thinking>
Let me look at an existing SSR test to understand the structure, then create a new test for the illegal property name issue.
</thinking>
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- test/server-side-rendering/samples/component-data-dynamic/main.svelte
- test/server-side-rendering/samples/component-data-dynamic/Widget.svelte
- test/server-side-rendering/samples/component-data-dynamic/_expected.html

========================================================================================================================
TOOL RETURN (open_files)
```
["Successfully opened test/server-side-rendering/samples/component-data-dynamic/main.svelte:\n\n````\n   0 <script>\n   1 \timport Widget from './Widget.svelte';\n   2 \n   3 \texport let bar;\n   4 \texport let x;\n   5 \texport let compound;\n   6 \texport let go;\n   7 </script>\n   8 \n   9 <div>\n  10 \t<Widget foo='{bar}' baz='{40 + x}' qux='this is a {compound} string' quux='{go.deeper}'/>\n  11 </div>\n  12 \n````", 'Successfully opened test/server-side-rendering/samples/component-data-d...
```
========================================================================================================================
AGENT:
<thinking>
Now I understand the test structure. Let me create a new test case for the illegal property name issue. I'll create a test that uses a component with a property name like `x-y-z`.
</thinking>
========================================================================================================================
TOOL CALL (bash)
command: mkdir -p test/server-side-rendering/samples/component-prop-illegal-name

========================================================================================================================
TOOL RETURN (bash)
```
...
```
========================================================================================================================
TOOL CALL (create_file)
file_path: test/server-side-rendering/samples/component-prop-illegal-name/Widget.svelte
initial_content: "<script>\n\texport let value = $$props['x-y-z'];\n</script>\n\n\
  <p>value: {value}</p>\n"

========================================================================================================================
TOOL RETURN (create_file)
```
Successfully created test/server-side-rendering/samples/component-prop-illegal-name/Widget.svelte....
```
========================================================================================================================
TOOL CALL (create_file)
file_path: test/server-side-rendering/samples/component-prop-illegal-name/main.svelte
initial_content: "<script>\n\timport Widget from './Widget.svelte';\n</script>\n\n\
  <div>\n\t<Widget x-y-z={42}/>\n</div>\n"

========================================================================================================================
TOOL RETURN (create_file)
```
Successfully created test/server-side-rendering/samples/component-prop-illegal-name/main.svelte....
```
========================================================================================================================
TOOL CALL (create_file)
file_path: test/server-side-rendering/samples/component-prop-illegal-name/_expected.html
initial_content: '<div><p>value: 42</p></div>

  '

========================================================================================================================
TOOL RETURN (create_file)
```
Successfully created test/server-side-rendering/samples/component-prop-illegal-name/_expected.html....
```
========================================================================================================================
AGENT:
RUN TESTS: Verify the fix works

<thinking>
Now let me run the tests to verify the fix works. First, I need to install dependencies and then run the SSR tests.
</thinking>
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && npm install 2>&1 | tail -20
timeout: 120

========================================================================================================================
TOOL RETURN (bash)
```
> svelte@3.6.9 tsd
> tsc -p src/compiler --emitDeclarationOnly && tsc -p src/runtime --emitDeclarationOnly


added 461 packages, and audited 462 packages in 41s

50 vulnerabilities (6 low, 11 moderate, 18 high, 15 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues (including breaking changes), run:
  npm audit fix --force

Run `npm audit` for details.
npm notice
npm notice New major version of npm available! 10.9.3 -> 11.6.4
npm notice Changel...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && npm run test -- --grep "component-prop-illegal-name" 2>&1
  | tail -50
timeout: 60

========================================================================================================================
TOOL RETURN (bash)
```
created motion/index.mjs, motion/index.js in 16ms

src/runtime/store/index.ts → store/index.mjs, store/index.js...
created store/index.mjs, store/index.js in 9ms

src/runtime/transition/index.ts → transition/index.mjs, transition/index.js...
created transition/index.mjs, transition/index.js in 10ms

src/compiler/index.ts → compiler.js...
(!) Circular dependency: src/compiler/compile/render_dom/wrappers/Fragment.ts -> src/compiler/compile/render_dom/wrappers/AwaitBlock.ts -> src/compiler/compile/...
```
========================================================================================================================
AGENT:
The test passes. Let me also run a broader set of SSR tests to make sure the fix doesn't break anything else:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && npm run test -- --grep "ssr" 2>&1 | tail -80
timeout: 120

========================================================================================================================
TOOL RETURN (bash)
```
    ✓ transition-js-events-in-out
    ✓ transition-js-if-block-bidi
    ✓ transition-js-if-block-in-each-block-bidi
    ✓ transition-js-if-block-in-each-block-bidi-2
    ✓ transition-js-if-block-in-each-block-bidi-3
    ✓ transition-js-if-block-intro
    ✓ transition-js-if-block-intro-outro
    ✓ transition-js-if-block-outro-timeout
    ✓ transition-js-if-else-block-dynamic-outro
    ✓ transition-js-if-else-block-intro
    ✓ transition-js-if-else-block-outro
    ✓ transition-js-if-elseif-block-o...
```
========================================================================================================================
AGENT:
<thinking>
The SSR tests are passing (628 passing, 9 pending, 1 failing). The one failing test (`spring`) is unrelated to my changes - it's a pre-existing issue with the spring test trying to use `window` which doesn't exist in SSR mode.

Let me also run the full test suite to make sure my changes don't break anything else:
</thinking>
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && npm run test 2>&1 | tail -30
timeout: 180

========================================================================================================================
TOOL RETURN (bash)
```
  2230 passing (5s)
  39 pending
  2 failing

  1) custom-elements
       "before all" hook for "custom-method":
     Error: Failed to launch chrome!
rosetta error: failed to open elf at /lib64/ld-linux-x86-64.so.2
 


TROUBLESHOOTING: https://github.com/GoogleChrome/puppeteer/blob/master/docs/troubleshooting.md

      at onClose (node_modules/puppeteer/lib/Launcher.js:340:14)
      at Interface.<anonymous> (node_modules/puppeteer/lib/Launcher.js:329:50)
      at Interface.emit (node:events:530:...
```
========================================================================================================================
AGENT:
<thinking>
The test results show 2230 passing tests with only 2 failing tests, which are both related to custom-elements tests that require Chrome/Puppeteer (which is not available in this environment). These failures are unrelated to my changes.

Let me also verify that the fix works by looking at the generated SSR code for a component with an illegal property name. Let me create a simple script to test this:
</thinking>
========================================================================================================================
TOOL CALL (bash)
command: "cd /workspace && cat > test_ssr_prop.js << 'EOF'\nconst svelte = require('./compiler.js');\n\
  \nconst code = `\n<script>\n  import Widget from './Widget.svelte';\n</script>\n\
  \n<Widget x-y-z={42}/>\n`;\n\nconst result = svelte.compile(code, {\n  generate:\
  \ 'ssr',\n  format: 'cjs'\n});\n\nconsole.log(\"Generated SSR code:\");\nconsole.log(result.js.code);\n\
  EOF\nnode test_ssr_prop.js"

========================================================================================================================
TOOL RETURN (bash)
```
Generated SSR code:
/* generated by Svelte v3.6.9 */
"use strict";

const { create_ssr_component, validate_component } = require("svelte/internal");
const { default: Widget } = require("./Widget.svelte");

const Component = create_ssr_component(($$result, $$props, $$bindings, $$slots) => {
	return `${validate_component(Widget, 'Widget').$$render($$result, { "x-y-z": 42 }, {}, {})}`;
});

exports.default = Component;...
```
========================================================================================================================
AGENT:
The fix is working correctly. The property name `x-y-z` is now properly quoted as `"x-y-z"` in the generated SSR code.

Let me also test with spread attributes to make sure that case is also fixed:
========================================================================================================================
TOOL CALL (bash)
command: "cd /workspace && cat > test_ssr_prop_spread.js << 'EOF'\nconst svelte =\
  \ require('./compiler.js');\n\nconst code = `\n<script>\n  import Widget from './Widget.svelte';\n\
  \  let props = { a: 1 };\n</script>\n\n<Widget x-y-z={42} {...props}/>\n`;\n\nconst\
  \ result = svelte.compile(code, {\n  generate: 'ssr',\n  format: 'cjs'\n});\n\n\
  console.log(\"Generated SSR code with spread:\");\nconsole.log(result.js.code);\n\
  EOF\nnode test_ssr_prop_spread.js"

========================================================================================================================
TOOL RETURN (bash)
```
Generated SSR code with spread:
/* generated by Svelte v3.6.9 */
"use strict";

const { create_ssr_component, validate_component } = require("svelte/internal");
const { default: Widget } = require("./Widget.svelte");

const Component = create_ssr_component(($$result, $$props, $$bindings, $$slots) => {
	let props = { a: 1 };

	return `${validate_component(Widget, 'Widget').$$render($$result, Object.assign({ "x-y-z": 42 }, props), {}, {})}`;
});

exports.default = Component;...
```
========================================================================================================================
AGENT:
Excellent! The spread case is also working correctly with the property name properly quoted.

Let me clean up the test files:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && rm -f test_ssr_prop.js test_ssr_prop_spread.js

========================================================================================================================
TOOL RETURN (bash)
```
...
```
========================================================================================================================
AGENT:
REVIEW CHANGES: Final verification

<thinking>
Let me review all the changes I made to ensure they are correct and complete:

1. I modified `src/compiler/compile/render_ssr/handlers/InlineComponent.ts` to use `quote_name_if_necessary` for:
   - Binding property names (line 45)
   - Binding function names (line 46)
   - Attribute names in spread case (line 60)
   - Attribute names in non-spread case (line 69)

2. I created a test case in `test/server-side-rendering/samples/component-prop-illegal-name/` with:
   - `main.svelte` - the main component that uses an illegal property name
   - `Widget.svelte` - the child component that receives the prop
   - `_expected.html` - the expected output

The fix is complete and all tests pass. Let me also check if there are any other places in the SSR code that might need similar fixes.
</thinking>
========================================================================================================================
TOOL CALL (grep)
content_pattern: '\.name:'
path_glob: '*/render_ssr/**/*.ts'

========================================================================================================================
TOOL RETURN (grep)
```
No matches found for pattern '\.name:'....
```
========================================================================================================================
TOOL CALL (grep)
content_pattern: attribute\.name
path_glob: '*/render_ssr/**/*.ts'

========================================================================================================================
TOOL RETURN (grep)
```
No matches found for pattern 'attribute\.name'....
```
========================================================================================================================
TOOL CALL (grep)
content_pattern: attribute\.name
path_glob: '**/render_ssr/**/*.ts'

========================================================================================================================
TOOL RETURN (grep)
```
src/compiler/compile/render_ssr/handlers/Element.ts:64:		node.attributes.some((attribute) => attribute.name === 'contenteditable')
src/compiler/compile/render_ssr/handlers/Element.ts:70:		const slot = node.attributes.find((attribute) => attribute.name === 'slot');
src/compiler/compile/render_ssr/handlers/Element.ts:101:				if (attribute.name === 'value' && node.name === 'textarea') {
src/compiler/compile/render_ssr/handlers/Element.ts:104:					args.push(`{ ${quote_name_if_necessary(attribute.nam...
```
========================================================================================================================
AGENT:
<thinking>
Looking at the search results, I can see that `Element.ts` already uses `quote_name_if_necessary` for attribute names in some places (lines 104, 111, 114, 116), but not in others (lines 129, 136, 146). However, those are for HTML element attributes, not component props. HTML element attributes are different - they're rendered as HTML attribute strings like `attribute.name="value"`, not as JavaScript object properties.

Let me verify that the Element.ts file is handling things correctly for HTML elements:
</thinking>
========================================================================================================================
TOOL CALL (inspect_code)
file_path: src/compiler/compile/render_ssr/handlers/Element.ts
line_ranges:
- - 120
  - 150

========================================================================================================================
TOOL RETURN (inspect_code)
```
Successfully expanded code chunks in src/compiler/compile/render_ssr/handlers/Element.ts:

````typescript
   0 import { is_void, quote_prop_if_necessary, quote_name_if_necessary } from '../../../utils/names';
   1 import Attribute from '../../nodes/Attribute';
   2 import Class from '../../nodes/Class';
   3 import { snip } from '../../utils/snip';
   4 import { stringify_attribute } from '../../utils/stringify_attribute';
   5 import { get_slot_scope } from './shared/get_slot_scope';
   6 impor...
```
========================================================================================================================
AGENT:
<thinking>
Looking at the Element.ts file, I can see that:

1. For the spread case (lines 93-120), `quote_name_if_necessary` is already being used for attribute names when building JavaScript objects (lines 103, 110, 113, 115).

2. For the non-spread case (lines 121-148), the attribute names are being used directly in HTML strings like `opening_tag += ` ${attribute.name}`;` (line 128) and `opening_tag += ` ${attribute.name}="${stringify_attribute(attribute, true)}"`;` (line 145). This is correct because these are HTML attribute names, not JavaScript property names, and HTML allows attribute names with hyphens.

So the Element.ts file is handling things correctly - it uses `quote_name_if_necessary` when building JavaScript objects (spread case) and uses the attribute name directly when building HTML strings (non-spread case).

My fix for InlineComponent.ts is complete and correct. Let me verify the final state of the file one more time:
</thinking>
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- src/compiler/compile/render_ssr/handlers/InlineComponent.ts

========================================================================================================================
TOOL RETURN (open_files)
```
["Successfully opened src/compiler/compile/render_ssr/handlers/InlineComponent.ts:\n\n````typescript\n   0 import { escape, escape_template, stringify } from '../../utils/stringify';\n   1 import { quote_name_if_necessary } from '../../../utils/names';\n   2 import { snip } from '../../utils/snip';\n   3 import Renderer, { RenderOptions } from '../Renderer';\n   4 import { stringify_props } from '../../utils/stringify_props';\n   5 import { get_slot_scope } from './shared/get_slot_scope';\n   6 ...
```
========================================================================================================================
AGENT:
Successfully fixed the issue where illegal property names weren't quoted for SSR. 

The problem was in `src/compiler/compile/render_ssr/handlers/InlineComponent.ts` where property names like `x-y-z` were being used directly in JavaScript object literals without proper quoting, resulting in invalid JavaScript code.

Changes made:
1. Modified line 45 to use `quote_name_if_necessary(binding.name)` for binding props
2. Modified line 46 to use `quote_name_if_necessary(binding.name)` for binding functions
3. Modified line 60 to use `quote_name_if_necessary(attribute.name)` for attributes in spread case
4. Modified line 69 to use `quote_name_if_necessary(attribute.name)` for attributes in non-spread case

The `quote_name_if_necessary` function (already imported) checks if a name is a valid JavaScript identifier and wraps it in double quotes if not.

Created a test case in `test/server-side-rendering/samples/component-prop-illegal-name/` to verify the fix.

Before the fix, SSR code would generate:
```js
{ x-y-z: 42 }  // Invalid JavaScript
```

After the fix, SSR code correctly generates:
```js
{ "x-y-z": 42 }  // Valid JavaScript
```

All tests pass (2230 passing, with only 2 unrelated failures due to missing Chrome/Puppeteer in the test environment).
########################################################################################################################
PHASE 1
########################################################################################################################
========================================================================================================================
AGENT:
I will start by viewing the workspace to understand its structure and contents. This will help me identify key files and locations that may be relevant to the task.
========================================================================================================================
USER PROMPT:
Resolve the following problem statement:

<problem_statement>
[Autocomplete] Prevent onInputChange when onChange is fired
<!-- Provide a general summary of the feature in the Title above -->

I'm not really sure whether to classify this as a bug or feature request as I'm not familiar with what's actually intended here.

When `onChange` is fired, `onInputChange` is also fired, even though the user is not actually typing into the search box. Technically, the text input _is_ changing though, so it makes sense from that standpoint that this would happen.

<!--
  Thank you very much for contributing to Material-UI by creating an issue! â¤ï¸
  To avoid duplicate issues we ask you to check off the following list.
-->

<!-- Checked checkbox should look like this: [x] -->

- [x] I have searched the [issues](https://github.com/mui-org/material-ui/issues) of this repository and believe that this is not a duplicate.

## Summary ðŸ’¡

<!-- Describe how it should work. -->

I would argue the `onInputChange` event should not fire when a user selects an option, and instead only fires when they type into the input field themselves.

## Motivation ðŸ”¦

<!--
  What are you trying to accomplish? How has the lack of this feature affected you?
  Providing context helps us come up with a solution that is most useful in the real world.
-->

This is preventing me from tying an external API request to the user typing in the text field for search, as once the user selects an option, an extra API request is made with the full selection label. I don't want to make an extra request on user selection, as the options available to the user should remain the same.

I have also tried storing the selected option in state and checking that the selected option and the input don't match before making my API request. However, both `onChange` and `onInputChange` are executed before the state actually updates in React, so my check is always one state behind.

</problem_statement>

Do not stop until you have made code changes that resolve the problem statement. Do not ask for clarifications.
========================================================================================================================
AGENT:
I'll start by exploring the workspace to understand the structure and find the Autocomplete component that needs to be modified.
========================================================================================================================
AGENT:
Starting to explore the workspace to understand the Autocomplete component and find where onInputChange is called.
========================================================================================================================
TOOL CALL (grep)
content_pattern: Autocomplete
path_glob: '**/material-ui-lab/src/**/*.js'

========================================================================================================================
TOOL RETURN (grep)
```
packages/material-ui-lab/src/useAutocomplete/index.js:1:export { default, createFilterOptions } from './useAutocomplete';
packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js:69:export default function useAutocomplete(props) {
packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js:201:              'Material-UI: the `getOptionLabel` method of useAutocomplete do not handle the options correctly.',
packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js:835:useAutocompl...
```
========================================================================================================================
TOOL CALL (expand_folder)
folder_path: packages/material-ui-lab/src/useAutocomplete

========================================================================================================================
TOOL RETURN (expand_folder)
```
packages/:

packages/material-ui-lab/:

packages/material-ui-lab/src/:

packages/material-ui-lab/src/useAutocomplete/:
index.d.ts
index.js
useAutocomplete.d.ts
useAutocomplete.js...
```
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js

========================================================================================================================
TOOL RETURN (open_files)
```
["Successfully opened packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js:\n\n````javascript\n   0 /* eslint-disable no-constant-condition */\n...\n   7 function stripDiacritics(string) {\n...\n  13 function defaultStringify(value) {\n...\n  31 export function createFilterOptions(config = {}) {\n...\n  63 const defaultFilterOptions = createFilterOptions();\n...\n  68 export default function useAutocomplete(props) {\n...\n 119   function setHighlightedIndex(index, mouse = false) {\n.....
```
========================================================================================================================
TOOL CALL (inspect_code)
file_path: packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js
patterns:
- onInputChange

========================================================================================================================
TOOL RETURN (inspect_code)
```
Successfully expanded code chunks in packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js:

````javascript
   0 /* eslint-disable no-constant-condition */
...
   7 function stripDiacritics(string) {
...
  13 function defaultStringify(value) {
...
  31 export function createFilterOptions(config = {}) {
...
  63 const defaultFilterOptions = createFilterOptions();
...
  68 export default function useAutocomplete(props) {
  69   const {
  70     autoComplete = false,
  71     autoHighligh...
```
========================================================================================================================
AGENT:
Now I have a good understanding of the code. Let me look at the `onInputChange` prop type definition to understand what parameters it currently accepts:
========================================================================================================================
TOOL CALL (inspect_code)
file_path: packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js
line_ranges:
- - 834
  - 970

========================================================================================================================
TOOL RETURN (inspect_code)
```
Successfully expanded code chunks in packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js:

````javascript
   0 /* eslint-disable no-constant-condition */
...
   7 function stripDiacritics(string) {
...
  13 function defaultStringify(value) {
...
  31 export function createFilterOptions(config = {}) {
...
  63 const defaultFilterOptions = createFilterOptions();
...
  68 export default function useAutocomplete(props) {
  69   const {
  70     autoComplete = false,
  71     autoHighligh...
```
========================================================================================================================
AGENT:
Now I have a clear understanding of the code. Let me also check the TypeScript definition file to understand the current signature of `onInputChange`:
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- packages/material-ui-lab/src/useAutocomplete/useAutocomplete.d.ts

========================================================================================================================
TOOL RETURN (open_files)
```
["Successfully opened packages/material-ui-lab/src/useAutocomplete/useAutocomplete.d.ts:\n\n````typescript\n   0 import * as React from 'react';\n   1 \n   2 export interface CreateFilterOptionsConfig {\n   3   ignoreAccents?: boolean;\n   4   ignoreCase?: boolean;\n   5   matchFrom?: 'any' | 'start';\n   6   stringify?: (option: any) => string;\n   7   trim?: boolean;\n   8 }\n   9 \n  10 export interface FilterOptionsState {\n  11   inputValue: string;\n  12 }\n  13 \n  14 export type CreateFi...
```
========================================================================================================================
AGENT:
Now let me also check the Autocomplete component to see if there's a separate definition for `onInputChange`:
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- packages/material-ui-lab/src/Autocomplete/Autocomplete.d.ts

========================================================================================================================
TOOL RETURN (open_files)
```
["Successfully opened packages/material-ui-lab/src/Autocomplete/Autocomplete.d.ts:\n\n````typescript\n   0 import * as React from 'react';\n   1 import { StandardProps } from '@material-ui/core';\n   2 import { UseAutocompleteProps, CreateFilterOptions, createFilterOptions } from '../useAutocomplete';\n   3 \n   4 export { createFilterOptions };\n   5 \n   6 export interface PopperProps extends React.HTMLAttributes<HTMLElement> {\n   7   anchorEl?: HTMLElement;\n   8   open: boolean;\n   9   pop...
```
========================================================================================================================
AGENT:
Now let me look at the test file to understand how the component is tested and what behavior is expected:
========================================================================================================================
TOOL CALL (grep)
content_pattern: onInputChange
path_glob: '**/Autocomplete.test.js'

========================================================================================================================
TOOL RETURN (grep)
```
packages/material-ui-lab/src/Autocomplete/Autocomplete.test.js:676:            onInputChange={handleInputChange}...
```
========================================================================================================================
TOOL CALL (inspect_code)
file_path: packages/material-ui-lab/src/Autocomplete/Autocomplete.test.js
line_ranges:
- - 660
  - 730

========================================================================================================================
TOOL RETURN (inspect_code)
```
Successfully expanded code chunks in packages/material-ui-lab/src/Autocomplete/Autocomplete.test.js:

````javascript
   0 import React from 'react';
   1 import { expect } from 'chai';
   2 import { createMount, getClasses } from '@material-ui/core/test-utils';
   3 import describeConformance from '@material-ui/core/test-utils/describeConformance';
   4 import consoleErrorMock from 'test/utils/consoleErrorMock';
   5 import { spy } from 'sinon';
   6 import { createClientRender, fireEvent } from...
```
========================================================================================================================
AGENT:
Now I have a clear understanding of the issue. The problem is that when a user selects an option (via `onChange`), the `onInputChange` callback is also fired because the input value changes to reflect the selected option's label. This is problematic for users who want to make API requests only when the user types, not when they select an option.

The solution is to add a third parameter to `onInputChange` that indicates the reason for the change. This way, users can distinguish between:
1. User typing in the input (`'input'`)
2. Value being reset due to option selection or blur (`'reset'`)
3. Input being cleared (`'clear'`)

Let me implement this solution:
========================================================================================================================
AGENT:
I've analyzed the code and understand the issue. The solution is to add a "reason" parameter to the onInputChange callback so users can distinguish between user typing and programmatic changes (like option selection). I'll now implement the changes.
========================================================================================================================
TOOL CALL (find_and_replace_code)
file_path: packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js
find: "  const resetInputValue = useEventCallback((event, newValue) => {\n    let\
  \ newInputValue;\n    if (multiple) {\n      newInputValue = '';\n    } else if\
  \ (newValue == null) {\n      newInputValue = '';\n    } else {\n      const optionLabel\
  \ = getOptionLabel(newValue);\n\n      if (process.env.NODE_ENV !== 'production')\
  \ {\n        if (typeof optionLabel !== 'string') {\n          console.error(\n\
  \            [\n              'Material-UI: the `getOptionLabel` method of useAutocomplete\
  \ do not handle the options correctly.',\n              `The component expect a\
  \ string but received ${typeof optionLabel}.`,\n              `For the input option:\
  \ ${JSON.stringify(\n                newValue,\n              )}, \\`getOptionLabel\\\
  ` returns: ${newInputValue}.`,\n            ].join('\\n'),\n          );\n     \
  \   }\n      }\n\n      newInputValue = typeof optionLabel === 'string' ? optionLabel\
  \ : '';\n    }\n\n    if (inputValue === newInputValue) {\n      return;\n    }\n\
  \n    setInputValue(newInputValue);\n\n    if (onInputChange) {\n      onInputChange(event,\
  \ newInputValue);\n    }\n  });"
replace: "  const resetInputValue = useEventCallback((event, newValue) => {\n    let\
  \ newInputValue;\n    if (multiple) {\n      newInputValue = '';\n    } else if\
  \ (newValue == null) {\n      newInputValue = '';\n    } else {\n      const optionLabel\
  \ = getOptionLabel(newValue);\n\n      if (process.env.NODE_ENV !== 'production')\
  \ {\n        if (typeof optionLabel !== 'string') {\n          console.error(\n\
  \            [\n              'Material-UI: the `getOptionLabel` method of useAutocomplete\
  \ do not handle the options correctly.',\n              `The component expect a\
  \ string but received ${typeof optionLabel}.`,\n              `For the input option:\
  \ ${JSON.stringify(\n                newValue,\n              )}, \\`getOptionLabel\\\
  ` returns: ${newInputValue}.`,\n            ].join('\\n'),\n          );\n     \
  \   }\n      }\n\n      newInputValue = typeof optionLabel === 'string' ? optionLabel\
  \ : '';\n    }\n\n    if (inputValue === newInputValue) {\n      return;\n    }\n\
  \n    setInputValue(newInputValue);\n\n    if (onInputChange) {\n      onInputChange(event,\
  \ newInputValue, 'reset');\n    }\n  });"

========================================================================================================================
TOOL RETURN (find_and_replace_code)
```
Successfully replaced code in packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js:

--- packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js
+++ packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js
@@ -218,7 +218,7 @@
     setInputValue(newInputValue);
 
     if (onInputChange) {
-      onInputChange(event, newInputValue);
+      onInputChange(event, newInputValue, 'reset');
     }
   });
 
...
```
========================================================================================================================
AGENT:
Now let me update the `handleClear` function to pass the 'clear' reason:
========================================================================================================================
TOOL CALL (find_and_replace_code)
file_path: packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js
find: "  const handleClear = event => {\n    handleValue(event, multiple ? [] : null);\n\
  \    if (disableOpenOnFocus) {\n      handleClose();\n    }\n    setInputValue('');\n\
  \  };"
replace: "  const handleClear = event => {\n    handleValue(event, multiple ? [] :\
  \ null);\n    if (disableOpenOnFocus) {\n      handleClose();\n    }\n    setInputValue('');\n\
  \    if (onInputChange) {\n      onInputChange(event, '', 'clear');\n    }\n  };"

========================================================================================================================
TOOL RETURN (find_and_replace_code)
```
Successfully replaced code in packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js:

--- packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js
+++ packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js
@@ -513,6 +513,9 @@
       handleClose();
     }
     setInputValue('');
+    if (onInputChange) {
+      onInputChange(event, '', 'clear');
+    }
   };
 
   const handleKeyDown = event => {
...
```
========================================================================================================================
AGENT:
Now let me update the `handleInputChange` function to pass the 'input' reason:
========================================================================================================================
TOOL CALL (find_and_replace_code)
file_path: packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js
find: "  const handleInputChange = event => {\n    const newValue = event.target.value;\n\
  \n    if (newValue === '') {\n      if (disableOpenOnFocus) {\n        handleClose(event);\n\
  \      }\n\n      if (!disableClearable && !multiple) {\n        handleValue(event,\
  \ null);\n      }\n    } else {\n      handleOpen(event);\n    }\n\n    if (inputValue\
  \ === newValue) {\n      return;\n    }\n\n    setInputValue(newValue);\n\n    if\
  \ (onInputChange) {\n      onInputChange(event, newValue);\n    }\n  };"
replace: "  const handleInputChange = event => {\n    const newValue = event.target.value;\n\
  \n    if (newValue === '') {\n      if (disableOpenOnFocus) {\n        handleClose(event);\n\
  \      }\n\n      if (!disableClearable && !multiple) {\n        handleValue(event,\
  \ null);\n      }\n    } else {\n      handleOpen(event);\n    }\n\n    if (inputValue\
  \ === newValue) {\n      return;\n    }\n\n    setInputValue(newValue);\n\n    if\
  \ (onInputChange) {\n      onInputChange(event, newValue, 'input');\n    }\n  };"

========================================================================================================================
TOOL RETURN (find_and_replace_code)
```
Successfully replaced code in packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js:

--- packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js
+++ packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js
@@ -660,7 +660,7 @@
     setInputValue(newValue);
 
     if (onInputChange) {
-      onInputChange(event, newValue);
+      onInputChange(event, newValue, 'input');
     }
   };
 
...
```
========================================================================================================================
AGENT:
Now I need to update the PropTypes to document the new `reason` parameter. Let me first check if there's a PropType for `onInputChange`:
========================================================================================================================
TOOL CALL (grep)
content_pattern: onInputChange.*PropTypes
path_glob: '**/useAutocomplete.js'

========================================================================================================================
TOOL RETURN (grep)
```
No matches found for pattern 'onInputChange.*PropTypes'....
```
========================================================================================================================
AGENT:
I see that `onInputChange` is not in the PropTypes for `useAutocomplete`. Let me check the Autocomplete component's PropTypes:
========================================================================================================================
TOOL CALL (grep)
content_pattern: onInputChange
path_glob: '**/Autocomplete.js'

========================================================================================================================
TOOL RETURN (grep)
```
packages/material-ui-lab/src/Autocomplete/Autocomplete.js:251:    onInputChange,
packages/material-ui-lab/src/Autocomplete/Autocomplete.js:627:  onInputChange: PropTypes.func,...
```
========================================================================================================================
TOOL CALL (inspect_code)
file_path: packages/material-ui-lab/src/Autocomplete/Autocomplete.js
line_ranges:
- - 620
  - 640

========================================================================================================================
TOOL RETURN (inspect_code)
```
Successfully expanded code chunks in packages/material-ui-lab/src/Autocomplete/Autocomplete.js:

````javascript
   0 import React from 'react';
   1 import PropTypes from 'prop-types';
   2 import clsx from 'clsx';
   3 import { withStyles } from '@material-ui/core/styles';
   4 import Popper from '@material-ui/core/Popper';
   5 import ListSubheader from '@material-ui/core/ListSubheader';
   6 import Paper from '@material-ui/core/Paper';
   7 import IconButton from '@material-ui/core/IconButton...
```
========================================================================================================================
AGENT:
Now let me update the PropTypes documentation for `onInputChange` in the Autocomplete component:
========================================================================================================================
TOOL CALL (find_and_replace_code)
file_path: packages/material-ui-lab/src/Autocomplete/Autocomplete.js
find: "  /**\n   * Callback fired when the input value changes.\n   *\n   * @param\
  \ {object} event The event source of the callback.\n   * @param {string} value\n\
  \   */\n  onInputChange: PropTypes.func,"
replace: "  /**\n   * Callback fired when the input value changes.\n   *\n   * @param\
  \ {object} event The event source of the callback.\n   * @param {string} value The\
  \ new value of the text input.\n   * @param {string} reason Can be: `\"input\"`\
  \ (user input), `\"reset\"` (programmatic change), `\"clear\"`.\n   */\n  onInputChange:\
  \ PropTypes.func,"

========================================================================================================================
TOOL RETURN (find_and_replace_code)
```
Successfully replaced code in packages/material-ui-lab/src/Autocomplete/Autocomplete.js:

--- packages/material-ui-lab/src/Autocomplete/Autocomplete.js
+++ packages/material-ui-lab/src/Autocomplete/Autocomplete.js
@@ -622,7 +622,8 @@
    * Callback fired when the input value changes.
    *
    * @param {object} event The event source of the callback.
-   * @param {string} value
+   * @param {string} value The new value of the text input.
+   * @param {string} reason Can be: `"input"` (user input...
```
========================================================================================================================
AGENT:
Now let me update the TypeScript definition file for `useAutocomplete`:
========================================================================================================================
TOOL CALL (find_and_replace_code)
file_path: packages/material-ui-lab/src/useAutocomplete/useAutocomplete.d.ts
find: "  /**\n   * Callback fired when the input value changes.\n   *\n   * @param\
  \ {object} event The event source of the callback.\n   * @param {string} value\n\
  \   */\n  onInputChange?: (event: React.ChangeEvent<{}>, value: any) => void;"
replace: "  /**\n   * Callback fired when the input value changes.\n   *\n   * @param\
  \ {object} event The event source of the callback.\n   * @param {string} value The\
  \ new value of the text input.\n   * @param {string} reason Can be: `\"input\"`\
  \ (user input), `\"reset\"` (programmatic change), `\"clear\"`.\n   */\n  onInputChange?:\
  \ (event: React.ChangeEvent<{}>, value: string, reason: 'input' | 'reset' | 'clear')\
  \ => void;"

========================================================================================================================
TOOL RETURN (find_and_replace_code)
```
Successfully replaced code in packages/material-ui-lab/src/useAutocomplete/useAutocomplete.d.ts:

--- packages/material-ui-lab/src/useAutocomplete/useAutocomplete.d.ts
+++ packages/material-ui-lab/src/useAutocomplete/useAutocomplete.d.ts
@@ -138,9 +138,10 @@
    * Callback fired when the input value changes.
    *
    * @param {object} event The event source of the callback.
-   * @param {string} value
+   * @param {string} value The new value of the text input.
+   * @param {string} reason Can ...
```
========================================================================================================================
AGENT:
Now let me add tests to verify the new functionality. First, let me look at the existing test structure:
========================================================================================================================
TOOL CALL (inspect_code)
file_path: packages/material-ui-lab/src/Autocomplete/Autocomplete.test.js
line_ranges:
- - 0
  - 30
- - 663
  - 690

========================================================================================================================
TOOL RETURN (inspect_code)
```
Successfully expanded code chunks in packages/material-ui-lab/src/Autocomplete/Autocomplete.test.js:

````javascript
   0 import React from 'react';
   1 import { expect } from 'chai';
   2 import { createMount, getClasses } from '@material-ui/core/test-utils';
   3 import describeConformance from '@material-ui/core/test-utils/describeConformance';
   4 import consoleErrorMock from 'test/utils/consoleErrorMock';
   5 import { spy } from 'sinon';
   6 import { createClientRender, fireEvent } from...
```
========================================================================================================================
AGENT:
Now let me add tests for the new `reason` parameter. I'll add them to the "controlled input" section:
========================================================================================================================
TOOL CALL (find_and_replace_code)
file_path: packages/material-ui-lab/src/Autocomplete/Autocomplete.test.js
find: "  describe('controlled input', () => {\n    it('controls the input value',\
  \ () => {\n      const handleChange = spy();\n      function MyComponent() {\n \
  \       const [, setInputValue] = React.useState('');\n        const handleInputChange\
  \ = (event, value) => {\n          handleChange(value);\n          setInputValue(value);\n\
  \        };\n        return (\n          <Autocomplete\n            inputValue=\"\
  \"\n            onInputChange={handleInputChange}\n            renderInput={params\
  \ => <TextField {...params} autoFocus />}\n          />\n        );\n      }\n\n\
  \      render(<MyComponent />);\n\n      expect(handleChange.callCount).to.equal(0);\n\
  \      fireEvent.change(document.activeElement, { target: { value: 'a' } });\n \
  \     expect(handleChange.callCount).to.equal(1);\n      expect(handleChange.args[0][0]).to.equal('a');\n\
  \      expect(document.activeElement.value).to.equal('');\n    });\n  });"
replace: "  describe('controlled input', () => {\n    it('controls the input value',\
  \ () => {\n      const handleChange = spy();\n      function MyComponent() {\n \
  \       const [, setInputValue] = React.useState('');\n        const handleInputChange\
  \ = (event, value) => {\n          handleChange(value);\n          setInputValue(value);\n\
  \        };\n        return (\n          <Autocomplete\n            inputValue=\"\
  \"\n            onInputChange={handleInputChange}\n            renderInput={params\
  \ => <TextField {...params} autoFocus />}\n          />\n        );\n      }\n\n\
  \      render(<MyComponent />);\n\n      expect(handleChange.callCount).to.equal(0);\n\
  \      fireEvent.change(document.activeElement, { target: { value: 'a' } });\n \
  \     expect(handleChange.callCount).to.equal(1);\n      expect(handleChange.args[0][0]).to.equal('a');\n\
  \      expect(document.activeElement.value).to.equal('');\n    });\n  });\n\n  describe('prop:\
  \ onInputChange', () => {\n    it('provides a reason on input change', () => {\n\
  \      const handleInputChange = spy();\n      const options = ['one', 'two'];\n\
  \      render(\n        <Autocomplete\n          onInputChange={handleInputChange}\n\
  \          options={options}\n          renderInput={params => <TextField {...params}\
  \ autoFocus />}\n        />,\n      );\n      fireEvent.change(document.activeElement,\
  \ { target: { value: 'a' } });\n      expect(handleInputChange.callCount).to.equal(1);\n\
  \      expect(handleInputChange.args[0][1]).to.equal('a');\n      expect(handleInputChange.args[0][2]).to.equal('input');\n\
  \    });\n\n    it('provides a reason on select reset', () => {\n      const handleInputChange\
  \ = spy();\n      const options = ['one', 'two'];\n      render(\n        <Autocomplete\n\
  \          onInputChange={handleInputChange}\n          options={options}\n    \
  \      renderInput={params => <TextField {...params} autoFocus />}\n        />,\n\
  \      );\n      fireEvent.keyDown(document.activeElement, { key: 'ArrowDown' });\n\
  \      fireEvent.keyDown(document.activeElement, { key: 'Enter' });\n      expect(handleInputChange.callCount).to.equal(1);\n\
  \      expect(handleInputChange.args[0][1]).to.equal('one');\n      expect(handleInputChange.args[0][2]).to.equal('reset');\n\
  \    });\n\n    it('provides a reason on clear', () => {\n      const handleInputChange\
  \ = spy();\n      const options = ['one', 'two'];\n      const { container } = render(\n\
  \        <Autocomplete\n          onInputChange={handleInputChange}\n          options={options}\n\
  \          defaultValue=\"one\"\n          renderInput={params => <TextField {...params}\
  \ autoFocus />}\n        />,\n      );\n      const button = container.querySelector('button');\n\
  \      fireEvent.click(button);\n      expect(handleInputChange.callCount).to.equal(1);\n\
  \      expect(handleInputChange.args[0][1]).to.equal('');\n      expect(handleInputChange.args[0][2]).to.equal('clear');\n\
  \    });\n  });"

========================================================================================================================
TOOL RETURN (find_and_replace_code)
```
Successfully replaced code in packages/material-ui-lab/src/Autocomplete/Autocomplete.test.js:

--- packages/material-ui-lab/src/Autocomplete/Autocomplete.test.js
+++ packages/material-ui-lab/src/Autocomplete/Autocomplete.test.js
@@ -686,6 +686,59 @@
       expect(handleChange.callCount).to.equal(1);
       expect(handleChange.args[0][0]).to.equal('a');
       expect(document.activeElement.value).to.equal('');
+    });
+  });
+
+  describe('prop: onInputChange', () => {
+    it('provides a reason...
```
========================================================================================================================
AGENT:
Now let me run the tests to verify that the changes work correctly:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && yarn install 2>&1 | tail -20
timeout: 120

========================================================================================================================
TOOL RETURN (bash)
```
âž¤ YN0087: Migrated your project to the latest Yarn version ðŸš€

âž¤ YN0000: Â· Yarn 4.9.3
âž¤ YN0000: â”Œ Project validation
âž¤ YN0057: â”‚ root-workspace-0b6124: The override for '**/@babel/core' includes a glob pattern. Glob patterns have been removed since their behaviours don't match what you'd expect. Set the override to '@babel/core' instead.
âž¤ YN0057: â”‚ root-workspace-0b6124: The override for '**/@babel/plugin-proposal-class-properties' includes a glob pattern. Glob patterns have been removed since t...
```
========================================================================================================================
AGENT:
Let me try a different approach to install dependencies:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && npm install 2>&1 | tail -30
timeout: 180

========================================================================================================================
TOOL RETURN (bash)
```
npm warn deprecated sinon@7.5.0: 16.1.1
npm warn deprecated eslint@5.16.0: This version is no longer supported. Please see https://eslint.org/version-support for other options.
npm warn deprecated core-js@1.2.7: core-js@<3.23.3 is no longer maintained and not recommended for usage due to the number of issues. Because of the V8 engine whims, feature detection in old core-js versions could cause a slowdown up to 100x even if nothing is polyfilled. Some versions have web compatibility issues. Pleas...
```
========================================================================================================================
AGENT:
Now let me run the tests for the Autocomplete component:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && npm run test:unit -- --grep "Autocomplete" --grep "onInputChange"
  2>&1 | tail -50
timeout: 120

========================================================================================================================
TOOL RETURN (bash)
```
                                                        [string] [default: 2000]
  --ui, -u                   Specify user interface    [string] [default: "bdd"]

Reporting & Output
  --color, -c, --colors                     Force-enable color output  [boolean]
  --diff                                    Show diff on failure
                                                       [boolean] [default: true]
  --full-trace                              Display full stack traces  [boolean]
  --growl,...
```
========================================================================================================================
AGENT:
Let me try running the tests differently:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && npx mocha packages/material-ui-lab/src/Autocomplete/Autocomplete.test.js
  --require @babel/register --require test/utils/setup.js 2>&1 | tail -100
timeout: 120

========================================================================================================================
TOOL RETURN (bash)
```
Browserslist: caniuse-lite is outdated. Please run next command `yarn upgrade`
mocha debug [spec..]

Run tests with Mocha

Rules & Behavior
  --allow-uncaught           Allow uncaught errors to propagate        [boolean]
  --async-only, -A           Require all tests to use a callback (async) or
                             return a Promise                          [boolean]
  --bail, -b                 Abort ("bail") after first test failure   [boolean]
  --check-leaks              Check for gl...
```
========================================================================================================================
AGENT:
Let me check the package.json to see how tests are run:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && cat package.json | grep -A 20 '"scripts"'
timeout: 30

========================================================================================================================
TOOL RETURN (bash)
```
  "scripts": {
    "proptypes": "ts-node --skip-project ./scripts/generateProptypes.ts",
    "deduplicate": "node scripts/deduplicate.js",
    "argos": "argos upload test/regressions/screenshots/chrome --token $ARGOS_TOKEN",
    "build:codesandbox": "lerna run --parallel --scope \"@material-ui/*\" build",
    "docs:api": "rimraf ./docs/pages/api && cross-env BABEL_ENV=test babel-node ./docs/scripts/buildApi.js ./packages/material-ui/src ./docs/pages/api && cross-env BABEL_ENV=test babel-node ./d...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && cat package.json | grep -A 50 '"scripts"' | grep test
timeout: 30

========================================================================================================================
TOOL RETURN (bash)
```
    "argos": "argos upload test/regressions/screenshots/chrome --token $ARGOS_TOKEN",
    "docs:api": "rimraf ./docs/pages/api && cross-env BABEL_ENV=test babel-node ./docs/scripts/buildApi.js ./packages/material-ui/src ./docs/pages/api && cross-env BABEL_ENV=test babel-node ./docs/scripts/buildApi.js ./packages/material-ui-lab/src ./docs/pages/api",
    "docs:i18n": "cross-env BABEL_ENV=test babel-node ./docs/scripts/i18n.js",
    "test": "yarn lint && yarn typescript && yarn test:coverage",
  ...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && cross-env NODE_ENV=test mocha 'packages/material-ui-lab/src/Autocomplete/Autocomplete.test.js'
  --exclude '**/node_modules/**' 2>&1 | tail -100
timeout: 120

========================================================================================================================
TOOL RETURN (bash)
```
tmp_code_84f070353fd87df3e7b6624e6b9c7a20a2823c807e5748f6f6ada07a7ef6fdac.bash: line 1: cross-env: command not found...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && NODE_ENV=test npx mocha 'packages/material-ui-lab/src/Autocomplete/Autocomplete.test.js'
  --exclude '**/node_modules/**' 2>&1 | tail -100
timeout: 120

========================================================================================================================
TOOL RETURN (bash)
```
Browserslist: caniuse-lite is outdated. Please run next command `yarn upgrade`
mocha debug [spec..]

Run tests with Mocha

Rules & Behavior
  --allow-uncaught           Allow uncaught errors to propagate        [boolean]
  --async-only, -A           Require all tests to use a callback (async) or
                             return a Promise                          [boolean]
  --bail, -b                 Abort ("bail") after first test failure   [boolean]
  --check-leaks              Check for gl...
```
========================================================================================================================
AGENT:
Let me check the mocha.opts file:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && cat test/mocha.opts
timeout: 30

========================================================================================================================
TOOL RETURN (bash)
```
--require @babel/register
--reporter dot
--recursive
--require test/utils/setup.js...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && cat test/utils/setup.js
timeout: 30

========================================================================================================================
TOOL RETURN (bash)
```
const createDOM = require('./createDOM');

process.browser = true;

createDOM();
require('./init');...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && cat test/utils/createDOM.js
timeout: 30

========================================================================================================================
TOOL RETURN (bash)
```
const { JSDOM } = require('jsdom');
const Node = require('jsdom/lib/jsdom/living/node-document-position');

// We can use jsdom-global at some point if maintaining these lists is a burden.
const whitelist = [
  // required for fake getComputedStyle
  'CSSStyleDeclaration',
  'Element',
  'Image',
  'HTMLElement',
  'HTMLInputElement',
  'Performance',
];
const blacklist = ['sessionStorage', 'localStorage'];

function createDOM() {
  const dom = new JSDOM('', { pretendToBeVisual: true });
  globa...
```
========================================================================================================================
AGENT:
I see the issue - the test setup is trying to set `global.navigator` but it's already defined. Let me try running the tests with a different approach:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && node --version
timeout: 30

========================================================================================================================
TOOL RETURN (bash)
```
v22.18.0...
```
========================================================================================================================
AGENT:
The issue is likely with the Node.js version. Let me try using a different Node version:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && nvm use 18 && node --version
timeout: 30

========================================================================================================================
TOOL RETURN (bash)
```
Now using node v18.20.8 (npm v10.8.2)
v18.20.8...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && NODE_ENV=test npx mocha 'packages/material-ui-lab/src/Autocomplete/Autocomplete.test.js'
  --exclude '**/node_modules/**' 2>&1 | tail -100
timeout: 120

========================================================================================================================
TOOL RETURN (bash)
```
Browserslist: caniuse-lite is outdated. Please run next command `yarn upgrade`
mocha debug [spec..]

Run tests with Mocha

Rules & Behavior
  --allow-uncaught           Allow uncaught errors to propagate        [boolean]
  --async-only, -A           Require all tests to use a callback (async) or
                             return a Promise                          [boolean]
  --bail, -b                 Abort ("bail") after first test failure   [boolean]
  --check-leaks              Check for gl...
```
========================================================================================================================
AGENT:
The issue is with the test setup. Let me modify the createDOM.js file to fix the navigator issue:
========================================================================================================================
TOOL CALL (find_and_replace_code)
file_path: test/utils/createDOM.js
find: "  global.navigator = {\n    userAgent: 'node.js',\n  };"
replace: "  Object.defineProperty(global, 'navigator', {\n    value: {\n      userAgent:\
  \ 'node.js',\n    },\n    writable: true,\n    configurable: true,\n  });"

========================================================================================================================
TOOL RETURN (find_and_replace_code)
```
Successfully replaced code in test/utils/createDOM.js:

--- test/utils/createDOM.js
+++ test/utils/createDOM.js
@@ -55,9 +55,13 @@
   }
   global.window.Touch = Touch;
 
-  global.navigator = {
-    userAgent: 'node.js',
-  };
+  Object.defineProperty(global, 'navigator', {
+    value: {
+      userAgent: 'node.js',
+    },
+    writable: true,
+    configurable: true,
+  });
 
   Object.keys(dom.window)
     .filter(key => !blacklist.includes(key))
...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && NODE_ENV=test npx mocha 'packages/material-ui-lab/src/Autocomplete/Autocomplete.test.js'
  --exclude '**/node_modules/**' 2>&1 | tail -100
timeout: 120

========================================================================================================================
TOOL RETURN (bash)
```

 Timeout...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && NODE_ENV=test npx mocha 'packages/material-ui-lab/src/Autocomplete/Autocomplete.test.js'
  --exclude '**/node_modules/**' --timeout 60000 2>&1
timeout: 180

========================================================================================================================
TOOL RETURN (bash)
```
Browserslist: caniuse-lite is outdated. Please run next command `yarn upgrade`
including inaccessible elements by default


  â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤!â€¤â€¤

  44 passing (1s)
  1 failing

  1) <Autocomplete />
       prop: onInputChange
         provides a reason on clear:

      AssertionError: expected 2 to equal 1
      + expected - actual

      -2
      +1
      
      at Context.<anonymous> (packages/material-ui-lab/src/Autocomplete/Autocomplete.test.js:739:46)
      at pro...
```
========================================================================================================================
AGENT:
The tests are running! One test is failing. Let me investigate the issue with the "provides a reason on clear" test. The issue is that `onInputChange` is being called twice. Let me check the code flow:
========================================================================================================================
TOOL CALL (inspect_code)
file_path: packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js
patterns:
- handleClear
- resetInputValue

========================================================================================================================
TOOL RETURN (inspect_code)
```
Successfully expanded code chunks in packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js:

````javascript
   0 /* eslint-disable no-constant-condition */
...
   7 function stripDiacritics(string) {
...
  13 function defaultStringify(value) {
...
  31 export function createFilterOptions(config = {}) {
...
  63 const defaultFilterOptions = createFilterOptions();
...
  68 export default function useAutocomplete(props) {
  69   const {
  70     autoComplete = false,
  71     autoHighligh...
```
========================================================================================================================
AGENT:
I see the issue now. When `handleClear` is called, it:
1. Calls `handleValue(event, multiple ? [] : null)` which triggers `setValue(null)`
2. This triggers the `useEffect` at line 224-226 which calls `resetInputValue(null, value)` 
3. `resetInputValue` then calls `onInputChange(event, newInputValue, 'reset')`
4. Then `handleClear` also calls `onInputChange(event, '', 'clear')`

So `onInputChange` is being called twice - once with 'reset' and once with 'clear'. The issue is that when clearing, the `resetInputValue` is also being triggered via the `useEffect` because the value changes.

The solution is to not call `onInputChange` in `handleClear` since `resetInputValue` will be called via the `useEffect` when the value changes. However, we want to distinguish between a clear action and a reset action. Let me think about this more carefully.

Actually, looking at the flow:
1. `handleClear` calls `handleValue(event, null)` which sets value to null
2. The `useEffect` at line 224-226 runs because `value` changed, calling `resetInputValue(null, value)` 
3. `resetInputValue` sees that `newValue` is null, so `newInputValue = ''`
4. Since `inputValue` was 'one' and `newInputValue` is '', it calls `onInputChange(event, '', 'reset')`
5. Then `handleClear` continues and calls `setInputValue('')` and `onInputChange(event, '', 'clear')`

The problem is that both the effect and the direct call are happening. We need to prevent the double call. The best approach is to not call `onInputChange` directly in `handleClear`, but instead pass a flag or use a different mechanism.

Actually, looking more carefully at the code, I think the issue is that `handleClear` is setting `inputValue` to '' directly AND calling `onInputChange`, but the `useEffect` is also calling `resetInputValue` which also sets `inputValue` and calls `onInputChange`.

Let me trace through more carefully:
1. `handleClear` is called
2. `handleValue(event, null)` is called - this sets `value` to `null` (via `setValue(null)`)
3. `setInputValue('')` is called - this sets `inputValue` to ''
4. `onInputChange(event, '', 'clear')` is called
5. React re-renders
6. The `useEffect` at line 224-226 runs because `value` changed
7. `resetInputValue(null, null)` is called (value is now null)
8. `newInputValue = ''` (since newValue is null)
9. `inputValue === newInputValue` is true (both are ''), so it returns early without calling `onInputChange`

Wait, that should work correctly. Let me check if the issue is with the order of operations. The `useEffect` might be running before the `setInputValue('')` takes effect.

Actually, looking at the test again:

```javascript
it('provides a reason on clear', () => {
  const handleInputChange = spy();
  const options = ['one', 'two'];
  const { container } = render(
    <Autocomplete
      onInputChange={handleInputChange}
      options={options}
      defaultValue="one"
      renderInput={params => <TextField {...params} autoFocus />}
    />,
  );
  const button = container.querySelector('button');
  fireEvent.click(button);
  expect(handleInputChange.callCount).to.equal(1);
  expect(handleInputChange.args[0][1]).to.equal('');
  expect(handleInputChange.args[0][2]).to.equal('clear');
});
```

The test expects `handleInputChange` to be called exactly once with reason 'clear'. But it's being called twice.

The issue is that when the component first renders with `defaultValue="one"`, the `useEffect` at line 224-226 runs and calls `resetInputValue(null, value)` which sets the input value to 'one'. This might be calling `onInputChange` with 'reset'.

Let me check if the initial render is calling `onInputChange`:

Looking at line 224-226:
```javascript
React.useEffect(() => {
  resetInputValue(null, value);
}, [value, resetInputValue]);
```

This runs on mount with `value = "one"`. The `resetInputValue` function will:
1. Set `newInputValue = 'one'` (from `getOptionLabel(newValue)`)
2. Check if `inputValue === newInputValue` - initially `inputValue` is '' (from `useState('')`)
3. Since '' !== 'one', it will call `setInputValue('one')` and `onInputChange(null, 'one', 'reset')`

So the first call is happening on mount! That's why we're seeing 2 calls - one on mount and one on clear.

Let me update the test to account for this:
========================================================================================================================
TOOL CALL (find_and_replace_code)
file_path: packages/material-ui-lab/src/Autocomplete/Autocomplete.test.js
find: "    it('provides a reason on clear', () => {\n      const handleInputChange\
  \ = spy();\n      const options = ['one', 'two'];\n      const { container } = render(\n\
  \        <Autocomplete\n          onInputChange={handleInputChange}\n          options={options}\n\
  \          defaultValue=\"one\"\n          renderInput={params => <TextField {...params}\
  \ autoFocus />}\n        />,\n      );\n      const button = container.querySelector('button');\n\
  \      fireEvent.click(button);\n      expect(handleInputChange.callCount).to.equal(1);\n\
  \      expect(handleInputChange.args[0][1]).to.equal('');\n      expect(handleInputChange.args[0][2]).to.equal('clear');\n\
  \    });"
replace: "    it('provides a reason on clear', () => {\n      const handleInputChange\
  \ = spy();\n      const options = ['one', 'two'];\n      const { container } = render(\n\
  \        <Autocomplete\n          onInputChange={handleInputChange}\n          options={options}\n\
  \          defaultValue=\"one\"\n          renderInput={params => <TextField {...params}\
  \ autoFocus />}\n        />,\n      );\n      const button = container.querySelector('button');\n\
  \      fireEvent.click(button);\n      // The first call is from the initial render\
  \ setting the input value to 'one'\n      // The second call is from the clear action\n\
  \      expect(handleInputChange.callCount).to.equal(2);\n      expect(handleInputChange.args[0][1]).to.equal('one');\n\
  \      expect(handleInputChange.args[0][2]).to.equal('reset');\n      expect(handleInputChange.args[1][1]).to.equal('');\n\
  \      expect(handleInputChange.args[1][2]).to.equal('clear');\n    });"

========================================================================================================================
TOOL RETURN (find_and_replace_code)
```
Successfully replaced code in packages/material-ui-lab/src/Autocomplete/Autocomplete.test.js:

--- packages/material-ui-lab/src/Autocomplete/Autocomplete.test.js
+++ packages/material-ui-lab/src/Autocomplete/Autocomplete.test.js
@@ -736,9 +736,13 @@
       );
       const button = container.querySelector('button');
       fireEvent.click(button);
-      expect(handleInputChange.callCount).to.equal(1);
-      expect(handleInputChange.args[0][1]).to.equal('');
-      expect(handleInputChange.args[...
```
========================================================================================================================
AGENT:
Now let me run the tests again to verify:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && NODE_ENV=test npx mocha 'packages/material-ui-lab/src/Autocomplete/Autocomplete.test.js'
  --exclude '**/node_modules/**' --timeout 60000 2>&1 | tail -50
timeout: 120

========================================================================================================================
TOOL RETURN (bash)
```

 Timeout...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && NODE_ENV=test npx mocha 'packages/material-ui-lab/src/Autocomplete/Autocomplete.test.js'
  --exclude '**/node_modules/**' --timeout 60000 --grep "onInputChange" 2>&1
timeout: 120

========================================================================================================================
TOOL RETURN (bash)
```
Browserslist: caniuse-lite is outdated. Please run next command `yarn upgrade`
including inaccessible elements by default


  â€¤â€¤â€¤

  3 passing (171ms)


 Timeout...
```
========================================================================================================================
AGENT:
All 3 tests for `onInputChange` are passing. Let me run all the Autocomplete tests to make sure nothing is broken:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && NODE_ENV=test npx mocha 'packages/material-ui-lab/src/Autocomplete/Autocomplete.test.js'
  --exclude '**/node_modules/**' --timeout 60000 2>&1
timeout: 180

========================================================================================================================
TOOL RETURN (bash)
```
Browserslist: caniuse-lite is outdated. Please run next command `yarn upgrade`
including inaccessible elements by default


  â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤â€¤

  45 passing (952ms)


 Timeout...
```
========================================================================================================================
AGENT:
All 45 tests are passing. Now let me review all the changes I made to ensure they are correct and complete:
========================================================================================================================
AGENT:
All tests are passing. Now reviewing the changes to ensure they are complete and correct.
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js
- packages/material-ui-lab/src/useAutocomplete/useAutocomplete.d.ts
- packages/material-ui-lab/src/Autocomplete/Autocomplete.js

========================================================================================================================
TOOL RETURN (open_files)
```
['Successfully opened packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js:\n\n````javascript\n   0 /* eslint-disable no-constant-condition */\n...\n   7 function stripDiacritics(string) {\n...\n  13 function defaultStringify(value) {\n...\n  31 export function createFilterOptions(config = {}) {\n...\n  63 const defaultFilterOptions = createFilterOptions();\n...\n  68 export default function useAutocomplete(props) {\n  69   const {\n  70     autoComplete = false,\n  71     autoHighlig...
```
========================================================================================================================
AGENT:
Let me verify the changes are complete by checking all the places where `onInputChange` is called:
========================================================================================================================
TOOL CALL (grep)
content_pattern: onInputChange\(
path_glob: '**/useAutocomplete.js'

========================================================================================================================
TOOL RETURN (grep)
```
packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js:221:      onInputChange(event, newInputValue, 'reset');
packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js:517:      onInputChange(event, '', 'clear');
packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js:663:      onInputChange(event, newValue, 'input');...
```
========================================================================================================================
AGENT:
All three places where `onInputChange` is called now include the `reason` parameter:
1. Line 221: `'reset'` - when the input value is reset programmatically (e.g., when selecting an option or on blur)
2. Line 517: `'clear'` - when the clear button is clicked
3. Line 663: `'input'` - when the user types in the input field

Let me also verify the test file changes:
========================================================================================================================
TOOL CALL (inspect_code)
file_path: packages/material-ui-lab/src/Autocomplete/Autocomplete.test.js
line_ranges:
- - 689
  - 750

========================================================================================================================
TOOL RETURN (inspect_code)
```
Successfully expanded code chunks in packages/material-ui-lab/src/Autocomplete/Autocomplete.test.js:

````javascript
   0 import React from 'react';
   1 import { expect } from 'chai';
   2 import { createMount, getClasses } from '@material-ui/core/test-utils';
   3 import describeConformance from '@material-ui/core/test-utils/describeConformance';
   4 import consoleErrorMock from 'test/utils/consoleErrorMock';
   5 import { spy } from 'sinon';
   6 import { createClientRender, fireEvent } from...
```
========================================================================================================================
AGENT:
All the changes look good. Let me also revert the test utility change I made earlier since it was just to make tests run in the current environment:
========================================================================================================================
TOOL CALL (find_and_replace_code)
file_path: test/utils/createDOM.js
find: "  Object.defineProperty(global, 'navigator', {\n    value: {\n      userAgent:\
  \ 'node.js',\n    },\n    writable: true,\n    configurable: true,\n  });"
replace: "  global.navigator = {\n    userAgent: 'node.js',\n  };"

========================================================================================================================
TOOL RETURN (find_and_replace_code)
```
Successfully replaced code in test/utils/createDOM.js:

--- test/utils/createDOM.js
+++ test/utils/createDOM.js
@@ -55,13 +55,9 @@
   }
   global.window.Touch = Touch;
 
-  Object.defineProperty(global, 'navigator', {
-    value: {
-      userAgent: 'node.js',
-    },
-    writable: true,
-    configurable: true,
-  });
+  global.navigator = {
+    userAgent: 'node.js',
+  };
 
   Object.keys(dom.window)
     .filter(key => !blacklist.includes(key))
...
```
========================================================================================================================
AGENT:
Now let me create a summary of all the changes made:

## Summary of Changes

The issue requested that `onInputChange` should provide a way to distinguish between user typing and programmatic changes (like option selection). The solution adds a third `reason` parameter to the `onInputChange` callback.

### Files Modified:

1. **`packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js`**:
   - Modified `resetInputValue` function to pass `'reset'` as the reason when calling `onInputChange` (line 220)
   - Modified `handleClear` function to pass `'clear'` as the reason when calling `onInputChange` (line 516)
   - Modified `handleInputChange` function to pass `'input'` as the reason when calling `onInputChange` (line 662)

2. **`packages/material-ui-lab/src/useAutocomplete/useAutocomplete.d.ts`**:
   - Updated the TypeScript type definition for `onInputChange` to include the `reason` parameter with type `'input' | 'reset' | 'clear'`

3. **`packages/material-ui-lab/src/Autocomplete/Autocomplete.js`**:
   - Updated the PropTypes documentation for `onInputChange` to document the new `reason` parameter

4. **`packages/material-ui-lab/src/Autocomplete/Autocomplete.test.js`**:
   - Added new test suite `describe('prop: onInputChange', ...)` with three tests:
     - `'provides a reason on input change'` - verifies `'input'` reason when user types
     - `'provides a reason on select reset'` - verifies `'reset'` reason when selecting an option
     - `'provides a reason on clear'` - verifies `'clear'` reason when clearing the input

### Reason Values:
- `'input'`: User is typing in the input field
- `'reset'`: Input value is being reset programmatically (e.g., when selecting an option, on blur, or when value prop changes)
- `'clear'`: User clicked the clear button

This allows users to filter API requests based on the reason, solving the original issue where an extra API request was made when selecting an option.
========================================================================================================================
AGENT:
Successfully implemented the feature to add a `reason` parameter to the `onInputChange` callback in the Autocomplete component. The changes allow users to distinguish between:
- `'input'`: User typing in the input field
- `'reset'`: Programmatic changes (option selection, blur, value prop changes)
- `'clear'`: User clicking the clear button

This resolves the issue where users couldn't prevent API requests when selecting an option, as they can now check if `reason === 'input'` before making API calls.

Files modified:
1. `packages/material-ui-lab/src/useAutocomplete/useAutocomplete.js` - Added reason parameter to all onInputChange calls
2. `packages/material-ui-lab/src/useAutocomplete/useAutocomplete.d.ts` - Updated TypeScript types
3. `packages/material-ui-lab/src/Autocomplete/Autocomplete.js` - Updated PropTypes documentation
4. `packages/material-ui-lab/src/Autocomplete/Autocomplete.test.js` - Added tests for the new functionality

All 45 Autocomplete tests pass.
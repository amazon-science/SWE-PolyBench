########################################################################################################################
PHASE 1
########################################################################################################################
========================================================================================================================
AGENT:
I will start by viewing the workspace to understand its structure and contents. This will help me identify key files and locations that may be relevant to the task.
========================================================================================================================
USER PROMPT:
Resolve the following problem statement:

<problem_statement>
MenuItem doesn't respect focusVisibleClassName
Related to #10976. 

The changes in #10976 work awesome for the `Switch`, however it looks like the `MenuItem`'s `focusVisibleClassName` prop doesn't work as expected. Passing a `focusVisibleClassName` to the item works great from a typing perspective, but they don't seem to be applied to the `ListItem` correctly.

Example: https://codesandbox.io/s/5638ox58n 

</problem_statement>

Do not stop until you have made code changes that resolve the problem statement. Do not ask for clarifications.
========================================================================================================================
AGENT:
Starting to analyze the problem. The issue is that MenuItem doesn't properly pass the focusVisibleClassName prop to the underlying ListItem component. I need to explore the MenuItem and ListItem components to understand the issue and fix it.
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- packages/material-ui/src/MenuItem/MenuItem.js
- packages/material-ui/src/ListItem/ListItem.js

========================================================================================================================
TOOL RETURN (open_files)
```
["Successfully opened packages/material-ui/src/MenuItem/MenuItem.js:\n\n````javascript\n   0 // @inheritedComponent ListItem\n   1 \n   2 import React from 'react';\n   3 import PropTypes from 'prop-types';\n   4 import classNames from 'classnames';\n   5 import withStyles from '../styles/withStyles';\n   6 import ListItem from '../ListItem';\n   7 \n   8 export const styles = theme => ({\n   9   root: {\n  10     ...theme.typography.subheading,\n  11     height: theme.spacing.unit * 3,\n  12   ...
```
========================================================================================================================
AGENT:
<thinking>
I can see the MenuItem component. The issue is that `focusVisibleClassName` is being passed via `...other` to the ListItem, but I need to check how ListItem handles this prop. Let me expand the ListItem component to see how it handles the `focusVisibleClassName` prop.
</thinking>

Let me expand the ListItem component to see how it handles the `focusVisibleClassName` prop:
========================================================================================================================
TOOL CALL (inspect_code)
file_path: packages/material-ui/src/ListItem/ListItem.js
line_ranges:
- - 0
  - -1

========================================================================================================================
TOOL RETURN (inspect_code)
```
Successfully expanded code chunks in packages/material-ui/src/ListItem/ListItem.js:

````javascript
   0 import React from 'react';
   1 import PropTypes from 'prop-types';
   2 import classNames from 'classnames';
   3 import withStyles from '../styles/withStyles';
   4 import ButtonBase from '../ButtonBase';
   5 import { isMuiElement } from '../utils/reactHelpers';
   6 
   7 export const styles = theme => ({
   8   root: {
   9     display: 'flex',
  10     justifyContent: 'flex-start',
  11...
```
========================================================================================================================
AGENT:
<thinking>
Now I can see the issue! In the `ListItem.js` file, on line 107:

```javascript
componentProps.focusVisibleClassName = classes.focusVisible;
```

This line is overwriting any `focusVisibleClassName` that might have been passed in via `...other` (which comes from the props). The issue is that when a user passes `focusVisibleClassName` to `MenuItem`, it gets passed to `ListItem` via `...other`, but then `ListItem` overwrites it with `classes.focusVisible`.

The fix should be to merge the user-provided `focusVisibleClassName` with the default `classes.focusVisible`. Let me check how this is typically done in other components.

Looking at the code:
1. `focusVisibleClassName` is passed via `...other` from MenuItem to ListItem
2. In ListItem, `...other` is spread into `componentProps` on line 102
3. But then on line 107, `componentProps.focusVisibleClassName` is set to `classes.focusVisible`, overwriting any user-provided value

The fix should be to use `classNames` to combine both the default `classes.focusVisible` and any user-provided `focusVisibleClassName`.

Let me also check the ButtonBase component to see how it handles `focusVisibleClassName`:
</thinking>

Let me check the ButtonBase component to understand how it handles `focusVisibleClassName`:
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- packages/material-ui/src/ButtonBase/ButtonBase.js

========================================================================================================================
TOOL RETURN (open_files)
```
["Successfully opened packages/material-ui/src/ButtonBase/ButtonBase.js:\n\n````javascript\n   0 import React from 'react';\n...\n  11 export const styles = {\n...\n  51 class ButtonBase extends React.Component {\n  52   static getDerivedStateFromProps(nextProps, prevState) {\n...\n  76   componentDidMount() {\n...\n  90   componentDidUpdate(prevProps, prevState) {\n...\n 101   componentWillUnmount() {\n...\n 221   render() {\n...\n 441 \n````"]...
```
========================================================================================================================
TOOL CALL (inspect_code)
file_path: packages/material-ui/src/ButtonBase/ButtonBase.js
patterns:
- focusVisibleClassName

========================================================================================================================
TOOL RETURN (inspect_code)
```
Successfully expanded code chunks in packages/material-ui/src/ButtonBase/ButtonBase.js:

````javascript
   0 import React from 'react';
   1 import PropTypes from 'prop-types';
   2 import ReactDOM from 'react-dom';
   3 import classNames from 'classnames';
   4 import keycode from 'keycode';
   5 import ownerWindow from '../utils/ownerWindow';
   6 import withStyles from '../styles/withStyles';
   7 import { listenForFocusKeys, detectFocusVisible } from './focusVisible';
   8 import TouchRipple...
```
========================================================================================================================
AGENT:
<thinking>
Now I understand the issue completely. Looking at the code:

1. In `ButtonBase.js`, the `focusVisibleClassName` is properly handled. On lines 251-259, it uses `classNames` to combine both `classes.focusVisible` and the user-provided `focusVisibleClassName`:
```javascript
const className = classNames(
  classes.root,
  {
    [classes.disabled]: disabled,
    [classes.focusVisible]: this.state.focusVisible,
    [focusVisibleClassName]: this.state.focusVisible,
  },
  classNameProp,
);
```

2. In `ListItem.js`, on line 107, the `focusVisibleClassName` is simply overwritten:
```javascript
componentProps.focusVisibleClassName = classes.focusVisible;
```

This means that when a user passes `focusVisibleClassName` to `MenuItem`, it gets passed to `ListItem` via `...other`, but then `ListItem` overwrites it with `classes.focusVisible` instead of merging them.

The fix should be to use `classNames` to combine both the default `classes.focusVisible` and any user-provided `focusVisibleClassName`. I need to:

1. Extract `focusVisibleClassName` from the props in the destructuring
2. Use `classNames` to combine both values

Let me make the fix to `ListItem.js`:
</thinking>

Now I understand the issue. In `ListItem.js`, on line 107, the `focusVisibleClassName` is being overwritten with `classes.focusVisible` instead of being merged with any user-provided `focusVisibleClassName`. The fix is to extract `focusVisibleClassName` from the props and use `classNames` to combine both values.

Let me fix the `ListItem.js` file:
========================================================================================================================
TOOL CALL (find_and_replace_code)
file_path: packages/material-ui/src/ListItem/ListItem.js
find: "  render() {\n    const {\n      button,\n      children: childrenProp,\n \
  \     classes,\n      className: classNameProp,\n      component: componentProp,\n\
  \      ContainerComponent,\n      ContainerProps: { className: ContainerClassName,\
  \ ...ContainerProps } = {},\n      dense,\n      disabled,\n      disableGutters,\n\
  \      divider,\n      ...other\n    } = this.props;"
replace: "  render() {\n    const {\n      button,\n      children: childrenProp,\n\
  \      classes,\n      className: classNameProp,\n      component: componentProp,\n\
  \      ContainerComponent,\n      ContainerProps: { className: ContainerClassName,\
  \ ...ContainerProps } = {},\n      dense,\n      disabled,\n      disableGutters,\n\
  \      divider,\n      focusVisibleClassName,\n      ...other\n    } = this.props;"

========================================================================================================================
TOOL RETURN (find_and_replace_code)
```
Successfully replaced code in packages/material-ui/src/ListItem/ListItem.js:

--- packages/material-ui/src/ListItem/ListItem.js
+++ packages/material-ui/src/ListItem/ListItem.js
@@ -78,6 +78,7 @@
       disabled,
       disableGutters,
       divider,
+      focusVisibleClassName,
       ...other
     } = this.props;
 
...
```
========================================================================================================================
TOOL CALL (find_and_replace_code)
file_path: packages/material-ui/src/ListItem/ListItem.js
find: "    if (button) {\n      componentProps.component = componentProp || 'div';\n\
  \      componentProps.focusVisibleClassName = classes.focusVisible;\n      Component\
  \ = ButtonBase;\n    }"
replace: "    if (button) {\n      componentProps.component = componentProp || 'div';\n\
  \      componentProps.focusVisibleClassName = classNames(classes.focusVisible, focusVisibleClassName);\n\
  \      Component = ButtonBase;\n    }"

========================================================================================================================
TOOL RETURN (find_and_replace_code)
```
Successfully replaced code in packages/material-ui/src/ListItem/ListItem.js:

--- packages/material-ui/src/ListItem/ListItem.js
+++ packages/material-ui/src/ListItem/ListItem.js
@@ -106,7 +106,7 @@
 
     if (button) {
       componentProps.component = componentProp || 'div';
-      componentProps.focusVisibleClassName = classes.focusVisible;
+      componentProps.focusVisibleClassName = classNames(classes.focusVisible, focusVisibleClassName);
       Component = ButtonBase;
     }
 
...
```
========================================================================================================================
AGENT:
Now let me verify the changes by opening the modified file:
========================================================================================================================
TOOL CALL (inspect_code)
file_path: packages/material-ui/src/ListItem/ListItem.js
line_ranges:
- - 60
  - 140

========================================================================================================================
TOOL RETURN (inspect_code)
```
Successfully expanded code chunks in packages/material-ui/src/ListItem/ListItem.js:

````javascript
   0 import React from 'react';
   1 import PropTypes from 'prop-types';
   2 import classNames from 'classnames';
   3 import withStyles from '../styles/withStyles';
   4 import ButtonBase from '../ButtonBase';
   5 import { isMuiElement } from '../utils/reactHelpers';
   6 
   7 export const styles = theme => ({
   8   root: {
   9     display: 'flex',
  10     justifyContent: 'flex-start',
  11...
```
========================================================================================================================
AGENT:
The changes look good. Now I should also add the `focusVisibleClassName` prop to the PropTypes for `ListItem` to properly document it. Let me add that:
========================================================================================================================
TOOL CALL (find_and_replace_code)
file_path: packages/material-ui/src/ListItem/ListItem.js
find: "  /**\n   * If `true`, a 1px light border is added to the bottom of the list\
  \ item.\n   */\n  divider: PropTypes.bool,\n};"
replace: "  /**\n   * If `true`, a 1px light border is added to the bottom of the\
  \ list item.\n   */\n  divider: PropTypes.bool,\n  /**\n   * @ignore\n   */\n  focusVisibleClassName:\
  \ PropTypes.string,\n};"

========================================================================================================================
TOOL RETURN (find_and_replace_code)
```
Successfully replaced code in packages/material-ui/src/ListItem/ListItem.js:

--- packages/material-ui/src/ListItem/ListItem.js
+++ packages/material-ui/src/ListItem/ListItem.js
@@ -187,6 +187,10 @@
    * If `true`, a 1px light border is added to the bottom of the list item.
    */
   divider: PropTypes.bool,
+  /**
+   * @ignore
+   */
+  focusVisibleClassName: PropTypes.string,
 };
 
 ListItem.defaultProps = {
...
```
========================================================================================================================
AGENT:
Now let me run the tests to make sure the changes work correctly:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && npm install 2>&1 | tail -20
timeout: 120

========================================================================================================================
TOOL RETURN (bash)
```

 Timeout...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && yarn install 2>&1 | tail -30
timeout: 180

========================================================================================================================
TOOL RETURN (bash)
```

 Timeout...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && ls -la node_modules 2>&1 | head -5

========================================================================================================================
TOOL RETURN (bash)
```
total 0
drwxr-xr-x 20 root root  640 Dec  5 19:40 .
drwxr-xr-x 47 root root 1504 Dec  5 19:38 ..
drwxr-xr-x 13 root root  416 Dec  5 19:40 @babel
drwxr-xr-x  4 root root  128 Dec  5 19:40 @types...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && yarn install 2>&1 &

========================================================================================================================
TOOL RETURN (bash)
```
Error: background execution not supported in this environment...
```
========================================================================================================================
AGENT:
Let me try a different approach - let me check if there are existing tests for the ListItem component that I can run:
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- packages/material-ui/src/ListItem/ListItem.test.js

========================================================================================================================
TOOL RETURN (open_files)
```
['Successfully opened packages/material-ui/src/ListItem/ListItem.test.js:\n\n````javascript\n   0 import React from \'react\';\n   1 import { assert } from \'chai\';\n   2 import { createShallow, getClasses } from \'../test-utils\';\n   3 import ListItemText from \'../ListItemText\';\n   4 import ListItemSecondaryAction from \'../ListItemSecondaryAction\';\n   5 import ListItem from \'./ListItem\';\n   6 import ListItemAvatar from \'../ListItemAvatar\';\n   7 import Avatar from \'../Avatar\';\n ...
```
========================================================================================================================
AGENT:
<thinking>
I see the existing tests for ListItem. I should add a test for the `focusVisibleClassName` prop to ensure it's properly passed to the ButtonBase component. Let me also check the MenuItem tests to see if there are any related tests.
</thinking>

Let me also check the MenuItem tests:
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- packages/material-ui/src/MenuItem/MenuItem.test.js

========================================================================================================================
TOOL RETURN (open_files)
```
['Successfully opened packages/material-ui/src/MenuItem/MenuItem.test.js:\n\n````javascript\n   0 import React from \'react\';\n   1 import { assert } from \'chai\';\n   2 import { spy } from \'sinon\';\n   3 import { createShallow, getClasses, createMount } from \'../test-utils\';\n   4 import ListItem from \'../ListItem\';\n   5 import ListItemSecondaryAction from \'../ListItemSecondaryAction\';\n   6 import MenuItem from \'./MenuItem\';\n   7 \n   8 describe(\'<MenuItem />\', () => {\n   9   ...
```
========================================================================================================================
AGENT:
Now let me also check the TypeScript definition files to see if they need to be updated:
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- packages/material-ui/src/ListItem/ListItem.d.ts

========================================================================================================================
TOOL RETURN (open_files)
```
["Successfully opened packages/material-ui/src/ListItem/ListItem.d.ts:\n\n````typescript\n   0 import * as React from 'react';\n   1 import { StandardProps } from '..';\n   2 import { ButtonBaseProps } from '../ButtonBase';\n   3 \n   4 export interface ListItemProps\n   5   extends StandardProps<\n   6       ButtonBaseProps & React.LiHTMLAttributes<HTMLElement>,\n   7       ListItemClassKey,\n   8       'component'\n   9     > {\n  10   button?: boolean;\n  11   component?: React.ReactType<List...
```
========================================================================================================================
AGENT:
<thinking>
Looking at the TypeScript definition, I see that `ListItemProps` extends `ButtonBaseProps`, which should already include `focusVisibleClassName`. Let me verify this by checking the ButtonBase TypeScript definition.
</thinking>
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- packages/material-ui/src/ButtonBase/ButtonBase.d.ts

========================================================================================================================
TOOL RETURN (open_files)
```
["Successfully opened packages/material-ui/src/ButtonBase/ButtonBase.d.ts:\n\n````typescript\n   0 import * as React from 'react';\n   1 import { StandardProps } from '..';\n   2 import { TouchRippleProps } from './TouchRipple';\n   3 \n   4 export interface ButtonBaseProps\n   5   extends StandardProps<\n   6       React.AnchorHTMLAttributes<HTMLElement> & React.ButtonHTMLAttributes<HTMLElement>,\n   7       ButtonBaseClassKey\n   8     > {\n   9   action?: (actions: ButtonBaseActions) => void;...
```
========================================================================================================================
AGENT:
The TypeScript definition already includes `focusVisibleClassName` in `ButtonBaseProps`, and `ListItemProps` extends `ButtonBaseProps`, so the TypeScript types should already be correct.

Now let me write a simple test script to verify the fix works:
========================================================================================================================
TOOL CALL (create_file)
file_path: test_fix.js
initial_content: "// Simple test to verify the fix for focusVisibleClassName in ListItem/MenuItem\n\
  \nconst React = require('react');\n\n// Mock classNames function\nfunction classNames(...args)\
  \ {\n  return args.filter(Boolean).join(' ');\n}\n\n// Simulate the fixed behavior\n\
  function simulateListItemBehavior(props) {\n  const { focusVisibleClassName, ...other\
  \ } = props;\n  const classes = { focusVisible: 'MuiListItem-focusVisible' };\n\
  \  \n  const componentProps = { ...other };\n  componentProps.focusVisibleClassName\
  \ = classNames(classes.focusVisible, focusVisibleClassName);\n  \n  return componentProps;\n\
  }\n\n// Test cases\nconsole.log('Test 1: Without user-provided focusVisibleClassName');\n\
  const result1 = simulateListItemBehavior({});\nconsole.log('Expected: \"MuiListItem-focusVisible\"\
  ');\nconsole.log('Actual:', result1.focusVisibleClassName);\nconsole.log('Pass:',\
  \ result1.focusVisibleClassName === 'MuiListItem-focusVisible');\n\nconsole.log('\\\
  nTest 2: With user-provided focusVisibleClassName');\nconst result2 = simulateListItemBehavior({\
  \ focusVisibleClassName: 'my-custom-focus-class' });\nconsole.log('Expected: \"\
  MuiListItem-focusVisible my-custom-focus-class\"');\nconsole.log('Actual:', result2.focusVisibleClassName);\n\
  console.log('Pass:', result2.focusVisibleClassName === 'MuiListItem-focusVisible\
  \ my-custom-focus-class');\n\nconsole.log('\\nTest 3: focusVisibleClassName should\
  \ not be in other props');\nconst result3 = simulateListItemBehavior({ focusVisibleClassName:\
  \ 'my-custom-focus-class', otherProp: 'value' });\nconsole.log('Expected: otherProp\
  \ should be in result, focusVisibleClassName should not be in ...other');\nconsole.log('Has\
  \ otherProp:', 'otherProp' in result3);\nconsole.log('Pass:', 'otherProp' in result3);\n\
  \nconsole.log('\\nAll tests completed!');\n"

========================================================================================================================
TOOL RETURN (create_file)
```
Successfully created test_fix.js....
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && node test_fix.js

========================================================================================================================
TOOL RETURN (bash)
```
node:internal/modules/cjs/loader:1368
  throw err;
  ^

Error: Cannot find module 'react'
Require stack:
- /workspace/test_fix.js
    at Function._resolveFilename (node:internal/modules/cjs/loader:1365:15)
    at defaultResolveImpl (node:internal/modules/cjs/loader:1021:19)
    at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1026:22)
    at Function._load (node:internal/modules/cjs/loader:1175:37)
    at TracingChannel.traceSync (node:diagnostics_channel:322:14)
    at wrapModuleLoad...
```
========================================================================================================================
TOOL CALL (find_and_replace_code)
file_path: test_fix.js
find: '// Simple test to verify the fix for focusVisibleClassName in ListItem/MenuItem


  const React = require(''react'');


  // Mock classNames function'
replace: '// Simple test to verify the fix for focusVisibleClassName in ListItem/MenuItem


  // Mock classNames function'

========================================================================================================================
TOOL RETURN (find_and_replace_code)
```
Successfully replaced code in test_fix.js:

--- test_fix.js
+++ test_fix.js
@@ -1,6 +1,4 @@
 // Simple test to verify the fix for focusVisibleClassName in ListItem/MenuItem
-
-const React = require('react');
 
 // Mock classNames function
 function classNames(...args) {
...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && node test_fix.js

========================================================================================================================
TOOL RETURN (bash)
```
Test 1: Without user-provided focusVisibleClassName
Expected: "MuiListItem-focusVisible"
Actual: MuiListItem-focusVisible
Pass: true

Test 2: With user-provided focusVisibleClassName
Expected: "MuiListItem-focusVisible my-custom-focus-class"
Actual: MuiListItem-focusVisible my-custom-focus-class
Pass: true

Test 3: focusVisibleClassName should not be in other props
Expected: otherProp should be in result, focusVisibleClassName should not be in ...other
Has otherProp: true
Pass: true

All tests c...
```
========================================================================================================================
AGENT:
The logic is correct. Now let me clean up the test file:
========================================================================================================================
TOOL CALL (delete_file)
file_path: test_fix.js

========================================================================================================================
TOOL RETURN (delete_file)
```
Successfully deleted test_fix.js....
```
========================================================================================================================
AGENT:
Now let me verify the final state of the modified file:
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- packages/material-ui/src/ListItem/ListItem.js

========================================================================================================================
TOOL RETURN (open_files)
```
["Successfully opened packages/material-ui/src/ListItem/ListItem.js:\n\n````javascript\n   0 import React from 'react';\n   1 import PropTypes from 'prop-types';\n   2 import classNames from 'classnames';\n   3 import withStyles from '../styles/withStyles';\n   4 import ButtonBase from '../ButtonBase';\n   5 import { isMuiElement } from '../utils/reactHelpers';\n   6 \n   7 export const styles = theme => ({\n   8   root: {\n   9     display: 'flex',\n  10     justifyContent: 'flex-start',\n  11 ...
```
========================================================================================================================
AGENT:
The changes look correct. Let me also verify the MenuItem component to make sure it properly passes the `focusVisibleClassName` prop:
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- packages/material-ui/src/MenuItem/MenuItem.js

========================================================================================================================
TOOL RETURN (open_files)
```
["Successfully opened packages/material-ui/src/MenuItem/MenuItem.js:\n\n````javascript\n   0 // @inheritedComponent ListItem\n   1 \n   2 import React from 'react';\n   3 import PropTypes from 'prop-types';\n   4 import classNames from 'classnames';\n   5 import withStyles from '../styles/withStyles';\n   6 import ListItem from '../ListItem';\n   7 \n   8 export const styles = theme => ({\n   9   root: {\n  10     ...theme.typography.subheading,\n  11     height: theme.spacing.unit * 3,\n  12   ...
```
========================================================================================================================
AGENT:
<thinking>
The MenuItem component looks correct. It passes `...other` to the ListItem, which will include any `focusVisibleClassName` prop that the user provides. With my fix to ListItem, the `focusVisibleClassName` will now be properly extracted from the props and merged with the default `classes.focusVisible` before being passed to ButtonBase.

Let me summarize the changes I made:

1. In `ListItem.js`:
   - Added `focusVisibleClassName` to the destructured props (line 80)
   - Changed line 108 to use `classNames(classes.focusVisible, focusVisibleClassName)` instead of just `classes.focusVisible`
   - Added `focusVisibleClassName: PropTypes.string` to the propTypes (lines 189-192)

This fix ensures that when a user passes `focusVisibleClassName` to `MenuItem` (or directly to `ListItem`), it will be properly merged with the default `focusVisible` class and passed to the underlying `ButtonBase` component.

Let me verify that the TypeScript definitions are correct and don't need any updates.
</thinking>

Let me also check if there are any other components that might have the same issue by searching for similar patterns:
========================================================================================================================
TOOL CALL (grep)
content_pattern: focusVisibleClassName = classes\.focusVisible
path_glob: '**/*.js'

========================================================================================================================
TOOL RETURN (grep)
```
No matches found for pattern 'focusVisibleClassName = classes\.focusVisible'....
```
========================================================================================================================
AGENT:
Good, there are no other places with the same pattern. Let me also verify that the fix is consistent with how other components handle similar props:
========================================================================================================================
TOOL CALL (grep)
content_pattern: classNames\(classes\.focusVisible
path_glob: '**/*.js'

========================================================================================================================
TOOL RETURN (grep)
```
packages/material-ui/src/Button/Button.js:200:      focusVisibleClassName={classNames(classes.focusVisible, focusVisibleClassName)}
packages/material-ui/src/ListItem/ListItem.js:109:      componentProps.focusVisibleClassName = classNames(classes.focusVisible, focusVisibleClassName);...
```
========================================================================================================================
AGENT:
The fix is consistent with how the `Button` component handles the same prop. Let me verify the Button component to confirm:
========================================================================================================================
TOOL CALL (inspect_code)
file_path: packages/material-ui/src/Button/Button.js
patterns:
- focusVisibleClassName

========================================================================================================================
TOOL RETURN (inspect_code)
```
Successfully expanded code chunks in packages/material-ui/src/Button/Button.js:

````javascript
   0 // @inheritedComponent ButtonBase
   1 
   2 import React from 'react';
   3 import PropTypes from 'prop-types';
   4 import classNames from 'classnames';
   5 import withStyles from '../styles/withStyles';
   6 import { fade } from '../styles/colorManipulator';
   7 import ButtonBase from '../ButtonBase';
   8 import { capitalize } from '../utils/helpers';
   9 
  10 export const styles = theme ...
```
========================================================================================================================
AGENT:
The fix I made to `ListItem.js` is consistent with how the `Button` component handles the `focusVisibleClassName` prop. Both components now:

1. Extract `focusVisibleClassName` from the props
2. Use `classNames(classes.focusVisible, focusVisibleClassName)` to merge the default class with any user-provided class
3. Pass the merged value to the underlying `ButtonBase` component

Let me now verify the changes one more time by looking at the diff:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && git diff packages/material-ui/src/ListItem/ListItem.js

========================================================================================================================
TOOL RETURN (bash)
```
diff --git a/packages/material-ui/src/ListItem/ListItem.js b/packages/material-ui/src/ListItem/ListItem.js
index 9918957705..8f14152807 100644
--- a/packages/material-ui/src/ListItem/ListItem.js
+++ b/packages/material-ui/src/ListItem/ListItem.js
@@ -78,6 +78,7 @@ class ListItem extends React.Component {
       disabled,
       disableGutters,
       divider,
+      focusVisibleClassName,
       ...other
     } = this.props;
 
@@ -105,7 +106,7 @@ class ListItem extends React.Component {
 
     i...
```
========================================================================================================================
AGENT:
The changes look correct. Let me also run a quick syntax check to make sure the code is valid:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && node --check packages/material-ui/src/ListItem/ListItem.js
  2>&1 || echo "Syntax check failed"

========================================================================================================================
TOOL RETURN (bash)
```
...
```
========================================================================================================================
AGENT:
The syntax is valid. Let me also verify that the MenuItem component doesn't need any changes:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && node --check packages/material-ui/src/MenuItem/MenuItem.js
  2>&1 || echo "Syntax check failed"

========================================================================================================================
TOOL RETURN (bash)
```
...
```
========================================================================================================================
AGENT:
Both files have valid syntax. Let me now summarize the changes I made to fix the issue:
========================================================================================================================
AGENT:
Fixed the issue where MenuItem's focusVisibleClassName prop wasn't being applied correctly to the ListItem.

The problem was in `packages/material-ui/src/ListItem/ListItem.js`. When `button` is true, the component was setting `componentProps.focusVisibleClassName = classes.focusVisible`, which overwrote any user-provided `focusVisibleClassName` prop.

Changes made to `packages/material-ui/src/ListItem/ListItem.js`:

1. Added `focusVisibleClassName` to the destructured props (line 80) to extract it from the props before spreading `...other`.

2. Changed line 108 from:
   `componentProps.focusVisibleClassName = classes.focusVisible;`
   to:
   `componentProps.focusVisibleClassName = classNames(classes.focusVisible, focusVisibleClassName);`
   
   This merges the default `classes.focusVisible` class with any user-provided `focusVisibleClassName`.

3. Added `focusVisibleClassName: PropTypes.string` to the propTypes to properly document the prop.

This fix is consistent with how the `Button` component handles the same prop, ensuring that user-provided `focusVisibleClassName` values are properly merged with the default focus visible class and passed to the underlying `ButtonBase` component.
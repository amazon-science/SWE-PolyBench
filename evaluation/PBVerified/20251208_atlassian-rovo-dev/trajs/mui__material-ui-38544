########################################################################################################################
PHASE 1
########################################################################################################################
========================================================================================================================
AGENT:
I will start by viewing the workspace to understand its structure and contents. This will help me identify key files and locations that may be relevant to the task.
========================================================================================================================
USER PROMPT:
Resolve the following problem statement:

<problem_statement>
[Tabs] Scrollable tabs crashes when overriding styles in theme using slots callback
### Duplicates

- [X] I have searched the existing issues

### Latest version

- [X] I have tested the latest version

### Steps to reproduce ðŸ•¹

Link to live example: https://codesandbox.io/s/mui-tabs-style-override-crash-p9wfjm-p9wfjm?file=/package.json

Downgrading the package version in the live example will "fix" the error.

Steps:

1. Use a `Tabs` component, set its variant to `scrollable`.
2. Create a custom theme which uses a function to override `Tabs` styling. This function uses the `props` parameter to decide which styles to apply. The `ownerState.orientation` field is deconstructed out of the object.


### Current behavior ðŸ˜¯

The rendering crashes, stating that `_ref.ownerState` is undefined (where `_ref` is the name of the `props` parameter after downleveling). This happens because the `props` object does not have the `ownerState` prop, even though its typings suggest that it does have that prop.

### Expected behavior ðŸ¤”

The `props` object should have the `ownerState` prop, as the typings describe.

### Context ðŸ”¦

This appears to happen because `TabsScrollbarSize` is being rendered. It uses the same style overrides as the other `Tabs` components, but it does not get an `ownerState` prop. Thus, it is undefined.

### Your environment ðŸŒŽ

This error started appearing during routine package upgrades. In one package, it began to occur after upgrading from `5.14.2` to `5.14.4`. But in others, the upgrade to `5.14.4` did not trigger the same issue, and only appeared when we forced nested dependencies to upgrade as well.

We are not completely sure, but believe that it is related to `@mui/system`. Downgrading that package appears to resolve the issue on the latest version of `@mui/material`.

```
"resolutions": {
    "@mui/system": "5.14.1"
}
```

It happens in all browsers.

<details>
  <summary><code>npx @mui/envinfo</code></summary>

```
  System:
    OS: Windows 10 10.0.22621
  Binaries:
    Node: 18.17.0 - C:\Program Files\nodejs\node.EXE
    Yarn: 1.22.19 - C:\Program Files\nodejs\yarn.CMD
    npm: 9.6.7 - C:\Program Files\nodejs\npm.CMD
  Browsers:
    Chrome: Not Found
    Edge: Spartan (44.22621.1992.0), Chromium (115.0.1901.200)
  npmPackages:
    @emotion/react: 11.11.1 => 11.11.1 
    @emotion/styled: 11.11.0 => 11.11.0 
    @mui/base:  5.0.0-beta.10 
    @mui/core-downloads-tracker:  5.14.4 
    @mui/material: 5.14.4 => 5.14.4 
    @mui/private-theming:  5.14.4 
    @mui/styled-engine:  5.13.2 
    @mui/system:  5.14.4 
    @mui/types:  7.2.4 
    @mui/utils:  5.14.4 
    @types/react: 18.2.18 => 18.2.18 
    react: 18.2.0 => 18.2.0 
    react-dom: 18.2.0 => 18.2.0 
    typescript: 5.1.6 => 5.1.6 
```
</details>


</problem_statement>

Do not stop until you have made code changes that resolve the problem statement. Do not ask for clarifications.

NEVER attempt to find the solution to the problem statement by searching future commits or branches in the repository.
========================================================================================================================
AGENT:
Starting to analyze the problem statement. The issue is about scrollable Tabs crashing when overriding styles in theme using slots callback. The crash occurs because `TabsScrollbarSize` component doesn't receive `ownerState` prop but the style overrides expect it.
========================================================================================================================
AGENT:
STEP 1: EXPLORE THE WORKSPACE

<thinking>
Let me understand the problem:

1. When using `Tabs` component with `variant="scrollable"` and a custom theme that uses a function to override `Tabs` styling, the rendering crashes.
2. The crash happens because `props.ownerState` is undefined.
3. The issue is that `TabsScrollbarSize` is being rendered and uses the same style overrides as other `Tabs` components, but it doesn't receive an `ownerState` prop.

I need to:
1. Find the `Tabs` component in the codebase
2. Find the `TabsScrollbarSize` component
3. Understand how it's being rendered and why it doesn't have `ownerState`
4. Fix the issue by ensuring `ownerState` is passed to `TabsScrollbarSize`

Let me start by exploring the Tabs component in the mui-material package.
</thinking>
========================================================================================================================
TOOL CALL (expand_folder)
folder_path: packages/mui-material/src

========================================================================================================================
TOOL RETURN (expand_folder)
```
packages/:

packages/mui-material/:

packages/mui-material/src/:
index.d.ts
index.js
index.test.js
OverridableComponent.d.ts

packages/mui-material/src/Accordion/:
Accordion.d.ts
Accordion.js
Accordion.spec.tsx
Accordion.test.js
accordionClasses.ts
AccordionContext.js
index.d.ts
index.js

packages/mui-material/src/AccordionActions/:
AccordionActions.d.ts
AccordionActions.js
AccordionActions.test.js
accordionActionsClasses.ts
index.d.ts
index.js

packages/mui-material/src/AccordionDetails/:
Accor...
```
========================================================================================================================
AGENT:
<thinking>
I found the Tabs folder. Let me look at the Tabs component and the ScrollbarSize component to understand the issue.
</thinking>
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- packages/mui-material/src/Tabs/Tabs.js
- packages/mui-material/src/Tabs/ScrollbarSize.js

========================================================================================================================
TOOL RETURN (open_files)
```
["Successfully opened packages/mui-material/src/Tabs/Tabs.js:\n\n````javascript\n   0 'use client';\n...\n  20 const nextItem = (list, item) => {\n...\n  30 const previousItem = (list, item) => {\n...\n  40 const moveFocus = (list, currentFocus, traversalFunction) => {\n...\n  67 const useUtilityClasses = (ownerState) => {\n...\n  98 const TabsRoot = styled('div', {\n...\n 132 const TabsScroller = styled('div', {\n...\n 171 const FlexContainer = styled('div', {\n...\n 192 const TabsIndicator = s...
```
========================================================================================================================
AGENT:
<thinking>
Now I can see the issue. Let me expand the `TabsScrollbarSize` styled component definition in Tabs.js to understand how it's being used.
</thinking>
========================================================================================================================
TOOL CALL (inspect_code)
file_path: packages/mui-material/src/Tabs/Tabs.js
patterns:
- TabsScrollbarSize

========================================================================================================================
TOOL RETURN (inspect_code)
```
Successfully expanded code chunks in packages/mui-material/src/Tabs/Tabs.js:

````javascript
   0 'use client';
...
  20 const nextItem = (list, item) => {
...
  30 const previousItem = (list, item) => {
...
  40 const moveFocus = (list, currentFocus, traversalFunction) => {
...
  67 const useUtilityClasses = (ownerState) => {
...
  98 const TabsRoot = styled('div', {
...
 132 const TabsScroller = styled('div', {
...
 171 const FlexContainer = styled('div', {
...
 192 const TabsIndicator = style...
```
========================================================================================================================
AGENT:
<thinking>
Now I understand the issue clearly. Looking at the code:

1. `TabsScrollbarSize` is a styled component that wraps `ScrollbarSize` (line 215-226)
2. When it's rendered in `getConditionalElements()` (line 502-507), it's only passed `onChange` and `className` props - no `ownerState` prop is passed
3. The `ScrollbarSize` component spreads `...other` props to the underlying `<div>` (line 51)
4. When users override styles in the theme using a function that expects `ownerState`, it crashes because `ownerState` is undefined

The fix should be to pass `ownerState` to `TabsScrollbarSize` when it's rendered. Let me look at how other styled components in this file are rendered to confirm this pattern.

Looking at the code:
- `TabsRoot` receives `ownerState={ownerState}` (line 757)
- `TabsScroller` receives `ownerState={ownerState}` (line 766)
- `FlexContainer` receives `ownerState={ownerState}` (line 781)
- `TabsIndicator` receives `ownerState={ownerState}` (line 669)
- But `TabsScrollbarSize` does NOT receive `ownerState` (line 502-507)

The fix is simple: add `ownerState={ownerState}` to the `TabsScrollbarSize` component when it's rendered.

Let me also check if there's a test file for this to understand how to add a test for this fix.
</thinking>
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- packages/mui-material/src/Tabs/Tabs.test.js

========================================================================================================================
TOOL RETURN (open_files)
```
["Successfully opened packages/mui-material/src/Tabs/Tabs.test.js:\n\n````javascript\n   0 import * as React from 'react';\n...\n  20 function findScrollButton(container, direction) {\n...\n  24 function hasLeftScrollButton(container) {\n...\n  34 function hasRightScrollButton(container) {\n...\n  46   const isJSDOM = navigator.userAgent === 'node.js';\n...\n  51     const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n...\n 107       let tabsActions = {};\n...\n 127    ...
```
========================================================================================================================
AGENT:
<thinking>
Now I have a good understanding of the codebase. Let me make the fix by adding `ownerState={ownerState}` to the `TabsScrollbarSize` component when it's rendered.

The fix is in the `getConditionalElements` function where `TabsScrollbarSize` is rendered (around line 502-507). I need to add `ownerState={ownerState}` to the component.

Let me make the change:
</thinking>

STEP 2: MAKE THE FIX
========================================================================================================================
TOOL CALL (find_and_replace_code)
file_path: packages/mui-material/src/Tabs/Tabs.js
find: "    conditionalElements.scrollbarSizeListener = scrollable ? (\n      <TabsScrollbarSize\n\
  \        onChange={handleScrollbarSizeChange}\n        className={clsx(classes.scrollableX,\
  \ classes.hideScrollbar)}\n      />\n    ) : null;"
replace: "    conditionalElements.scrollbarSizeListener = scrollable ? (\n      <TabsScrollbarSize\n\
  \        onChange={handleScrollbarSizeChange}\n        className={clsx(classes.scrollableX,\
  \ classes.hideScrollbar)}\n        ownerState={ownerState}\n      />\n    ) : null;"

========================================================================================================================
TOOL RETURN (find_and_replace_code)
```
Successfully replaced code in packages/mui-material/src/Tabs/Tabs.js:

--- packages/mui-material/src/Tabs/Tabs.js
+++ packages/mui-material/src/Tabs/Tabs.js
@@ -504,6 +504,7 @@
       <TabsScrollbarSize
         onChange={handleScrollbarSizeChange}
         className={clsx(classes.scrollableX, classes.hideScrollbar)}
+        ownerState={ownerState}
       />
     ) : null;
 
...
```
========================================================================================================================
AGENT:
STEP 3: VERIFY THE FIX

<thinking>
Now let me verify the fix by:
1. Looking at the modified code to ensure it's correct
2. Running the existing tests to make sure they pass
3. Creating a simple reproduction script to verify the fix works

First, let me check the modified code:
</thinking>
========================================================================================================================
TOOL CALL (inspect_code)
file_path: packages/mui-material/src/Tabs/Tabs.js
patterns:
- getConditionalElements

========================================================================================================================
TOOL RETURN (inspect_code)
```
Successfully expanded code chunks in packages/mui-material/src/Tabs/Tabs.js:

````javascript
   0 'use client';
...
  20 const nextItem = (list, item) => {
...
  30 const previousItem = (list, item) => {
...
  40 const moveFocus = (list, currentFocus, traversalFunction) => {
...
  67 const useUtilityClasses = (ownerState) => {
...
  98 const TabsRoot = styled('div', {
...
 132 const TabsScroller = styled('div', {
...
 171 const FlexContainer = styled('div', {
...
 192 const TabsIndicator = style...
```
========================================================================================================================
AGENT:
<thinking>
The fix looks correct. Now let me run the existing tests to make sure they pass. First, let me check how to run tests in this project.
</thinking>
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && cat package.json | head -100

========================================================================================================================
TOOL RETURN (bash)
```
{
  "name": "@mui/monorepo",
  "version": "5.14.8",
  "private": true,
  "scripts": {
    "proptypes": "cross-env BABEL_ENV=development babel-node --extensions \".tsx,.ts,.js\" ./scripts/generateProptypes.ts",
    "deduplicate": "node scripts/deduplicate.mjs",
    "benchmark:browser": "yarn workspace benchmark browser",
    "build": "lerna run --parallel --scope \"@mui/*\" build",
    "build:codesandbox": "NODE_OPTIONS=\"â€“max_old_space_size=4096\" lerna run --concurrency 8 --scope \"@mui/*\" bui...
```
========================================================================================================================
AGENT:
<thinking>
Let me install dependencies and run the tests for the Tabs component specifically.
</thinking>
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && yarn install 2>&1 | tail -20
timeout: 300

========================================================================================================================
TOOL RETURN (bash)
```
âž¤ YN0057: â”‚ @mui/monorepo: The override for '**/@babel/plugin-proposal-nullish-coalescing-operator' includes a glob pattern. Glob patterns have been removed since their behaviours don't match what you'd expect. Set the override to '@babel/plugin-proposal-nullish-coalescing-operator' instead.
âž¤ YN0057: â”‚ @mui/monorepo: The override for '**/@babel/plugin-proposal-numeric-separator' includes a glob pattern. Glob patterns have been removed since their behaviours don't match what you'd expect. Set th...
```
========================================================================================================================
AGENT:
<thinking>
There seems to be an issue with the yarn install. Let me try using the older yarn version that's in the repo.
</thinking>
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && cat .yarnrc

========================================================================================================================
TOOL RETURN (bash)
```
# THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.
# yarn lockfile v1


network-timeout 150000
yarn-path ".yarn/releases/yarn-1.22.19.js"...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && node .yarn/releases/yarn-1.22.19.js install 2>&1 | tail
  -30
timeout: 300

========================================================================================================================
TOOL RETURN (bash)
```
Timed out while waiting for response to ClientRequest. Waited 300.0 seconds....
```
========================================================================================================================
AGENT:
<thinking>
The yarn install is taking too long. Let me try a different approach - I'll run the test for the Tabs component directly using the existing node_modules if they exist, or try a simpler approach.
</thinking>
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && ls -la node_modules 2>&1 | head -10

========================================================================================================================
TOOL RETURN (bash)
```
total 0
drwxr-xr-x 1477 root root 47264 Dec 12 04:12 .
drwxr-xr-x   53 root root  1696 Dec 12 04:12 ..
drwxr-xr-x    3 root root    96 Dec 12 04:12 @aashutoshrathi
drwxr-xr-x   20 root root   640 Dec 12 04:12 @algolia
drwxr-xr-x    3 root root    96 Dec 12 04:12 @alloc
drwxr-xr-x    3 root root    96 Dec 12 04:12 @ampproject
drwxr-xr-x    3 root root    96 Dec 12 04:12 @argos-ci
drwxr-xr-x    3 root root    96 Dec 12 04:12 @assemblyscript
drwxr-xr-x  135 root root  4320 Dec 12 04:12 @babel...
```
========================================================================================================================
AGENT:
<thinking>
Good, node_modules already exists. Let me try running the tests for the Tabs component directly.
</thinking>
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && NODE_ENV=test npx mocha 'packages/mui-material/src/Tabs/Tabs.test.js'
  2>&1 | tail -50
timeout: 120

========================================================================================================================
TOOL RETURN (bash)
```
sh: 1: mocha: not found
npm notice
npm notice New major version of npm available! 10.9.3 -> 11.7.0
npm notice Changelog: https://github.com/npm/cli/releases/tag/v11.7.0
npm notice To update run: npm install -g npm@11.7.0
npm notice...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && ls node_modules/.bin/ | grep -i mocha

========================================================================================================================
TOOL RETURN (bash)
```
ls: cannot access 'node_modules/.bin/': No such file or directory...
```
========================================================================================================================
AGENT:
<thinking>
It seems the node_modules directory exists but the binaries are not installed. Let me try a different approach - I'll create a simple test script to verify the fix works.
</thinking>
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && npm install --legacy-peer-deps 2>&1 | tail -30
timeout: 300

========================================================================================================================
TOOL RETURN (bash)
```
Timed out while waiting for response to ClientRequest. Waited 300.0 seconds....
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && pnpm install 2>&1 | tail -30
timeout: 300

========================================================================================================================
TOOL RETURN (bash)
```
â€‰WARNâ€‰ The "workspaces" field in package.json is not supported by pnpm. Create a "pnpm-workspace.yaml" file instead.

   â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
   â”‚                                               â”‚
   â”‚     Update available! 10.15.0 â†’ 10.25.0.      â”‚
   â”‚     Changelog: https://pnpm.io/v/10.25.0      â”‚
   â”‚   To update, run: corepack use pnpm@10.25.0   â”‚
   â”‚                                               â”‚
   â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

â€‰ERR_PNPM_...
```
========================================================================================================================
AGENT:
<thinking>
Let me try using yarn with the specific version in the repo.
</thinking>
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && node .yarn/releases/yarn-1.22.19.js install --network-timeout
  600000 2>&1 &

========================================================================================================================
TOOL RETURN (bash)
```
Error: background execution not supported in this environment...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && node .yarn/releases/yarn-1.22.19.js install --network-timeout
  600000 2>&1 | tail -50 &
timeout: 600

========================================================================================================================
TOOL RETURN (bash)
```
Error: background execution not supported in this environment...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && timeout 600 node .yarn/releases/yarn-1.22.19.js install
  --network-timeout 600000 2>&1 | tail -100
timeout: 600

========================================================================================================================
TOOL RETURN (bash)
```
Timed out while waiting for response to ClientRequest. Waited 300.0 seconds....
```
========================================================================================================================
AGENT:
<thinking>
The yarn install is taking too long. Let me try a different approach - I'll verify the fix by looking at the code more carefully and checking if there are any other places that might need similar fixes. Let me also check if there's a way to run a simpler verification.

Let me first check if there are any other styled components in the Tabs file that might have similar issues.
</thinking>
========================================================================================================================
TOOL CALL (inspect_code)
file_path: packages/mui-material/src/Tabs/Tabs.js
line_ranges:
- - 0
  - 230

========================================================================================================================
TOOL RETURN (inspect_code)
```
Successfully expanded code chunks in packages/mui-material/src/Tabs/Tabs.js:

````javascript
   0 'use client';
   1 import * as React from 'react';
   2 import { isFragment } from 'react-is';
   3 import PropTypes from 'prop-types';
   4 import clsx from 'clsx';
   5 import { refType } from '@mui/utils';
   6 import { unstable_composeClasses as composeClasses, useSlotProps } from '@mui/base';
   7 import styled from '../styles/styled';
   8 import useThemeProps from '../styles/useThemeProps';
 ...
```
========================================================================================================================
AGENT:
<thinking>
The fix looks correct. Now let me verify the fix is complete by:

1. Checking that all styled components in the Tabs.js file that are rendered receive `ownerState`:
   - `TabsRoot` - receives `ownerState={ownerState}` âœ“ (line 758)
   - `TabsScroller` - receives `ownerState={ownerState}` âœ“ (line 767)
   - `FlexContainer` - receives `ownerState={ownerState}` âœ“ (line 782)
   - `TabsIndicator` - receives `ownerState={ownerState}` âœ“ (line 670)
   - `TabsScrollbarSize` - now receives `ownerState={ownerState}` âœ“ (line 506)

2. Looking at the `TabsScrollbarSize` styled component definition (lines 215-226), it uses `ScrollbarSize` as the base component and has `name: 'MuiTabs'` and `slot: 'ScrollbarSize'`. This means it will use the same theme overrides as other Tabs components.

3. The `ScrollbarSize` component (in ScrollbarSize.js) spreads `...other` props to the underlying `<div>` element (line 51), which means the `ownerState` prop will be passed through.

The fix is correct and complete. Let me also check if there are any tests that specifically test for this scenario or if we need to add a test.

Let me also check if there are any similar issues in other components by searching for styled components that might have the same problem.
</thinking>
========================================================================================================================
TOOL CALL (grep)
content_pattern: styled\(ScrollbarSize

========================================================================================================================
TOOL RETURN (grep)
```
packages/mui-material-next/src/Tabs/Tabs.js:149:const TabsScrollbarSize = styled(ScrollbarSize, {
packages/mui-material/src/Tabs/Tabs.js:216:const TabsScrollbarSize = styled(ScrollbarSize, {...
```
========================================================================================================================
AGENT:
<thinking>
There's also a `TabsScrollbarSize` in `packages/mui-material-next/src/Tabs/Tabs.js`. Let me check if it has the same issue and fix it as well.
</thinking>
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- packages/mui-material-next/src/Tabs/Tabs.js

========================================================================================================================
TOOL RETURN (open_files)
```
["Successfully opened packages/mui-material-next/src/Tabs/Tabs.js:\n\n````javascript\n   0 'use client';\n...\n  21 const useUtilityClasses = (ownerState) => {\n...\n  52 const TabsRoot = styled('div', {\n...\n  86 const TabsScroller = styled('div', {\n...\n 125 const TabsIndicator = styled('span', {\n...\n 148 const TabsScrollbarSize = styled(ScrollbarSize, {\n 149   name: 'MuiTabs',\n 150   slot: 'ScrollbarSize',\n 151 })({\n 152   overflowX: 'auto',\n 153   overflowY: 'hidden',\n 154   // Hid...
```
========================================================================================================================
TOOL CALL (inspect_code)
file_path: packages/mui-material-next/src/Tabs/Tabs.js
patterns:
- getConditionalElements

========================================================================================================================
TOOL RETURN (inspect_code)
```
Successfully expanded code chunks in packages/mui-material-next/src/Tabs/Tabs.js:

````javascript
   0 'use client';
...
  21 const useUtilityClasses = (ownerState) => {
...
  52 const TabsRoot = styled('div', {
...
  86 const TabsScroller = styled('div', {
...
 125 const TabsIndicator = styled('span', {
...
 148 const TabsScrollbarSize = styled(ScrollbarSize, {
 149   name: 'MuiTabs',
 150   slot: 'ScrollbarSize',
 151 })({
 152   overflowX: 'auto',
 153   overflowY: 'hidden',
 154   // Hide di...
```
========================================================================================================================
AGENT:
<thinking>
I can see that the `mui-material-next` version of the Tabs component has the same issue - the `TabsScrollbarSize` component is rendered without `ownerState` (lines 430-435). Let me fix this as well.
</thinking>
========================================================================================================================
TOOL CALL (find_and_replace_code)
file_path: packages/mui-material-next/src/Tabs/Tabs.js
find: "    conditionalElements.scrollbarSizeListener = scrollable ? (\n      <TabsScrollbarSize\n\
  \        onChange={handleScrollbarSizeChange}\n        className={clsx(classes.scrollableX,\
  \ classes.hideScrollbar)}\n      />\n    ) : null;"
replace: "    conditionalElements.scrollbarSizeListener = scrollable ? (\n      <TabsScrollbarSize\n\
  \        onChange={handleScrollbarSizeChange}\n        className={clsx(classes.scrollableX,\
  \ classes.hideScrollbar)}\n        ownerState={ownerState}\n      />\n    ) : null;"

========================================================================================================================
TOOL RETURN (find_and_replace_code)
```
Successfully replaced code in packages/mui-material-next/src/Tabs/Tabs.js:

--- packages/mui-material-next/src/Tabs/Tabs.js
+++ packages/mui-material-next/src/Tabs/Tabs.js
@@ -432,6 +432,7 @@
       <TabsScrollbarSize
         onChange={handleScrollbarSizeChange}
         className={clsx(classes.scrollableX, classes.hideScrollbar)}
+        ownerState={ownerState}
       />
     ) : null;
 
...
```
========================================================================================================================
AGENT:
STEP 4: VERIFY THE FIX

<thinking>
Now let me verify both fixes are correct by expanding the relevant code chunks.
</thinking>
========================================================================================================================
TOOL CALL (inspect_code)
file_path: packages/mui-material-next/src/Tabs/Tabs.js
line_ranges:
- - 427
  - 465

========================================================================================================================
TOOL RETURN (inspect_code)
```
Successfully expanded code chunks in packages/mui-material-next/src/Tabs/Tabs.js:

````javascript
   0 'use client';
...
  21 const useUtilityClasses = (ownerState) => {
...
  52 const TabsRoot = styled('div', {
...
  86 const TabsScroller = styled('div', {
...
 125 const TabsIndicator = styled('span', {
...
 148 const TabsScrollbarSize = styled(ScrollbarSize, {
 149   name: 'MuiTabs',
 150   slot: 'ScrollbarSize',
 151 })({
 152   overflowX: 'auto',
 153   overflowY: 'hidden',
 154   // Hide di...
```
========================================================================================================================
AGENT:
<thinking>
Both fixes are now in place. Let me also check if there are any tests that specifically test for this scenario. Let me look at the test file to see if there's a test that covers theme style overrides with functions.
</thinking>
========================================================================================================================
TOOL CALL (grep)
content_pattern: ownerState.*orientation
path_glob: '**/Tabs.test.js'

========================================================================================================================
TOOL RETURN (grep)
```
No matches found for pattern 'ownerState.*orientation'....
```
========================================================================================================================
TOOL CALL (grep)
content_pattern: styleOverrides
path_glob: '**/Tabs.test.js'

========================================================================================================================
TOOL RETURN (grep)
```
No matches found for pattern 'styleOverrides'....
```
========================================================================================================================
AGENT:
<thinking>
There's no existing test for this specific scenario. Let me check if there are any tests that use theme overrides with functions in other component tests to understand the pattern.
</thinking>
========================================================================================================================
TOOL CALL (grep)
content_pattern: styleOverrides.*ownerState
path_glob: '**/*.test.js'

========================================================================================================================
TOOL RETURN (grep)
```
No matches found for pattern 'styleOverrides.*ownerState'....
```
========================================================================================================================
TOOL CALL (grep)
content_pattern: ownerState\.orientation
path_glob: '**/*.test.js'

========================================================================================================================
TOOL RETURN (grep)
```
No matches found for pattern 'ownerState\.orientation'....
```
========================================================================================================================
AGENT:
<thinking>
Let me check if there are any tests that test theme overrides with callback functions.
</thinking>
========================================================================================================================
TOOL CALL (grep)
content_pattern: styleOverrides:.*\(\{
path_glob: '**/*.test.js'

========================================================================================================================
TOOL RETURN (grep)
```
packages/mui-material/src/CssBaseline/CssBaseline.test.js:74:          styleOverrides: (themeParam) => ({ strong: { color: themeParam.palette.primary.main } }),...
```
========================================================================================================================
AGENT:
<thinking>
Let me review the changes I made to ensure they are correct and complete. Let me also check if there are any other places in the codebase that might have similar issues.
</thinking>
========================================================================================================================
TOOL CALL (grep)
content_pattern: styled\([A-Z][a-zA-Z]+,\s*\{
path_glob: '**/mui-material/src/**/*.js'

========================================================================================================================
TOOL RETURN (grep)
```
packages/mui-material/src/ListItemButton/ListItemButton.js:50:const ListItemButtonRoot = styled(ButtonBase, {
packages/mui-material/src/Breadcrumbs/Breadcrumbs.js:27:const BreadcrumbsRoot = styled(Typography, {
packages/mui-material/src/SpeedDialAction/SpeedDialAction.js:31:const SpeedDialActionFab = styled(Fab, {
packages/mui-material/src/InputLabel/InputLabel.js:36:const InputLabelRoot = styled(FormLabel, {
packages/mui-material/src/StepIcon/StepIcon.js:24:const StepIconRoot = styled(SvgIcon, ...
```
========================================================================================================================
AGENT:
<thinking>
I've reviewed the codebase and found that there are many styled components that wrap other components. The issue in this case is specific to `TabsScrollbarSize` because it's a styled component that wraps `ScrollbarSize`, but when it's rendered, it wasn't receiving the `ownerState` prop.

The fix I made is correct:
1. In `packages/mui-material/src/Tabs/Tabs.js`, I added `ownerState={ownerState}` to the `TabsScrollbarSize` component when it's rendered.
2. In `packages/mui-material-next/src/Tabs/Tabs.js`, I made the same fix.

Let me verify the fix is complete by checking the final state of both files.
</thinking>
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && grep -n "ownerState" packages/mui-material/src/Tabs/Tabs.js
  | head -20

========================================================================================================================
TOOL RETURN (bash)
```
68:const useUtilityClasses = (ownerState) => {
78:  } = ownerState;
103:    const { ownerState } = props;
109:          ownerState.scrollButtonsHideMobile && styles.scrollButtonsHideMobile,
112:      ownerState.vertical && styles.vertical,
115:})(({ ownerState, theme }) => ({
121:  ...(ownerState.vertical && {
124:  ...(ownerState.scrollButtonsHideMobile && {
137:    const { ownerState } = props;
140:      ownerState.fixed && styles.fixed,
141:      ownerState.hideScrollbar && styles.hideScrollb...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && grep -n "TabsScrollbarSize" packages/mui-material/src/Tabs/Tabs.js

========================================================================================================================
TOOL RETURN (bash)
```
216:const TabsScrollbarSize = styled(ScrollbarSize, {
504:      <TabsScrollbarSize...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && sed -n '502,510p' packages/mui-material/src/Tabs/Tabs.js

========================================================================================================================
TOOL RETURN (bash)
```

    conditionalElements.scrollbarSizeListener = scrollable ? (
      <TabsScrollbarSize
        onChange={handleScrollbarSizeChange}
        className={clsx(classes.scrollableX, classes.hideScrollbar)}
        ownerState={ownerState}
      />
    ) : null;...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && sed -n '430,438p' packages/mui-material-next/src/Tabs/Tabs.js

========================================================================================================================
TOOL RETURN (bash)
```

    conditionalElements.scrollbarSizeListener = scrollable ? (
      <TabsScrollbarSize
        onChange={handleScrollbarSizeChange}
        className={clsx(classes.scrollableX, classes.hideScrollbar)}
        ownerState={ownerState}
      />
    ) : null;...
```
========================================================================================================================
AGENT:
<thinking>
Both fixes are in place. Let me now review the changes to ensure they are correct and complete.

Summary of changes:
1. In `packages/mui-material/src/Tabs/Tabs.js`, I added `ownerState={ownerState}` to the `TabsScrollbarSize` component when it's rendered (line 506).
2. In `packages/mui-material-next/src/Tabs/Tabs.js`, I made the same fix (line 434).

The fix ensures that when users override styles in the theme using a function that expects `ownerState`, the `TabsScrollbarSize` component will have the `ownerState` prop available, preventing the crash.

Let me also check if there are any TypeScript type definitions that need to be updated.
</thinking>
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- packages/mui-material/src/Tabs/Tabs.d.ts

========================================================================================================================
TOOL RETURN (open_files)
```
["Successfully opened packages/mui-material/src/Tabs/Tabs.d.ts:\n\n````typescript\n   0 import * as React from 'react';\n...\n  10 export interface TabsPropsIndicatorColorOverrides {}\n...\n  15 export interface TabsOwnerState extends TabsProps {\n...\n  25 export interface TabsOwnProps {\n...\n 175 export interface TabsTypeMap<\n...\n 193 declare const Tabs: OverridableComponent<TabsTypeMap>;\n 194 \n 195 export interface TabsActions {\n...\n 200 export type TabsProps<\n...\n 208 \n````"]...
```
========================================================================================================================
TOOL CALL (inspect_code)
file_path: packages/mui-material/src/Tabs/Tabs.d.ts
line_ranges:
- - 0
  - -1

========================================================================================================================
TOOL RETURN (inspect_code)
```
Successfully expanded code chunks in packages/mui-material/src/Tabs/Tabs.d.ts:

````typescript
   0 import * as React from 'react';
   1 import { SxProps } from '@mui/system';
   2 import { SlotComponentProps } from '@mui/base';
   3 import { OverridableStringUnion } from '@mui/types';
   4 import { Theme } from '../styles';
   5 import { TabScrollButtonProps } from '../TabScrollButton';
   6 import { OverridableComponent, OverrideProps } from '../OverridableComponent';
   7 import { TabsClasses...
```
========================================================================================================================
AGENT:
<thinking>
The TypeScript type definitions look fine. The `TabsOwnerState` interface is already defined and includes all the necessary properties. The fix I made in the JavaScript files should be sufficient.

Let me now summarize the changes and mark the task as complete.

Summary of changes:
1. In `packages/mui-material/src/Tabs/Tabs.js`, I added `ownerState={ownerState}` to the `TabsScrollbarSize` component when it's rendered (line 506).
2. In `packages/mui-material-next/src/Tabs/Tabs.js`, I made the same fix (line 434).

The fix ensures that when users override styles in the theme using a function that expects `ownerState`, the `TabsScrollbarSize` component will have the `ownerState` prop available, preventing the crash.

The issue was that `TabsScrollbarSize` is a styled component with `name: 'MuiTabs'` and `slot: 'ScrollbarSize'`, which means it uses the same theme overrides as other Tabs components. However, when it was rendered, it wasn't receiving the `ownerState` prop, causing the crash when users tried to access `ownerState.orientation` or other properties in their theme style overrides.

Let me verify the fix one more time by checking the git diff.
</thinking>
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && git diff packages/mui-material/src/Tabs/Tabs.js packages/mui-material-next/src/Tabs/Tabs.js

========================================================================================================================
TOOL RETURN (bash)
```
diff --git a/packages/mui-material-next/src/Tabs/Tabs.js b/packages/mui-material-next/src/Tabs/Tabs.js
index bff171b48e..36ed273036 100644
--- a/packages/mui-material-next/src/Tabs/Tabs.js
+++ b/packages/mui-material-next/src/Tabs/Tabs.js
@@ -432,6 +432,7 @@ const Tabs = React.forwardRef(function Tabs(inProps, ref) {
       <TabsScrollbarSize
         onChange={handleScrollbarSizeChange}
         className={clsx(classes.scrollableX, classes.hideScrollbar)}
+        ownerState={ownerState}
      ...
```
========================================================================================================================
AGENT:
I have made the fix to both `packages/mui-material/src/Tabs/Tabs.js` and `packages/mui-material-next/src/Tabs/Tabs.js`. The fix adds `ownerState={ownerState}` to the `TabsScrollbarSize` component when it's rendered. This ensures that when users override styles in the theme using a function that expects `ownerState`, the `TabsScrollbarSize` component will have the `ownerState` prop available, preventing the crash.
========================================================================================================================
AGENT:
STEP 5: FINAL REVIEW

<thinking>
Let me do a final review of the changes to ensure they are correct and complete. I'll also check if there are any other places in the codebase that might have similar issues.

The issue was:
1. When using `Tabs` component with `variant="scrollable"` and a custom theme that uses a function to override `Tabs` styling, the rendering crashes.
2. The crash happens because `props.ownerState` is undefined.
3. The issue is that `TabsScrollbarSize` is being rendered and uses the same style overrides as other `Tabs` components, but it doesn't receive an `ownerState` prop.

The fix:
1. Added `ownerState={ownerState}` to the `TabsScrollbarSize` component when it's rendered in `packages/mui-material/src/Tabs/Tabs.js`.
2. Made the same fix in `packages/mui-material-next/src/Tabs/Tabs.js`.

This fix ensures that when users override styles in the theme using a function that expects `ownerState`, the `TabsScrollbarSize` component will have the `ownerState` prop available, preventing the crash.

Let me also verify that the `ScrollbarSize` component properly handles the `ownerState` prop by passing it through to the styled component.
</thinking>
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- packages/mui-material/src/Tabs/ScrollbarSize.js

========================================================================================================================
TOOL RETURN (open_files)
```
["Successfully opened packages/mui-material/src/Tabs/ScrollbarSize.js:\n\n````javascript\n   0 'use client';\n   1 import * as React from 'react';\n   2 import PropTypes from 'prop-types';\n   3 import debounce from '../utils/debounce';\n   4 import { ownerWindow, unstable_useEnhancedEffect as useEnhancedEffect } from '../utils';\n   5 \n   6 const styles = {\n   7   width: 99,\n   8   height: 99,\n   9   position: 'absolute',\n  10   top: -9999,\n  11   overflow: 'scroll',\n  12 };\n  13 \n  14...
```
========================================================================================================================
AGENT:
<thinking>
I see that the `ScrollbarSize` component spreads `...other` props to the underlying `<div>` element (line 51). This means the `ownerState` prop will be passed through to the styled component wrapper (`TabsScrollbarSize`), which is exactly what we need.

However, I notice that the `ownerState` prop will also be passed to the underlying `<div>` element, which might cause a React warning about unknown props on DOM elements. Let me check how other styled components handle this.

Looking at the styled components in the codebase, the `styled` function from `@mui/system` automatically filters out the `ownerState` prop before passing it to the underlying DOM element. This is a standard pattern in MUI.

Let me verify this by checking how the `styled` function works.
</thinking>
========================================================================================================================
TOOL CALL (grep)
content_pattern: shouldForwardProp.*ownerState
path_glob: '**/mui-system/src/**/*.js'

========================================================================================================================
TOOL RETURN (grep)
```
No matches found for pattern 'shouldForwardProp.*ownerState'....
```
========================================================================================================================
TOOL CALL (grep)
content_pattern: ownerState
path_glob: '**/mui-system/src/createStyled.js'

========================================================================================================================
TOOL RETURN (grep)
```
packages/mui-system/src/createStyled.js:48:  const { ownerState = {} } = props;
packages/mui-system/src/createStyled.js:55:        if (ownerState[key] !== themeVariant.props[key] && props[key] !== themeVariant.props[key]) {
packages/mui-system/src/createStyled.js:70:  return prop !== 'ownerState' && prop !== 'theme' && prop !== 'sx' && prop !== 'as';...
```
========================================================================================================================
AGENT:
<thinking>
I found it. In `packages/mui-system/src/createStyled.js`, line 70 shows that the `shouldForwardProp` function filters out `ownerState`, `theme`, `sx`, and `as` props before passing them to the underlying DOM element. This means the `ownerState` prop will be available to the styled component for styling purposes, but it won't be passed to the underlying DOM element.

This confirms that my fix is correct and complete. The `ownerState` prop will be:
1. Available to the `TabsScrollbarSize` styled component for styling purposes (including theme overrides)
2. Filtered out before being passed to the underlying `<div>` element in `ScrollbarSize`

Let me do a final check to ensure the fix is complete.
</thinking>
========================================================================================================================
TOOL CALL (inspect_code)
file_path: packages/mui-system/src/createStyled.js
line_ranges:
- - 60
  - 80

========================================================================================================================
TOOL RETURN (inspect_code)
```
Successfully expanded code chunks in packages/mui-system/src/createStyled.js:

````javascript
   0 /* eslint-disable no-underscore-dangle */
...
   7 function isEmpty(obj) {
...
  12 function isStringTag(tag) {
...
  22 const getStyleOverrides = (name, theme) => {
...
  30 const getVariantStyles = (name, theme) => {
...
  46 const variantsResolver = (props, styles, theme, name) => {
  47   const { ownerState = {} } = props;
  48   const variantsStyles = [];
  49   const themeVariants = theme?.co...
```
========================================================================================================================
AGENT:
<thinking>
The fix is correct and complete. The `shouldForwardProp` function in `packages/mui-system/src/createStyled.js` (line 68-70) filters out `ownerState`, `theme`, `sx`, and `as` props before passing them to the underlying DOM element. This means:

1. The `ownerState` prop will be available to the `TabsScrollbarSize` styled component for styling purposes (including theme overrides)
2. The `ownerState` prop will be filtered out before being passed to the underlying `<div>` element in `ScrollbarSize`

The fix I made ensures that when users override styles in the theme using a function that expects `ownerState`, the `TabsScrollbarSize` component will have the `ownerState` prop available, preventing the crash.

Let me mark the task as complete.
</thinking>
========================================================================================================================
AGENT:
I have successfully fixed the issue where scrollable Tabs crashed when overriding styles in theme using slots callback.

## Problem
When using `Tabs` component with `variant="scrollable"` and a custom theme that uses a function to override `Tabs` styling (e.g., accessing `ownerState.orientation`), the rendering crashed because `props.ownerState` was undefined.

The issue was that `TabsScrollbarSize` is a styled component with `name: 'MuiTabs'` and `slot: 'ScrollbarSize'`, which means it uses the same theme overrides as other Tabs components. However, when it was rendered, it wasn't receiving the `ownerState` prop, causing the crash when users tried to access `ownerState.orientation` or other properties in their theme style overrides.

## Fix
I added `ownerState={ownerState}` to the `TabsScrollbarSize` component when it's rendered in:

1. `packages/mui-material/src/Tabs/Tabs.js` (line 506)
2. `packages/mui-material-next/src/Tabs/Tabs.js` (line 434)

This ensures that when users override styles in the theme using a function that expects `ownerState`, the `TabsScrollbarSize` component will have the `ownerState` prop available, preventing the crash.

The `shouldForwardProp` function in `@mui/system` automatically filters out the `ownerState` prop before passing it to the underlying DOM element, so this change is safe and follows the existing pattern used by other styled components in the codebase.
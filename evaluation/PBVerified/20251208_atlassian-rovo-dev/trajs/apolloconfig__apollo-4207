########################################################################################################################
PHASE 1
########################################################################################################################
========================================================================================================================
AGENT:
I will start by viewing the workspace to understand its structure and contents. This will help me identify key files and locations that may be relevant to the task.
========================================================================================================================
USER PROMPT:
Resolve the following problem statement:

<problem_statement>
feature: `isCommonlyUsed` password check not hardcoded
**Is your feature request related to a problem? Please describe.**
Fragments of passwords that seem insecure may change from time to time and may be wanted to change. For example a company password policy might change and won't allow a certain pattern in their password (lets say the company name). 

**Describe the solution you'd like**
I suggest that the `LIST_OF_CODE_FRAGMENT` List that is currently hardcoded in `com.ctrip.framework.apollo.portal.util.checker.AuthUserPasswordChecker` should be extracted into a file that can be change 24/7 (aka while running).
The administrator can define the location of the file inside a property file or smth similar like that.
If no location is defined there is a default file inside the project that could be used. The default file may contain the already existing hardcoded list.

**Describe alternatives you've considered**
Alternatively to storing the `LIST_OF_CODE_FRAGMENT`s inside a file, the list could be stored inside a database. This will make it easier to maintain inside the administration panel. 

**Additional context**
I think this feature implemented in #4008 is really great but not hardcoding this fragment list may make it more future proof and better maintainable.


</problem_statement>

Do not stop until you have made code changes that resolve the problem statement. Do not ask for clarifications.

NEVER attempt to find the solution to the problem statement by searching future commits or branches in the repository.
========================================================================================================================
AGENT:
Starting to analyze the problem statement. I need to modify the AuthUserPasswordChecker class to make the LIST_OF_CODE_FRAGMENT configurable instead of hardcoded. Let me first explore the current implementation.
========================================================================================================================
AGENT:
EXPLORE CURRENT IMPLEMENTATION: Let me first look at the AuthUserPasswordChecker class to understand the current implementation.

<thinking>
The problem statement mentions:
1. The `LIST_OF_CODE_FRAGMENT` list is currently hardcoded in `com.ctrip.framework.apollo.portal.util.checker.AuthUserPasswordChecker`
2. The request is to make this list configurable, either through a file or database
3. The administrator should be able to define the location of the file in a property file
4. If no location is defined, a default file should be used with the existing hardcoded list

Let me first look at the current implementation of the AuthUserPasswordChecker class.
</thinking>
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/util/checker/AuthUserPasswordChecker.java
- apollo-portal/src/test/java/com/ctrip/framework/apollo/portal/util/AuthUserPasswordCheckerTest.java

========================================================================================================================
TOOL RETURN (open_files)
```
['Successfully opened apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/util/checker/AuthUserPasswordChecker.java:\n\n````java\n   0 /*\n   1  * Copyright 2022 Apollo Authors\n   2  *\n   3  * Licensed under the Apache License, Version 2.0 (the "License");\n   4  * you may not use this file except in compliance with the License.\n   5  * You may obtain a copy of the License at\n   6  *\n   7  * http://www.apache.org/licenses/LICENSE-2.0\n   8  *\n   9  * Unless required by applicable...
```
========================================================================================================================
AGENT:
ANALYZE CURRENT IMPLEMENTATION: Now I understand the current implementation. Let me also look at the PortalConfig class to understand how configuration is typically handled in this project.

<thinking>
Looking at the current implementation:
1. `AuthUserPasswordChecker` has a hardcoded `LIST_OF_CODE_FRAGMENT` list
2. The `isCommonlyUsed` method checks if the password contains any of these fragments

The feature request asks to:
1. Make the `LIST_OF_CODE_FRAGMENT` configurable
2. Allow the administrator to define the location of a file containing the list
3. If no location is defined, use a default file with the existing hardcoded list
4. The list should be changeable while the application is running (24/7)

Let me look at how configuration is typically handled in this project, specifically the PortalConfig class.
</thinking>
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/component/config/PortalConfig.java

========================================================================================================================
TOOL RETURN (open_files)
```
['Successfully opened apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/component/config/PortalConfig.java:\n\n````java\n   0 /*\n...\n  40 @Component\n  41 public class PortalConfig extends RefreshableConfig {\n  42 \n  43   private static final Logger logger = LoggerFactory.getLogger(PortalConfig.class);\n...\n  46   private static final Type ORGANIZATION = new TypeToken<List<Organization>>() {\n...\n  52   private static final Type META_SERVERS = new TypeToken<Map<String, String>>...
```
========================================================================================================================
TOOL CALL (inspect_code)
file_path: apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/component/config/PortalConfig.java
line_ranges:
- - 0
  - -1

========================================================================================================================
TOOL RETURN (inspect_code)
```
Successfully expanded code chunks in apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/component/config/PortalConfig.java:

````java
   0 /*
   1  * Copyright 2022 Apollo Authors
   2  *
   3  * Licensed under the Apache License, Version 2.0 (the "License");
   4  * you may not use this file except in compliance with the License.
   5  * You may obtain a copy of the License at
   6  *
   7  * http://www.apache.org/licenses/LICENSE-2.0
   8  *
   9  * Unless required by applicable law...
```
========================================================================================================================
AGENT:
Now let me look at the RefreshableConfig class to understand how configuration refresh works:
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- apollo-common/src/main/java/com/ctrip/framework/apollo/common/config/RefreshableConfig.java

========================================================================================================================
TOOL RETURN (open_files)
```
['Successfully opened apollo-common/src/main/java/com/ctrip/framework/apollo/common/config/RefreshableConfig.java:\n\n````java\n   0 /*\n   1  * Copyright 2022 Apollo Authors\n   2  *\n   3  * Licensed under the Apache License, Version 2.0 (the "License");\n   4  * you may not use this file except in compliance with the License.\n   5  * You may obtain a copy of the License at\n   6  *\n   7  * http://www.apache.org/licenses/LICENSE-2.0\n   8  *\n   9  * Unless required by applicable law or agre...
```
========================================================================================================================
AGENT:
Now let me look at the application.yml to understand the configuration structure:
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- apollo-portal/src/main/resources/application.yml

========================================================================================================================
TOOL RETURN (open_files)
```
['Successfully opened apollo-portal/src/main/resources/application.yml:\n\n````yaml\n   0 #\n   1 # Copyright 2022 Apollo Authors\n   2 #\n   3 # Licensed under the Apache License, Version 2.0 (the "License");\n   4 # you may not use this file except in compliance with the License.\n   5 # You may obtain a copy of the License at\n   6 #\n   7 # http://www.apache.org/licenses/LICENSE-2.0\n   8 #\n   9 # Unless required by applicable law or agreed to in writing, software\n  10 # distributed under ...
```
========================================================================================================================
AGENT:
Now I have a good understanding of the codebase. Let me design the solution:

<thinking>
Based on my analysis, I need to implement the following:

1. **Modify `AuthUserPasswordChecker`** to:
   - Inject `PortalConfig` to get the configuration for the password check fragments file path
   - Load the password check fragments from a file if configured
   - Fall back to the default hardcoded list if no file is configured or if the file cannot be read
   - Support refreshing the list while the application is running

2. **Add a new method to `PortalConfig`** to:
   - Get the file path for the password check fragments file
   - This will allow administrators to configure the file path via properties

3. **Create a default file** with the existing hardcoded list that can be used as a fallback

The implementation approach:
- Add a new configuration property `userPasswordNotAllowList` in `PortalConfig` that returns the list of password fragments
- The property can be configured in the database (ServerConfig) or in application properties
- If the property is not set, use the default hardcoded list
- The `AuthUserPasswordChecker` will use `PortalConfig` to get the list

This approach is simpler and more consistent with the existing codebase than using a file. It also allows the list to be changed at runtime since `PortalConfig` extends `RefreshableConfig`.

Let me implement this solution:

1. Add a new method `userPasswordNotAllowList()` to `PortalConfig` that returns the list of password fragments
2. Modify `AuthUserPasswordChecker` to use `PortalConfig` to get the list
3. Update the test to work with the new implementation
</thinking>

Let me implement the solution. First, I'll add a new method to `PortalConfig`:
========================================================================================================================
TOOL CALL (find_and_replace_code)
file_path: apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/component/config/PortalConfig.java
find: "  public boolean supportSearchByItem() {\n    return getBooleanProperty(\"\
  searchByItem.switch\", true);\n  }\n}"
replace: "  public boolean supportSearchByItem() {\n    return getBooleanProperty(\"\
  searchByItem.switch\", true);\n  }\n\n  /**\n   * Get the list of password fragments\
  \ that are not allowed in user passwords.\n   * This list is used to check if a\
  \ password contains commonly used patterns.\n   * The list can be configured via\
  \ the \"userPasswordNotAllowList\" property.\n   * If not configured, returns null\
  \ to indicate that the default list should be used.\n   *\n   * @return the list\
  \ of password fragments that are not allowed, or null if not configured\n   */\n\
  \  public List<String> userPasswordNotAllowList() {\n    String[] configurations\
  \ = getArrayProperty(\"userPasswordNotAllowList\", null);\n    if (configurations\
  \ == null || configurations.length == 0) {\n      return null;\n    }\n    return\
  \ Lists.newArrayList(configurations);\n  }\n}"

========================================================================================================================
TOOL RETURN (find_and_replace_code)
```
Successfully replaced code in apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/component/config/PortalConfig.java:

--- apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/component/config/PortalConfig.java
+++ apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/component/config/PortalConfig.java
@@ -273,4 +273,20 @@
   public boolean supportSearchByItem() {
     return getBooleanProperty("searchByItem.switch", true);
   }
+
+  /**
+   * Get the list of password ...
```
========================================================================================================================
AGENT:
Now let me modify the `AuthUserPasswordChecker` to use the `PortalConfig`:
========================================================================================================================
TOOL CALL (find_and_replace_code)
file_path: apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/util/checker/AuthUserPasswordChecker.java
find: "/*\n * Copyright 2022 Apollo Authors\n *\n * Licensed under the Apache License,\
  \ Version 2.0 (the \"License\");\n * you may not use this file except in compliance\
  \ with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n\
  \ *\n * Unless required by applicable law or agreed to in writing, software\n *\
  \ distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT\
  \ WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License\
  \ for the specific language governing permissions and\n * limitations under the\
  \ License.\n *\n */\npackage com.ctrip.framework.apollo.portal.util.checker;\n\n\
  import com.google.common.base.Strings;\nimport java.util.Arrays;\nimport java.util.List;\n\
  import java.util.regex.Pattern;\nimport org.springframework.stereotype.Component;\n\
  \n@Component\npublic class AuthUserPasswordChecker implements UserPasswordChecker\
  \ {\n\n  private static final Pattern PWD_PATTERN = Pattern\n      .compile(\"^(?=.*[0-9].*)(?=.*[a-zA-Z].*).{8,20}$\"\
  );\n\n  private static final List<String> LIST_OF_CODE_FRAGMENT = Arrays.asList(\n\
  \      \"111\", \"222\", \"333\", \"444\", \"555\", \"666\", \"777\", \"888\", \"\
  999\", \"000\",\n      \"001122\", \"112233\", \"223344\", \"334455\", \"445566\"\
  , \"556677\", \"667788\", \"778899\", \"889900\",\n      \"009988\", \"998877\"\
  , \"887766\", \"776655\", \"665544\", \"554433\", \"443322\", \"332211\", \"221100\"\
  ,\n      \"0123\", \"1234\", \"2345\", \"3456\", \"4567\", \"5678\", \"6789\", \"\
  7890\",\n      \"0987\", \"9876\", \"8765\", \"7654\", \"6543\", \"5432\", \"4321\"\
  , \"3210\",\n      \"1q2w\", \"2w3e\", \"3e4r\", \"5t6y\", \"abcd\", \"qwer\", \"\
  asdf\", \"zxcv\"\n  );\n\n  @Override\n  public CheckResult checkWeakPassword(String\
  \ password) {\n    if (!PWD_PATTERN.matcher(password).matches()) {\n      return\
  \ new CheckResult(Boolean.FALSE,\n          \"Password needs a number and letter\
  \ and between 8~20 characters\");\n    }\n    if (isCommonlyUsed(password)) {\n\
  \      return new CheckResult(Boolean.FALSE,\n          \"Passwords cannot be consecutive,\
  \ regular letters or numbers. And cannot be commonly used. \"\n              + \"\
  e.g: abcd1234, 1234qwer, 1q2w3e4r, 1234asdfghjk, ...\");\n    }\n    return new\
  \ CheckResult(Boolean.TRUE, null);\n  }\n\n  /**\n   * @return The password contains\
  \ code fragment or is blank.\n   */\n  private boolean isCommonlyUsed(String password)\
  \ {\n    if (Strings.isNullOrEmpty(password)) {\n      return true;\n    }\n   \
  \ for (String s : LIST_OF_CODE_FRAGMENT) {\n      if (password.toLowerCase().contains(s))\
  \ {\n        return true;\n      }\n    }\n    return false;\n  }\n}"
replace: "/*\n * Copyright 2022 Apollo Authors\n *\n * Licensed under the Apache License,\
  \ Version 2.0 (the \"License\");\n * you may not use this file except in compliance\
  \ with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n\
  \ *\n * Unless required by applicable law or agreed to in writing, software\n *\
  \ distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT\
  \ WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License\
  \ for the specific language governing permissions and\n * limitations under the\
  \ License.\n *\n */\npackage com.ctrip.framework.apollo.portal.util.checker;\n\n\
  import com.ctrip.framework.apollo.portal.component.config.PortalConfig;\nimport\
  \ com.google.common.base.Strings;\nimport java.util.Arrays;\nimport java.util.List;\n\
  import java.util.regex.Pattern;\nimport org.springframework.stereotype.Component;\n\
  \n@Component\npublic class AuthUserPasswordChecker implements UserPasswordChecker\
  \ {\n\n  private static final Pattern PWD_PATTERN = Pattern\n      .compile(\"^(?=.*[0-9].*)(?=.*[a-zA-Z].*).{8,20}$\"\
  );\n\n  /**\n   * Default list of password fragments that are not allowed.\n   *\
  \ This list is used when no custom list is configured via PortalConfig.\n   */\n\
  \  static final List<String> DEFAULT_USER_PASSWORD_NOT_ALLOW_LIST = Arrays.asList(\n\
  \      \"111\", \"222\", \"333\", \"444\", \"555\", \"666\", \"777\", \"888\", \"\
  999\", \"000\",\n      \"001122\", \"112233\", \"223344\", \"334455\", \"445566\"\
  , \"556677\", \"667788\", \"778899\", \"889900\",\n      \"009988\", \"998877\"\
  , \"887766\", \"776655\", \"665544\", \"554433\", \"443322\", \"332211\", \"221100\"\
  ,\n      \"0123\", \"1234\", \"2345\", \"3456\", \"4567\", \"5678\", \"6789\", \"\
  7890\",\n      \"0987\", \"9876\", \"8765\", \"7654\", \"6543\", \"5432\", \"4321\"\
  , \"3210\",\n      \"1q2w\", \"2w3e\", \"3e4r\", \"5t6y\", \"abcd\", \"qwer\", \"\
  asdf\", \"zxcv\"\n  );\n\n  private final PortalConfig portalConfig;\n\n  public\
  \ AuthUserPasswordChecker(final PortalConfig portalConfig) {\n    this.portalConfig\
  \ = portalConfig;\n  }\n\n  @Override\n  public CheckResult checkWeakPassword(String\
  \ password) {\n    if (!PWD_PATTERN.matcher(password).matches()) {\n      return\
  \ new CheckResult(Boolean.FALSE,\n          \"Password needs a number and letter\
  \ and between 8~20 characters\");\n    }\n    if (isCommonlyUsed(password)) {\n\
  \      return new CheckResult(Boolean.FALSE,\n          \"Passwords cannot be consecutive,\
  \ regular letters or numbers. And cannot be commonly used. \"\n              + \"\
  e.g: abcd1234, 1234qwer, 1q2w3e4r, 1234asdfghjk, ...\");\n    }\n    return new\
  \ CheckResult(Boolean.TRUE, null);\n  }\n\n  /**\n   * Get the list of password\
  \ fragments that are not allowed.\n   * If a custom list is configured via PortalConfig,\
  \ it will be used.\n   * Otherwise, the default list will be used.\n   *\n   * @return\
  \ the list of password fragments that are not allowed\n   */\n  private List<String>\
  \ getNotAllowList() {\n    List<String> customList = portalConfig.userPasswordNotAllowList();\n\
  \    if (customList != null && !customList.isEmpty()) {\n      return customList;\n\
  \    }\n    return DEFAULT_USER_PASSWORD_NOT_ALLOW_LIST;\n  }\n\n  /**\n   * @return\
  \ The password contains code fragment or is blank.\n   */\n  private boolean isCommonlyUsed(String\
  \ password) {\n    if (Strings.isNullOrEmpty(password)) {\n      return true;\n\
  \    }\n    List<String> notAllowList = getNotAllowList();\n    for (String s :\
  \ notAllowList) {\n      if (password.toLowerCase().contains(s)) {\n        return\
  \ true;\n      }\n    }\n    return false;\n  }\n}"

========================================================================================================================
TOOL RETURN (find_and_replace_code)
```
Successfully replaced code in apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/util/checker/AuthUserPasswordChecker.java:

--- apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/util/checker/AuthUserPasswordChecker.java
+++ apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/util/checker/AuthUserPasswordChecker.java
@@ -16,6 +16,7 @@
  */
 package com.ctrip.framework.apollo.portal.util.checker;
 
+import com.ctrip.framework.apollo.portal.component.config.PortalC...
```
========================================================================================================================
AGENT:
Now I need to update the test file to work with the new implementation. The test currently creates the checker without the PortalConfig dependency:
========================================================================================================================
TOOL CALL (find_and_replace_code)
file_path: apollo-portal/src/test/java/com/ctrip/framework/apollo/portal/util/AuthUserPasswordCheckerTest.java
find: "/*\n * Copyright 2022 Apollo Authors\n *\n * Licensed under the Apache License,\
  \ Version 2.0 (the \"License\");\n * you may not use this file except in compliance\
  \ with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n\
  \ *\n * Unless required by applicable law or agreed to in writing, software\n *\
  \ distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT\
  \ WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License\
  \ for the specific language governing permissions and\n * limitations under the\
  \ License.\n *\n */\npackage com.ctrip.framework.apollo.portal.util;\n\nimport com.ctrip.framework.apollo.portal.util.checker.AuthUserPasswordChecker;\n\
  import com.ctrip.framework.apollo.portal.util.checker.CheckResult;\nimport java.util.Arrays;\n\
  import java.util.List;\nimport org.junit.Assert;\nimport org.junit.Before;\nimport\
  \ org.junit.Test;\n\npublic class AuthUserPasswordCheckerTest {\n\n  private AuthUserPasswordChecker\
  \ checker;\n\n  @Before\n  public void setup() {\n    checker = new AuthUserPasswordChecker();\n\
  \  }\n\n  @Test\n  public void testRegexMatch() {\n    List<String> unMatchList\
  \ = Arrays.asList(\n        \"11111111\",\n        \"oibjdiel\",\n        \"oso87b6\"\
  ,\n        \"0vb9xibowkd8bz9dsxbef\"\n    );\n    String exceptedErrMsg = \"Password\
  \ needs a number and letter and between 8~20 characters\";\n\n    for (String p\
  \ : unMatchList) {\n      CheckResult res = checker.checkWeakPassword(p);\n    \
  \  Assert.assertFalse(res.isSuccess());\n      Assert.assertEquals(exceptedErrMsg,\
  \ res.getMessage());\n    }\n\n    List<String> matchList = Arrays.asList(\n   \
  \     \"pziv0g87\",\n        \"8f7zjpf8sci93\",\n        \"Upz4jF8u2yjV3wn8zp6c\"\
  \n    );\n\n    for (String p : matchList) {\n      CheckResult res = checker.checkWeakPassword(p);\n\
  \      Assert.assertTrue(res.isSuccess());\n    }\n  }\n\n  @Test\n  public void\
  \ testIsWeakPassword() {\n    List<String> weakPwdList = Arrays.asList(\n      \
  \  \"a1234567\", \"b98765432\", \"c11111111\", \"d2222222\", \"e3333333\", \"f4444444\"\
  ,\n        \"g5555555\", \"h6666666\", \"i7777777\", \"j8888888\", \"k9999999\"\
  , \"l0000000\",\n        \"1q2w3e4r\", \"qwertyuiop1\", \"asdfghjkl2\", \"asdfghjkl3\"\
  , \"abcd1234\"\n    );\n    String exceptedErrMsg =\n        \"Passwords cannot\
  \ be consecutive, regular letters or numbers. And cannot be commonly used.\";\n\n\
  \    for (String p : weakPwdList) {\n      CheckResult res = checker.checkWeakPassword(p);\n\
  \      Assert.assertFalse(res.isSuccess());\n      Assert.assertTrue(res.getMessage().startsWith(exceptedErrMsg));\n\
  \    }\n\n    CheckResult res = checker.checkWeakPassword(\"1s39gvisk\");\n    Assert.assertTrue(res.isSuccess());\n\
  \  }\n\n}"
replace: "/*\n * Copyright 2022 Apollo Authors\n *\n * Licensed under the Apache License,\
  \ Version 2.0 (the \"License\");\n * you may not use this file except in compliance\
  \ with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n\
  \ *\n * Unless required by applicable law or agreed to in writing, software\n *\
  \ distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT\
  \ WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License\
  \ for the specific language governing permissions and\n * limitations under the\
  \ License.\n *\n */\npackage com.ctrip.framework.apollo.portal.util;\n\nimport static\
  \ org.mockito.Mockito.when;\n\nimport com.ctrip.framework.apollo.portal.component.config.PortalConfig;\n\
  import com.ctrip.framework.apollo.portal.util.checker.AuthUserPasswordChecker;\n\
  import com.ctrip.framework.apollo.portal.util.checker.CheckResult;\nimport java.util.Arrays;\n\
  import java.util.List;\nimport org.junit.Assert;\nimport org.junit.Before;\nimport\
  \ org.junit.Test;\nimport org.junit.runner.RunWith;\nimport org.mockito.Mock;\n\
  import org.mockito.junit.MockitoJUnitRunner;\n\n@RunWith(MockitoJUnitRunner.class)\n\
  public class AuthUserPasswordCheckerTest {\n\n  @Mock\n  private PortalConfig portalConfig;\n\
  \n  private AuthUserPasswordChecker checker;\n\n  @Before\n  public void setup()\
  \ {\n    // Return null to use the default list\n    when(portalConfig.userPasswordNotAllowList()).thenReturn(null);\n\
  \    checker = new AuthUserPasswordChecker(portalConfig);\n  }\n\n  @Test\n  public\
  \ void testRegexMatch() {\n    List<String> unMatchList = Arrays.asList(\n     \
  \   \"11111111\",\n        \"oibjdiel\",\n        \"oso87b6\",\n        \"0vb9xibowkd8bz9dsxbef\"\
  \n    );\n    String exceptedErrMsg = \"Password needs a number and letter and between\
  \ 8~20 characters\";\n\n    for (String p : unMatchList) {\n      CheckResult res\
  \ = checker.checkWeakPassword(p);\n      Assert.assertFalse(res.isSuccess());\n\
  \      Assert.assertEquals(exceptedErrMsg, res.getMessage());\n    }\n\n    List<String>\
  \ matchList = Arrays.asList(\n        \"pziv0g87\",\n        \"8f7zjpf8sci93\",\n\
  \        \"Upz4jF8u2yjV3wn8zp6c\"\n    );\n\n    for (String p : matchList) {\n\
  \      CheckResult res = checker.checkWeakPassword(p);\n      Assert.assertTrue(res.isSuccess());\n\
  \    }\n  }\n\n  @Test\n  public void testIsWeakPassword() {\n    List<String> weakPwdList\
  \ = Arrays.asList(\n        \"a1234567\", \"b98765432\", \"c11111111\", \"d2222222\"\
  , \"e3333333\", \"f4444444\",\n        \"g5555555\", \"h6666666\", \"i7777777\"\
  , \"j8888888\", \"k9999999\", \"l0000000\",\n        \"1q2w3e4r\", \"qwertyuiop1\"\
  , \"asdfghjkl2\", \"asdfghjkl3\", \"abcd1234\"\n    );\n    String exceptedErrMsg\
  \ =\n        \"Passwords cannot be consecutive, regular letters or numbers. And\
  \ cannot be commonly used.\";\n\n    for (String p : weakPwdList) {\n      CheckResult\
  \ res = checker.checkWeakPassword(p);\n      Assert.assertFalse(res.isSuccess());\n\
  \      Assert.assertTrue(res.getMessage().startsWith(exceptedErrMsg));\n    }\n\n\
  \    CheckResult res = checker.checkWeakPassword(\"1s39gvisk\");\n    Assert.assertTrue(res.isSuccess());\n\
  \  }\n\n  @Test\n  public void testCustomNotAllowList() {\n    // Configure a custom\
  \ list with \"company\" as a not allowed pattern\n    when(portalConfig.userPasswordNotAllowList()).thenReturn(Arrays.asList(\"\
  company\", \"secret\"));\n    \n    // Password containing \"company\" should be\
  \ rejected\n    CheckResult res = checker.checkWeakPassword(\"mycompany123\");\n\
  \    Assert.assertFalse(res.isSuccess());\n    Assert.assertTrue(res.getMessage().contains(\"\
  Passwords cannot be consecutive\"));\n\n    // Password containing \"secret\" should\
  \ be rejected\n    res = checker.checkWeakPassword(\"topsecret99\");\n    Assert.assertFalse(res.isSuccess());\n\
  \n    // Password not containing any pattern from custom list should be accepted\n\
  \    // Note: \"1234\" is in the default list but not in the custom list\n    res\
  \ = checker.checkWeakPassword(\"test1234ab\");\n    Assert.assertTrue(res.isSuccess());\n\
  \  }\n\n  @Test\n  public void testEmptyCustomListFallsBackToDefault() {\n    //\
  \ Configure an empty custom list - should fall back to default\n    when(portalConfig.userPasswordNotAllowList()).thenReturn(Arrays.asList());\n\
  \    \n    // Password containing \"1234\" (from default list) should be rejected\n\
  \    CheckResult res = checker.checkWeakPassword(\"a1234567\");\n    Assert.assertFalse(res.isSuccess());\n\
  \  }\n\n}"

========================================================================================================================
TOOL RETURN (find_and_replace_code)
```
Successfully replaced code in apollo-portal/src/test/java/com/ctrip/framework/apollo/portal/util/AuthUserPasswordCheckerTest.java:

--- apollo-portal/src/test/java/com/ctrip/framework/apollo/portal/util/AuthUserPasswordCheckerTest.java
+++ apollo-portal/src/test/java/com/ctrip/framework/apollo/portal/util/AuthUserPasswordCheckerTest.java
@@ -16,6 +16,9 @@
  */
 package com.ctrip.framework.apollo.portal.util;
 
+import static org.mockito.Mockito.when;
+
+import com.ctrip.framework.apollo.portal.c...
```
========================================================================================================================
AGENT:
Now let me run the tests to verify the changes work correctly:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && ./mvnw test -pl apollo-portal -Dtest=AuthUserPasswordCheckerTest
  -q 2>&1 | tail -50
timeout: 300

========================================================================================================================
TOOL RETURN (bash)
```
--2025-12-11 18:31:06--  https://repo.maven.apache.org/maven2/io/takari/maven-wrapper/0.4.2/maven-wrapper-0.4.2.jar
Resolving repo.maven.apache.org (repo.maven.apache.org)... 104.18.19.12, 104.18.18.12, 2606:4700::6812:130c, ...
Connecting to repo.maven.apache.org (repo.maven.apache.org)|104.18.19.12|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 48337 (47K) [application/java-archive]
Saving to: â€˜/workspace/.mvn/wrapper/maven-wrapper.jarâ€™

     0K .......... .............
```
========================================================================================================================
AGENT:
I need to build the dependencies first. Let me install the parent project and dependencies:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && ./mvnw install -DskipTests -q 2>&1 | tail -30
timeout: 600

========================================================================================================================
TOOL RETURN (bash)
```
OpenJDK 64-Bit Server VM warning: Unable to get SVE vector length on this system. Disabling SVE. Specify -XX:UseSVE=0 to shun this warning....
```
========================================================================================================================
AGENT:
Good, the build succeeded. Now let me run the tests:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && ./mvnw test -pl apollo-portal -Dtest=AuthUserPasswordCheckerTest
  2>&1 | tail -50
timeout: 300

========================================================================================================================
TOOL RETURN (bash)
```
[[1;34mINFO[m] [1m--- [0;32mmaven-resources-plugin:2.6:resources[m [1m(default-resources)[m @ [36mapollo-portal[0;1m ---[m
[[1;34mINFO[m] Using 'UTF-8' encoding to copy filtered resources.
[[1;34mINFO[m] Copying 5 resources
[[1;34mINFO[m] Copying 205 resources
[[1;34mINFO[m] Copying 1 resource
[[1;34mINFO[m] Copying 6 resources
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mflatten-maven-plugin:1.1.0:flatten[m [1m(flatten)[m @ [36mapollo-portal[0;1m ---[m
[[1;34mINF...
```
========================================================================================================================
AGENT:
All 4 tests pass. Now let me verify the changes I made by reviewing the modified files:
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/util/checker/AuthUserPasswordChecker.java

========================================================================================================================
TOOL RETURN (open_files)
```
['Successfully opened apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/util/checker/AuthUserPasswordChecker.java:\n\n````java\n   0 /*\n   1  * Copyright 2022 Apollo Authors\n   2  *\n   3  * Licensed under the Apache License, Version 2.0 (the "License");\n   4  * you may not use this file except in compliance with the License.\n   5  * You may obtain a copy of the License at\n   6  *\n   7  * http://www.apache.org/licenses/LICENSE-2.0\n   8  *\n   9  * Unless required by applicable...
```
========================================================================================================================
TOOL CALL (inspect_code)
file_path: apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/component/config/PortalConfig.java
patterns:
- userPasswordNotAllowList

========================================================================================================================
TOOL RETURN (inspect_code)
```
Successfully expanded code chunks in apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/component/config/PortalConfig.java:

````java
   0 /*
   1  * Copyright 2022 Apollo Authors
   2  *
   3  * Licensed under the Apache License, Version 2.0 (the "License");
   4  * you may not use this file except in compliance with the License.
   5  * You may obtain a copy of the License at
   6  *
   7  * http://www.apache.org/licenses/LICENSE-2.0
   8  *
   9  * Unless required by applicable law...
```
========================================================================================================================
AGENT:
Now let me also verify the test file:
========================================================================================================================
TOOL CALL (open_files)
file_paths:
- apollo-portal/src/test/java/com/ctrip/framework/apollo/portal/util/AuthUserPasswordCheckerTest.java

========================================================================================================================
TOOL RETURN (open_files)
```
['Successfully opened apollo-portal/src/test/java/com/ctrip/framework/apollo/portal/util/AuthUserPasswordCheckerTest.java:\n\n````java\n   0 /*\n   1  * Copyright 2022 Apollo Authors\n   2  *\n   3  * Licensed under the Apache License, Version 2.0 (the "License");\n   4  * you may not use this file except in compliance with the License.\n   5  * You may obtain a copy of the License at\n   6  *\n   7  * http://www.apache.org/licenses/LICENSE-2.0\n   8  *\n   9  * Unless required by applicable law...
```
========================================================================================================================
AGENT:
The implementation looks good. Let me also run a broader set of tests to make sure the changes don't break anything else:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && ./mvnw test -pl apollo-portal -Dtest=*PasswordChecker* 2>&1
  | tail -30
timeout: 300

========================================================================================================================
TOOL RETURN (bash)
```
[[1;34mINFO[m] /workspace/apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/component/ConfigReleaseWebhookNotifier.java: Recompile with -Xlint:deprecation for details.
[[1;34mINFO[m] /workspace/apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/component/ConfigReleaseWebhookNotifier.java: /workspace/apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/component/ConfigReleaseWebhookNotifier.java uses unchecked or unsafe operations.
[[1;34mINFO[m] /workspace/a...
```
========================================================================================================================
AGENT:
All tests pass. Let me also check if there are any other tests related to PortalConfig that might be affected:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && ./mvnw test -pl apollo-portal -Dtest=ConfigTest 2>&1 | tail
  -30
timeout: 300

========================================================================================================================
TOOL RETURN (bash)
```
[[1;34mINFO[m] /workspace/apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/component/ConfigReleaseWebhookNotifier.java: Recompile with -Xlint:deprecation for details.
[[1;34mINFO[m] /workspace/apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/component/ConfigReleaseWebhookNotifier.java: /workspace/apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/component/ConfigReleaseWebhookNotifier.java uses unchecked or unsafe operations.
[[1;34mINFO[m] /workspace/a...
```
========================================================================================================================
AGENT:
All tests pass. Let me also verify that the code compiles correctly by running a quick compile check:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && ./mvnw compile -pl apollo-portal -q 2>&1 | tail -20
timeout: 120

========================================================================================================================
TOOL RETURN (bash)
```
OpenJDK 64-Bit Server VM warning: Unable to get SVE vector length on this system. Disabling SVE. Specify -XX:UseSVE=0 to shun this warning....
```
========================================================================================================================
AGENT:
The code compiles successfully. Now let me update the status and provide a summary of the changes:
========================================================================================================================
AGENT:
I have implemented the feature to make the password check list configurable. Let me verify the changes are complete and correct.
========================================================================================================================
AGENT:
Let me review all the changes I made to ensure they are complete:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && git diff --stat

========================================================================================================================
TOOL RETURN (bash)
```
 .../portal/component/config/PortalConfig.java      | 16 ++++++++
 .../util/checker/AuthUserPasswordChecker.java      | 31 ++++++++++++++-
 .../portal/util/AuthUserPasswordCheckerTest.java   | 44 +++++++++++++++++++++-
 3 files changed, 88 insertions(+), 3 deletions(-)...
```
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && git diff

========================================================================================================================
TOOL RETURN (bash)
```
diff --git a/apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/component/config/PortalConfig.java b/apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/component/config/PortalConfig.java
index 8ae2a4ac..73865fde 100644
--- a/apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/component/config/PortalConfig.java
+++ b/apollo-portal/src/main/java/com/ctrip/framework/apollo/portal/component/config/PortalConfig.java
@@ -273,4 +273,20 @@ public class PortalConfig extend...
```
========================================================================================================================
AGENT:
The changes look complete and correct. Let me run a final comprehensive test to make sure everything works:
========================================================================================================================
TOOL CALL (bash)
command: cd /workspace && ./mvnw test -pl apollo-portal -Dtest=AuthUserPasswordCheckerTest,ConfigTest
  -q 2>&1 | tail -20
timeout: 300

========================================================================================================================
TOOL RETURN (bash)
```
OpenJDK 64-Bit Server VM warning: Unable to get SVE vector length on this system. Disabling SVE. Specify -XX:UseSVE=0 to shun this warning.

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
OpenJDK 64-Bit Server VM warning: Unable to get SVE vector length on this system. Disabling SVE. Specify -XX:UseSVE=0 to shun this warning.
Running com.ctrip.framework.apollo.portal.util.AuthUserPasswordCheckerTest
Tests run: 4, Failure...
```
========================================================================================================================
AGENT:
All tests pass. Let me now mark the task as complete:
========================================================================================================================
AGENT:
Successfully implemented the feature to make the password check list configurable instead of hardcoded.

## Summary of Changes

### 1. Modified `PortalConfig.java`
Added a new method `userPasswordNotAllowList()` that:
- Reads the `userPasswordNotAllowList` property from configuration (can be set in database via ServerConfig or in application properties)
- Returns the list of password fragments that are not allowed
- Returns `null` if not configured (to indicate default list should be used)

### 2. Modified `AuthUserPasswordChecker.java`
- Renamed `LIST_OF_CODE_FRAGMENT` to `DEFAULT_USER_PASSWORD_NOT_ALLOW_LIST` and made it package-private for testing
- Added constructor injection of `PortalConfig` to get the configurable list
- Added `getNotAllowList()` method that:
  - Returns the custom list from `PortalConfig` if configured
  - Falls back to the default hardcoded list if not configured or empty
- Updated `isCommonlyUsed()` to use the configurable list

### 3. Updated `AuthUserPasswordCheckerTest.java`
- Added Mockito for mocking `PortalConfig`
- Updated existing tests to work with the new constructor
- Added new test `testCustomNotAllowList()` to verify custom list works
- Added new test `testEmptyCustomListFallsBackToDefault()` to verify fallback behavior

## How to Use
Administrators can now configure the password not-allow list by setting the `userPasswordNotAllowList` property:

1. **Via Database (ServerConfig table)**: Add a row with `Key` = `userPasswordNotAllowList` and `Value` = comma-separated list of patterns (e.g., `111,222,333,company,secret`)

2. **Via application.properties**: Add `userPasswordNotAllowList=111,222,333,company,secret`

The list is refreshable at runtime (every 60 seconds) since `PortalConfig` extends `RefreshableConfig`, so administrators can change the list without restarting the application.